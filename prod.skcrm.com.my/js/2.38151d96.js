(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"007d":function(e,t,a){"use strict";var o=a("ed08");const s={data(){return{textRules:e=>!!e.toString()&&e.toString().length,emailRules:e=>!e||Object(o["d"])(e),phoneNoRules:e=>!!e&&Object(o["e"])(e),floatRules:e=>!Number.isNaN(parseFloat(e))}}};t["a"]=s},1481:function(e,t,a){"use strict";var o=a("d617"),s=a.n(o);s.a},d617:function(e,t,a){},e5ee:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-pa-none q-gutter-y-sm"},[a("q-tabs",{attrs:{"inline-label":"",shrink:"",stretch:"",dense:"",align:"left"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},e._l(e.datatabs,(function(e){return a("q-tab",{key:e.name,attrs:{name:e.name,label:e.name}})})),1),e.datatabs[e.activeDataTab]?a("q-table",{staticClass:"sticky-table",style:{height:e.computedTableHeight},attrs:{selection:"single","virtual-scroll":"",columns:e.datatabs[e.activeDataTab].columns,data:e.datatabs[e.activeDataTab].data,"row-key":e.datatabs[e.activeDataTab].key,selected:e.selection,pagination:e.pagination,filter:e.filter,"filter-method":e.filterTableData},on:{"update:selected":function(t){e.selection=t},"update:pagination":function(t){e.pagination=t},"update:fullscreen":function(t){return e.isTableFullscreen=t}},scopedSlots:e._u([{key:"top",fn:function(t){return[a("q-btn",{attrs:{flat:"",dense:"",icon:"filter_alt",color:"primary"}},[null!==e.selectionFilterOptions?a("table-selection-filter",{attrs:{options:e.selectionFilterOptions},on:{filter:e.onSelectionFilter}}):e._e()],1),a("q-space"),a("q-input",{staticClass:"q-mr-md",attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.textFilter,callback:function(t){e.textFilter=t},expression:"textFilter"}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}}),["orderconfirmation","finalconfirmation"].includes(e.activeMenu)?a("sk-footer-oc"):e._e()]}}],null,!1,1182513194)}):e._e(),a("dialog-plugins")],1)},s=[],r=(a("c975"),a("ddb0"),a("c973")),i=a.n(r),l=a("ded3"),n=a.n(l),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("sk-add-user-dialog"),a("sk-edit-user-dialog"),a("sk-assign-scope"),a("sk-assign-user-role"),a("sk-add-branch-dialog"),a("sk-branch-RR-dialog"),a("sk-edit-branch-dialog"),a("sk-add-lead-dialog"),a("sk-edit-lead-dialog"),a("sk-import-online-leads-dialog"),a("sk-assign-lead-to-design"),a("sk-assign-lead-to-sc-dialog"),a("sk-assign-leads-to-branch-dialog"),a("sk-disqualified-o-l-dialog"),a("sk-disqualified-q-l-dialog"),a("sk-requalify-q-l-dialog"),a("sk-set-lead-to-lost"),a("sk-rejection-reason-lost-design-proposal"),a("sk-req-campaign-changes-q-l-dialog"),a("sk-view-order-confirmation"),a("sk-actions-order-confirmation"),a("sk-submit-order-confirmation-to-account"),a("sk-cancel-order-confirmation"),a("sk-view-final-confirmation-order"),a("sk-actions-final-order-confirmation"),a("sk-complete-task-final-order-confirmation"),a("sk-final-order-confirmation-approve-for-production"),a("sk-detailed-quotation"),a("sk-summary-quotation"),a("sk-add-drawing-number-dialog"),a("sk-delete-dialog"),a("sk-import-itemlist-dialog"),a("sk-download-missing-items-csv"),a("sk-download-calculation-logs-csv"),a("sk-import-op-itemlist-dialog"),a("sk-import-loose-itemlist-dialog"),a("sk-import-material-list-dialog"),a("sk-edit-item-list-route"),a("sk-open-kujiale-dialog"),a("sk-assign-to-fco"),a("sk-submit-to-manager"),a("sk-add-exhibition"),a("sk-delete-exhibition"),a("sk-view-campaign"),a("sk-set-default-campaign"),a("sk-pending-visit"),a("sk-view-service-report"),a("sk-actions-service-report"),a("sk-create-service-report"),a("sk-submit-to-detailer-service-report"),a("sk-complete-service-report"),a("sk-view-report-maintenance"),a("sk-create-report-maintenance")],1)},c=[],u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"actionsOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Order Confirmation Actions\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Acknowledge or Reject\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-card-actions",{staticClass:"bg-white text-dark q-gutter-sm",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:e.isDisabledReject},on:{click:e.onClickReject}}),e.isDisabledReject?a("q-tooltip",[e._v("\n            Remarks is required\n          ")]):e._e()],1),a("div",[a("q-btn",{attrs:{label:"Acknowledge",color:"positive"},on:{click:e.onClickAcknowledge}})],1)],1)],1)])],1)},m=[],p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{ref:"dialog",staticStyle:{width:"700px","max-width":"80vw"},attrs:{position:"right","full-height":""},on:{hide:e.onClose,show:e.onShow}},[e._t("default")],2)},h=[],f={props:{name:{type:String,required:!0}},data(){return{}},computed:{isActive(){return this.$store.getters.activeModal===this.name},isOpen(){return this.$store.getters.allOpen.includes(this.name)}},watch:{isActive(e,t){e?this.$refs.dialog.show():this.$refs.dialog.hide()}},beforeDestroy(){this.isOpen&&this.onClose()},methods:{onClose(){this.$store.dispatch("ModalClose",this.name),this.$emit("close-dialog")},onShow(){this.$emit("show-dialog")}}},g=f,b=a("2877"),y=Object(b["a"])(g,p,h,!1,null,null,null),v=y.exports,q=a("2f62"),x=a("007d"),C={components:{ModalDialog:v},mixins:[x["a"]],data(){return{remarks:""}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isDisabledReject(){return!this.remarks.length},isDisabledAcknowledge(){return!(!this.tableSelection[0]||"FCO"!==this.tableSelection[0].state)||"New"===this.tableSelection[0].status}}),methods:{onShowDialog(){var e=this;return i()((function*(){console.log(e.tableSelection)}))()},reset(){this.remarks=""},onClickAcknowledge(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("OrderConfirmationAcknowledged",{orderId:e.tableSelection[0].uuid}),e.$q.loading.hide(),e.$notify("success","Order state successfully updated")}catch(t){e.$q.loading.hide(),e.$notify("error","Order state failed to be updated")}}))()},onClickReject(){var e=this;return i()((function*(){try{e.$q.loading.show(),e.$store.dispatch("OrderConfirmationRejected",{orderId:e.tableSelection[0].uuid,remarks:e.remarks}),e.$q.loading.hide(),e.$notify("success","Order state successfully updated")}catch(t){e.$q.loading.hide(),e.$notify("error","Order state failed to be updated")}}))()}}},w=C,k=Object(b["a"])(w,u,m,!1,null,null,null),_=k.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"addbranch"},on:{"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          New branch\n        ")])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Branch detail\n        ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-form",{ref:"myForm",on:{submit:e.onAddBranch}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Branch Name","bottom-slots":!1,"hide-hint":!0,rules:[e.onNameCheck],error:e.errorMessageBranchName.length>0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errorMessageBranchName.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageBranchName)+"\n                ")])]):e._e()],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Branch Code","lazy-rules":"",debounce:"500",rules:[e.onBranchCodeCheck],error:e.errorMessageBranchCode.length>0},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}},[e.errorMessageBranchCode.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageBranchCode)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",options:e.opts.types,label:"Branch Type","emit-value":"","map-options":"","stack-label":"",rules:[e.onCheckType,e.textRules],error:e.errorMessageBranchType.length>0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e.errorMessageBranchType.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageBranchType)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",placeholder:"07-2345678",label:"Telephone No.",mask:"## - #############","lazy-rules":"","unmasked-value":"",rules:[e.onMobileCheck],error:e.errorMessagePhone.length>0},model:{value:e.form.telno,callback:function(t){e.$set(e.form,"telno",t)},expression:"form.telno"}},[e.errorMessagePhone.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessagePhone)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",placeholder:"07-23456789",label:"Fax No.",mask:"## - #############","unmasked-value":"",rules:[e.onFaxCheck],error:e.errorMessageFaxNo.length>0},model:{value:e.form.faxno,callback:function(t){e.$set(e.form,"faxno",t)},expression:"form.faxno"}},[e.errorMessageFaxNo.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageFaxNo)+"\n                  ")])]):e._e()],1)],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Email",debounce:"500",rules:[e.onEmailCheck,e.emailRules],error:e.errorMessageEmail.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errorMessageEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageEmail)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Address 1","aria-rowcount":"2",rules:[e.onAddressCheck,e.textRules],error:e.errorMessageAddress.length>0},model:{value:e.form.address1,callback:function(t){e.$set(e.form,"address1",t)},expression:"form.address1"}},[e.errorMessageAddress.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageAddress)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Address 2"},model:{value:e.form.address2,callback:function(t){e.$set(e.form,"address2",t)},expression:"form.address2"}}),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"State","lazy-rules":"",error:e.errorMessageState.length>0,rules:[e.onStateCheck,e.textRules]},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[e.errorMessageState.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageState)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Country","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errorMessageCountry.length>0,rules:[e.onCountryCheck,e.textRules],options:e.countryOptions},on:{filter:e.filterFn},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},[e.errorMessageCountry.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageCountry)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"SSM No.","lazy-rules":"",error:e.errorMessageSSMNo.length>0,rules:[e.onSSMCheck,e.textRules]},model:{value:e.form.SSMNo,callback:function(t){e.$set(e.form,"SSMNo",t)},expression:"form.SSMNo"}},[e.errorMessageSSMNo.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageSSMNo)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"GST No","lazy-rules":"",error:e.errorMessageGSTNo.length>0,rules:[e.onGSTCheck,e.textRules]},model:{value:e.form.GSTNo,callback:function(t){e.$set(e.form,"GSTNo",t)},expression:"form.GSTNo"}},[e.errorMessageGSTNo.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageGSTNo)+"\n                ")])]):e._e()],1),a("q-file",{ref:"fileupload",staticClass:"col q-pb-none",attrs:{accept:".png, .jpg, .jpeg",label:"Choose Logo",outlined:""},model:{value:e.fileUpload,callback:function(t){e.fileUpload=t},expression:"fileUpload"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errorMessageBranchCode.length>0||e.errorMessageFaxNo.length>0||e.errorMessagePhone.length>0||e.errorMessageEmail.length>0||e.errorMessageBranchName.length>0||e.errorMessageAddress.length>0||e.errorMessageState.length>0||e.errorMessageCountry.length>0},on:{click:e.onAddBranch}})],1)],1)])],1)],1)])],1)},A=[],M=(a("fb6a"),a("b5ae")),I=a("764d"),$=a("7f47"),D={components:{ModalDialog:v},mixins:[x["a"]],data(){return{fileUpload:null,countryOptions:[],form:{name:"",type:"",code:"",telno:"",faxno:"",email:"",address1:"",address2:"",state:"",country:"",SSMNo:"",logo:"",GSTNo:"",branchId:""},branchName:"",selections:[],errorMessageBranchCode:"",errorMessageFaxNo:"",errorMessagePhone:"",errorMessageEmail:"",errorMessageBranchName:"",errorMessageAddress:"",errorMessageState:"",errorMessageCountry:"",errorMessageSSMNo:"",errorMessageGSTNo:"",errorMessageBranchType:"",opts:{types:[{label:"Home Branch",value:"home"},{label:"Dealer Branch",value:"dealer"}]}}},computed:{branches(){const e=I["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},countries(){const e=$["a"].all();console.log("the countries are here",e);const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.name,t.flag=e.flag,t});return t}},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllCountries");const t=$["a"].all();e.form.country=t[135].name}))()},validations:{form:{password:{required:M["required"],minLength:Object(M["minLength"])(4)},mobile:{required:M["required"],minLength:Object(M["minLength"])(10)},username:{required:M["required"]},branchId:{required:M["required"]},role:{required:M["required"]},name:{required:M["required"]},code:{required:M["required"]},type:{required:M["required"]},telno:{required:M["required"]},email:{required:M["required"],email:M["email"]},address1:{required:M["required"]},state:{required:M["required"]},country:{required:M["required"]},SSMNo:{required:M["required"]}}},methods:{filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.countryOptions=this.countries.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.countryOptions=this.countries})},onShowDialog(){var e=this;return i()((function*(){e.$store.dispatch("GetAllCountries");const t=I["a"].query().where("name","HQ").first();e.form.branchId=t.uuid,e.branchName=t.name,e.countryOptions=e.countries;const a=$["a"].all();e.form.country=a[135].name}))()},reset(){const e=$["a"].all();this.errorMessageBranchCode="",this.errorMessageFaxNo="",this.errorMessagePhone="",this.errorMessageEmail="",this.errorMessageBranchName="",this.errorMessageAddress="",this.errorMessageState="",this.errorMessageCountry="",this.errorMessageSSMNo="",this.errorMessageGSTNo="",this.errorMessageBranchType="",this.form={name:"",code:"",telno:"",faxno:"",email:"",address1:"",address2:"",state:"",country:e[135].name,SSMNo:"",GSTNo:"",logo:"",branchId:""}},onAddBranch(){var e=this;return i()((function*(){if(e.onBranchCodeCheck(),e.fileUpload){const t=yield e.$store.dispatch("UploadFile",e.fileUpload);e.form.logo=t.name}e.$v.form.$touch();const t=n()(n()({},e.form),{},{SSMNo:e.form.SSMNo.toString(),GSTNo:e.form.GSTNo.toString()});e.$refs.myForm.validate().then(function(){var a=i()((function*(a){a?(e.$q.loading.show(),yield e.$store.dispatch("RegisterBranch",t),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success",`Branch with name ${t.name} created!`),e.reset()):(e.$q.loading.hide(),e.$notify("error","All field is required"))}));return function(e){return a.apply(this,arguments)}}())}))()},onEmailCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.email.length<=0?e.errorMessageEmail="Field cant be blank":yield e.$store.dispatch("CheckEmailExist",e.form.email).then(t=>{e.errorMessageEmail=t?"Email already exist":""})}))()},onBranchCodeCheck(){var e=this;return i()((function*(){e.form.code.length<=0?e.errorMessageBranchCode="Field cant be blank":yield e.$store.dispatch("CheckBranchCodeExist",e.form.code).then(t=>{e.errorMessageBranchCode=t?"Branch Code already exist":""})}))()},onAddressCheck(){this.$v.form.$touch(),this.form.address1.length<=0?this.errorMessageAddress="Field cant blank":(console.log("dsad"),this.errorMessageAddress="")},onStateCheck(){this.$v.form.$touch(),this.form.state.length<=0?this.errorMessageState="Field cant blank":(console.log("dsad"),this.errorMessageState="")},onCountryCheck(){this.$v.form.$touch(),this.form.country.length<=0?this.errorMessageCountry="Field cant blank":this.errorMessageCountry=""},onSSMCheck(){this.$v.form.$touch(),this.form.SSMNo.length<=0?this.errorMessageSSMNo="Field cant blank":this.errorMessageSSMNo=""},onGSTCheck(){this.$v.form.$touch(),this.form.GSTNo.length<=0?this.errorMessageGSTNo="Field cant blank":this.errorMessageGSTNo=""},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errorMessageBranchName="Field cant blank":this.errorMessageBranchName=""},onCheckType(){this.$v.form.$touch(),this.form.type.length<=0?this.errorMessageBranchType="Field cant blank":this.errorMessageBranchType=""},onFaxCheck(){var e=this;return i()((function*(){e.form.faxno<=0?e.errorMessageFaxNo="Field cant be blank":(yield e.$store.dispatch("CheckFaxExist",e.form.faxno).then(t=>{e.errorMessageFaxNo=t?"Fax number already exist":""}),e.form.faxno.length>=8&&e.form.faxno.length<=15||(e.errorMessageFaxNo="Fax No. must between 8-15 digits"))}))()},onMobileCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.telno.length<=0?e.errorMessagePhone="Field cant be blank":(yield e.$store.dispatch("CheckMobileBranchExist",e.form.telno).then(t=>{e.errorMessagePhone=t?"Mobile already exist":""}),e.form.telno.length>=8&&e.form.telno.length<=15||(e.errorMessagePhone="Telephone No. must be between 8-15 digits"))}))()}}},T=D,O=Object(b["a"])(T,S,A,!1,null,null,null),N=O.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"insertDrawingNumber"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Drawing Number\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            To generate quotation\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-form",{ref:"myForm",on:{submit:e.onClickSubmit}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Drawing Number",rules:[e.textRules]},model:{value:e.drawingId,callback:function(t){e.drawingId=t},expression:"drawingId"}}),a("div",{attrs:{align:"left"}},[a("q-btn",{attrs:{color:"primary",label:"Calculate"},on:{click:e.onClickSubmit}})],1),null!==e.totalPrice?a("q-separator",{staticClass:"q-my-md"}):e._e(),null!==e.totalPrice?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Total quotation price\n              ")]):e._e(),null!==e.totalPrice?a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Total Price (RM)",disable:""},model:{value:e.totalPrice,callback:function(t){e.totalPrice=t},expression:"totalPrice"}}):e._e(),a("div",{attrs:{align:"left"}},[null!==e.totalPrice&&e.roles.includes("sysadmin")?a("q-btn",{attrs:{color:"primary",label:"Download Log"},on:{click:e.onClickDownloadLog}}):e._e()],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Drawing Reference\n              ")]),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.productReferences,label:"Product","emit-value":"","map-options":"","stack-label":""},model:{value:e.productName,callback:function(t){e.productName=t},expression:"productName"}}),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.areaReferences,label:"Area","emit-value":"","map-options":"","stack-label":""},model:{value:e.areaName,callback:function(t){e.areaName=t},expression:"areaName"}}),a("q-separator",{staticClass:"q-my-md"})],1)]),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Continue to Detailed Quotation"},on:{click:e.onClickDetailed}})],1)],1)])],1)])],1)},F=[],j=(a("2b3d"),a("ed08")),L={components:{ModalDialog:v},mixins:[x["a"]],data(){return{productReferences:["Kitchen Cabinet","Wardrobe","Walk-In Wardrobe","Bedroom Set","TV Console","Vanity Cabinet","Home Office Cabinet","Headboard & Side Table","Study Table & Book Cabinet","Chess of Drawer","Headboard","Bedside Table","Divan","Study Table","Book Cabinet","Laundry Cabinet","Shoe Cabinet","General Cabinet"],areaReferences:["Dry Kitchen","Wet Kitchen","Master Bedroom","Bedroom 1","Bedroom 2","Bedroom 3","Bedroom 4","Guest Room","Maid Room","Boys Room","Girls Room","Study Room","Prayers Room","Store Room","Master Bedroom","Bathroom 1","Bathroom 2","Bathroom 3","Bathroom 4","Powder Room","Living Hall","Family Hall","Dining Hall","Laundry Area","Pantry Area","Yard Area","Foyer"],selectedLeadId:"",selections:[],form:{},drawingId:"",totalPrice:null,lead:{},drawingReferenceName:null,productName:null,areaName:null}},computed:n()({},Object(q["b"])(["tableSelection","roles"])),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},methods:{onClickDownloadLog(){var e=this;return i()((function*(){const{data:t}=yield e.$repository.calculationLog.listing({where:{drawingNumber:e.drawingId},fields:{drawingNumber:!0,itemId:!0,parentItemId:!0,kujialeSequenceId:!0,name:!0,brandGoodName:!0,brandGoodCode:!0,material:!0,colour:!0,profile:!0,width:!0,height:!0,depth:!0,totalItemProcessCost:!0,ccost:!0,stdCost:!0,markupRate:!0,nonStdRate:!0,totalCost:!0,rrp:!0,quantity:!0},order:["itemId ASC"]});for(const e of t)e.brandGoodCode||(e.brandGoodCode=""),e.brandGoodCode=e.brandGoodCode.replaceAll(",","|");const a=Object(j["f"])(t);let o=Object.keys(t[0]).join(",");o+="\r\n";var s=e.drawingId+"_calculation_log.csv",r=new Blob([o,a],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(void 0!==i.download){var l=URL.createObjectURL(r);i.setAttribute("href",l),i.setAttribute("download",s),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}))()},onShowDialog(){var e=this;return i()((function*(){e.selections=e.$store.getters.tableSelection,e.selections.length&&(e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value)}))()},onClickSubmit(){var e=this;return i()((function*(){e.lead=n()({},e.form),e.lead.drawingId=e.drawingId;try{e.$q.loading.show();const{totalDrawingPrice:t,message:a}=yield e.$store.dispatch("CalculateDrawing",e.lead);if(e.totalPrice=t,e.totalPrice=e.totalPrice.toFixed(2),a.length)throw new Error(a);e.$q.loading.hide(),e.$notify("success","Successfully calculate drawing")}catch(t){const a=t.response?t.response.data.error.message:t.message;e.$q.loading.hide(),e.$notify("error",a)}}))()},onClickDetailed(){var e=this;return i()((function*(){try{e.$q.loading.show();let t="";t=e.drawingId?yield e.$store.dispatch("GetDetailedQuotation",{uuid:e.lead.uuid,drawingId:e.lead.drawingId,drawingReferenceName:e.productName+", "+e.areaName}):yield e.$store.dispatch("CreateDetailedQuotation",{leadId:e.selectedLeadId,state:"DetailedQuotation",referenceName:e.productName+", "+e.areaName}),e.$q.loading.hide();const a=t.uuid;console.log(a);const o=e.$router.resolve({path:`/lead/${e.selectedLeadId}/detailed-quotation/${a}`});window.open(o.href,"_blank")}catch(t){e.$q.loading.hide();const a=t.response.data.error.message;e.$notify("error",a)}}))()},reset(){this.calculate={leadId:"",drawingId:""}}}},E=L,P=Object(b["a"])(E,R,F,!1,null,null,null),U=P.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"walkinlead"},on:{"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Walk In Leads\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onAddLead}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Key in data for walk in user only\n            ")]),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Name","lazy-rules":"",rules:[e.onNameCheck,e.textRules],error:e.errorMessageName.length>0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errorMessageName.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageName)+"\n                ")])]):e._e()],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Email",type:"email",debounce:"1000",error:e.errorMessageEmail.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errorMessageEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageEmail)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",type:"tel",label:"Telephone No.","lazy-rules":"",rules:[e.onMobileCheck],error:e.errorMessagePhone.length>0,mask:"### - ############","unmasked-value":""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}},[e.errorMessagePhone.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessagePhone)+"\n                  ")])]):e._e()],1)],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","lazy-rules":"",label:"Property Name",rules:[e.onLocationCheck,e.textRules],error:e.errorMessageProperty.length>0},model:{value:e.form.property_type,callback:function(t){e.$set(e.form,"property_type",t)},expression:"form.property_type"}},[e.errorMessageProperty.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageProperty)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","lazy-rules":"",label:"Billing Address Line 1",rules:[e.onAddressCheck,e.textRules],error:e.errorMessageAddress.length>0},model:{value:e.form.address1,callback:function(t){e.$set(e.form,"address1",t)},expression:"form.address1"}},[e.errorMessageAddress.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageAddress)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Billing Address Line 2"},model:{value:e.form.address2,callback:function(t){e.$set(e.form,"address2",t)},expression:"form.address2"}}),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Postcode",min:"0",max:"99999","on-key-up":"if(this.value>99999) {this.value='99999';} else if (this.value<0) {this.value='0';}",type:"number"},model:{value:e.form.postcode,callback:function(t){e.$set(e.form,"postcode",t)},expression:"form.postcode"}}),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"City"},model:{value:e.form.city,callback:function(t){e.$set(e.form,"city",t)},expression:"form.city"}}),"Malaysia"===e.form.country?a("div",[a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"State","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errorMessageLocationState.length>0,rules:[e.onStateCheck,e.textRules],options:e.locationStatesOptions},on:{filter:e.filterState},model:{value:e.form.locationState,callback:function(t){e.$set(e.form,"locationState",t)},expression:"form.locationState"}},[e.errorMessageLocationState.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageLocationState)+"\n                  ")])]):e._e()],1)],1):a("div",[a("q-select",{staticClass:"col q-pb-none",attrs:{value:"",outlined:"",label:"State","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",disable:""}},[e.errorMessageLocationState.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageLocationState)+"\n                  ")])]):e._e()],1)],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Country","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errorMessageCountry.length>0,rules:[e.onCountryCheck,e.textRules],options:e.countryOptions},on:{filter:e.filterFn},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},[e.errorMessageCountry.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageCountry)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.exhibitions,label:"Campaign","lazy-rules":"","map-options":"","emit-value":"",error:e.errorMessageCampaign.length>0},model:{value:e.form.exhibition,callback:function(t){e.$set(e.form,"exhibition",t)},expression:"form.exhibition"}},[e.errorMessageCampaign.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageCampaign)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.leads,label:"Source of Lead","lazy-rules":"",rules:[e.onSourceCheck,e.textRules],error:e.errorMessageSourceLead.length>0},model:{value:e.form.source_lead,callback:function(t){e.$set(e.form,"source_lead",t)},expression:"form.source_lead"}},[e.errorMessageSourceLead.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageSourceLead)+"\n                ")])]):e._e()],1),e.useOtherSourceLead?a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"(Others) Source of Lead","lazy-rules":"",rules:[e.onOtherSourceCheck,e.textRules],error:e.errorMessageOtherSourceLead.length>0},model:{value:e.form.others_source_lead,callback:function(t){e.$set(e.form,"others_source_lead",t)},expression:"form.others_source_lead"}},[e.errorMessageOtherSourceLead.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageOtherSourceLead)+"\n                ")])]):e._e()],1):e._e(),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Customer Sales Type\n            ")]),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.type,label:"Lead Type","emit-value":"","map-options":"","lazy-rules":"",rules:[e.onTypeCheck,e.textRules],error:e.errorMessageLeadType.length>0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e.errorMessageLeadType.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageLeadType)+"\n                ")])]):e._e()],1),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errorMessageName.length>0||e.errorMessageEmail.length>0||e.errorMessagePhone.length>0||e.errorMessageProperty.length>0||e.errorMessageSourceLead.length>0||e.errorMessageOtherSourceLead.length>0||e.errorMessageLeadType.length>0||e.errorMessageAddress.length>0||e.errorMessageLocationState.length>0||e.errorMessageCountry.length>0},on:{click:e.onAddLead}})],1)],1)])],1)],1)])],1)},z=[],G=(a("5319"),a("b178"));const{formatDate:Q}=G["e"];var Y={components:{ModalDialog:v},mixins:[x["a"]],data(){return{options:{roles:[],branches:[]},dialog:{show:!1,userId:"",roleArr:[]},opts:{exhibitions:[],propType:["Bungalow","Semi-D","Terrace","Townhouse","Apartment","ShopLot"],leads:["Events/Exhibitions","Social Media (Facebook, Instagram, Youtube, etc)","Signature Website","Google Search","Billboard","Shop Front Banner","Developer Voucher","Referred by Friends/Family","Others: Please State"],type:[{label:"Corporate",value:"corporate"},{label:"Retail",value:"retail"}],country:[]},errorMessageName:"",errorMessageEmail:"",errorMessagePhone:"",errorMessageProperty:"",errorMessageSourceLead:"",errorMessageOtherSourceLead:"",errorMessageLeadType:"",errorMessageCampaign:"",errorMessageAddress:"",errorMessageLocationState:"",errorMessageCountry:"",form:{name:"",email:"",phone:"",property_type:"",address1:"",address2:"",postcode:"",city:"",state:"",country:"",locationState:"",location:"",source_lead:"",others_source_lead:"",campaign:"",exhibition:"",type:"",siteAddress:"",age:"",property_value:"",time_contact:"",channel_contact:"",rejectReason:"",noteToBranch:"",birthday:0,race:""},countryOptions:[],locationStatesOptions:[]}},validations:{form:{name:{required:M["required"]},email:{required:M["required"],email:M["email"]},phone:{required:M["required"],minLength:Object(M["minLength"])(10)},property_type:{required:M["required"]},location:{required:M["required"]},source_lead:{required:M["required"]},type:{required:M["required"]},campaign:{required:M["required"]},exhibition:{required:M["required"]}}},computed:n()(n()({},Object(q["b"])(["userId","roles"])),{},{countries(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.name,t.flag=e.flag,t});return t},locationStates(){const e=["Johor","Kedah","Kelantan","Kuala Lumpur","Melaka","Negeri Sembilan","Pahang","Penang","Perak","Perlis","Sabah","Sarawak","Selangor","Terengganu"];return e},useOtherSourceLead(){return this.form.source_lead.toLowerCase().includes("other")}}),watch:{"form.exhibition"(e){console.log(e)},"form.source_lead"(e){console.log(e)},"form.country"(e){"Malaysia"!==this.form.country&&(this.form.locationState="")}},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllCountries");const t=$["a"].all();e.form.country=t[135].name,e.form.locationState=e.locationStates[0]}))()},methods:{onShowDialog(){var e=this;return i()((function*(){const t=parseInt(Q(Date.now(),"YYYYMMDD"));e.opts.exhibitions=(yield e.$store.dispatch("GetAllExhibitions")).filter(e=>{const a=parseInt(e.hideDate.replace(/\//g,""));return t<a}).map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t.status=e.status,t}),e.opts.exhibitions.filter(t=>{if(console.log("here",t.value),console.log("EXHIBITION HERE:   "+JSON.stringify(t)),"default"===t.status){const a=t.value;console.log("val here",a),e.form.exhibition=a,e.form.campaign=t.label}}),console.log("ex",e.form.campaign),console.log("log",e.opts.exhibitions)}))()},reset(){this.form={name:"",email:"",phone:"",property_type:"",location:"",address1:"",address2:"",country:"",locationState:"",source_lead:"",others_source_lead:"",type:"",state:"QL",status:"active",campaign:"",exhibition:""}},onAddLead(){var e=this;return i()((function*(){let t=n()({},e.form);e.useOtherSourceLead&&(t.source_lead=t.others_source_lead),delete t.others_source_lead,t.createdByUserUuid=e.userId,console.log("Created lead: "+JSON.stringify(t)),e.roles.includes("salesconsultant")&&(t=n()(n()({},t),{},{requalifyReason:"",status:"Assigned",userId:e.userId})),e.$refs.myForm.validate().then(function(){var a=i()((function*(a){a?(yield e.$store.dispatch("AddQualifiedLead",t),e.$notify("success",`Lead with name ${t.name} created!`),e.reset(),e.$refs.dialog.$children[0].hide()):e.$notify("error","All field is required")}));return function(e){return a.apply(this,arguments)}}())}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errorMessageName="Field cant blank":this.errorMessageName=""},onEmailCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.email.length<=0?e.errorMessageEmail="Field cant be blank":yield e.$store.dispatch("LeadCheckEmailExist",e.form.email).then(t=>{e.errorMessageEmail=t?"Email already exist":""})}))()},onMobileCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.phone.length<=0?e.errorMessagePhone="Field cant be blank":(yield e.$store.dispatch("LeadCheckMobileExist",e.form.phone).then(t=>{e.errorMessagePhone=t?"Mobile already exist":""}),e.form.phone.length>=10&&e.form.phone.length<=15||(e.errorMessagePhone="Telephone No. must be between 10-15 digits"))}))()},onLocationCheck(){this.$v.form.$touch(),this.form.property_type.length<=0?this.errorMessageProperty="Field cant blank":this.errorMessageProperty=""},onExhibitionCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.exhibition.length<=0?e.errorMessageCampaign="Field cant blank":e.errorMessageCampaign="";const t=e.opts.exhibitions.filter(t=>t.value===e.form.exhibition)[0];e.form.campaign=t.label}))()},onSourceCheck(){this.$v.form.$touch(),this.form.source_lead.length<=0?this.errorMessageSourceLead="Field cant blank":this.errorMessageSourceLead="",this.useOtherSourceLead||(this.errorMessageOtherSourceLead="")},onOtherSourceCheck(){this.$v.form.$touch(),this.useOtherSourceLead&&this.form.others_source_lead.length<=0?this.errorMessageOtherSourceLead="Field cant blank":this.errorMessageOtherSourceLead=""},onTypeCheck(){this.$v.form.$touch(),this.form.type.length<=0?this.errorMessageLeadType="Field cant blank":this.errorMessageLeadType=""},onAddressCheck(){this.$v.form.$touch(),this.form.address1.length<=0?this.errorMessageAddress="Field cant blank":this.errorMessageAddress=""},onStateCheck(){this.$v.form.$touch(),this.form.locationState.length<=0?this.errorMessageLocationState="Field cant blank":this.errorMessageLocationState=""},onCountryCheck(){this.$v.form.$touch(),this.form.country.length<=0?this.errorMessageCountry="Field cant blank":this.errorMessageCountry=""},filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.countryOptions=this.countries.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.countryOptions=this.countries})},filterState(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.locationStatesOptions=this.locationStates.filter(e=>e.toLowerCase().indexOf(t)>-1)}:()=>{this.locationStatesOptions=this.locationStates})}}},J=Y,K=Object(b["a"])(J,B,z,!1,null,null,null),H=K.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"adduser"}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          New User\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            User detail\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-form",{ref:"myForm",on:{submit:e.onAddUser}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Login ID","lazy-rules":"",error:e.errorMessageLoginId.length>0,rules:[e.textRules,e.onLoginIdCheck]},model:{value:e.form.loginId,callback:function(t){e.$set(e.form,"loginId",t)},expression:"form.loginId"}},[e.errorMessageLoginId.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageLoginId)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Full Name","lazy-rules":"",error:e.errorMessageName.length>0,rules:[e.textRules,e.onNameCheck]},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errorMessageName.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageName)+"\n                  ")])]):e._e()],1),a("q-input",{ref:"password",staticClass:"col q-pb-none",attrs:{outlined:"",type:e.type,rules:[e.textRules,e.onPasswordCheck],error:e.errorMessagePassword.length>0,label:"Password"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-btn",{attrs:{round:"",flat:"",icon:"remove_red_eye"},on:{click:e.onClickShowPasswords}})]},proxy:!0}]),model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[e.errorMessagePassword.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessagePassword)+"\n                  ")])]):e._e()],1),a("div",{staticClass:"row "},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"User Code","lazy-rules":"",debounce:"1000",rules:[e.textRules,e.onSCCodeCheck],error:e.errorMessageSCCode.length>0},model:{value:e.form.sccode,callback:function(t){e.$set(e.form,"sccode",t)},expression:"form.sccode"}},[e.errorMessageSCCode.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errorMessageSCCode)+"\n                    ")])]):e._e()],1),a("q-input",{ref:"mobile",staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",label:"User Contact","lazy-rules":"",rules:[e.onMobileCheck],error:e.errorMessagePhone.length>0,mask:"### - ############","unmasked-value":""},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}},[e.errorMessagePhone.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errorMessagePhone)+"\n                    ")])]):e._e()],1)],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"User Email","lazy-rules":"",debounce:"1000",error:e.errorMessageEmail.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errorMessageEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageEmail)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.branches,label:"Branch Name","emit-value":"","map-options":"","stack-label":"",rules:[e.textRules,e.onBranchCheck],error:e.errorMessageBranchId.length>0},model:{value:e.form.branchId,callback:function(t){e.$set(e.form,"branchId",t)},expression:"form.branchId"}},[e.errorMessageBranchId.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageBranchId)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.roles,label:"User Role","emit-value":"","map-options":"","stack-label":"",rules:[e.textRules,e.onRoleCheck],error:e.errorMessageRole.length>0},on:{input:e.onInputFormRole},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[e.errorMessageRole.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageRole)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Design Cad 4.0 AppUID","lazy-rules":"",debounce:"1000",rules:[e.onAppUIDCheck],error:e.errorMessageAppUID.length>0},model:{value:e.form.appUID,callback:function(t){e.$set(e.form,"appUID",t)},expression:"form.appUID"}},[e.errorMessageAppUID.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageAppUID)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Design Cad 4.0 Email","lazy-rules":"",debounce:"1000",rules:[e.onKujialeEmailCheck,e.emailRules],error:e.errorMessageKujialeEmail.length>0},model:{value:e.form.kujialeEmail,callback:function(t){e.$set(e.form,"kujialeEmail",t)},expression:"form.kujialeEmail"}},[e.errorMessageKujialeEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageKujialeEmail)+"\n                  ")])]):e._e()],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Scope Access\n              ")]),a("q-checkbox",{staticClass:"text-uppercase",attrs:{label:"Select All"},on:{input:e.onClickAllPermissions},model:{value:e.allPermission.selected,callback:function(t){e.$set(e.allPermission,"selected",t)},expression:"allPermission.selected"}}),a("q-separator",{staticClass:"q-my-md"}),e._l(e.permissionOptions.filter((function(e){return e.name.toLowerCase().includes("module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Buttons Access\n              ")]),e._l(e.permissionOptions.filter((function(e){return!e.name.includes("Module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errorMessageSCCode.length>0||e.errorMessageEmail.length>0||e.errorMessagePhone.length>0||e.errorMessagePassword.length>0||e.errorMessageRole.length>0||e.errorMessageBranchId.length>0||e.errorMessageName.length>0},on:{click:e.onAddUser}})],1)],2)])],1)])],1)])],1)},W=[],X=(a("4e82"),a("ebd1")),Z=a("4794"),ee=a("0006"),te=(a("07ac"),a("d600"));const ae=[te["a"].MODULE_QUALIFIED_LEADS,te["a"].MODULE_DESIGN_PROPOSAL,te["a"].MODULE_ORDER_CONFIRMATION,te["a"].MODULE_SERVICE_REPORT],oe=[te["a"].MODULE_SERVICE_REPORT,te["a"].MODULE_MAINTENANCE_REPORT],se=Object.values(te["a"]).filter(e=>e.includes("Module"));var re=Object.freeze({sysadmin:[...se],callcenter:[...se],marketing:[...se],hQManager:[...se],hQsalessupport:[...se],hQAccountant:[...se],salesconsultant:[...ae],branchManager:[...ae,te["a"].MODULE_CAMPAIGN],detailer:[...oe],purchaser:[...oe],logistic:[...oe],factory:[...oe]}),ie={components:{ModalDialog:v},mixins:[x["a"]],data(){return{textRules:[e=>e&&e.length>0&&e.length<13],selectedUserId:"",sccode:"",form:{username:"",password:"",name:"",loginId:"",sccode:"",mobile:"",appUID:"",email:"",kujialeEmail:"",status:!0,module_access:"",designCAD_access:"",branchId:"",role:""},errorMessageSCCode:"",errorMessageEmail:"",errorMessagePhone:"",errorMessagePassword:"",errorMessageRole:"",errorMessageBranchId:"",errorMessageName:"",errorMessageLoginId:"",errorMessageKujialeEmail:"",errorMessageAppUID:"",type:"password",permissionOptions:[],allPermission:{selected:!1}}},validations:{form:{email:{required:M["required"],email:M["email"]},kujialeEmail:{email:M["email"]},password:{required:M["required"],minLength:Object(M["minLength"])(3)},mobile:{required:M["required"],minLength:Object(M["minLength"])(8)},name:{required:M["required"]},loginId:{required:M["required"]},branchId:{required:M["required"]},role:{required:M["required"]}}},computed:{branches(){const e=I["a"].all();console.log("pp",e),e.sort(this.dynamicSort("name"));const t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},roles(){const e=ee["a"].all();e.sort(this.dynamicSort("name"));const t=e.map(e=>{const t=[];return t.name=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.label=e.displayName,t.value=e.uuid,t});return t},users(){return X["a"].query().withAll().get()}},watch:{"allPermission.selected":function(e){e&&this.permissionOptions.forEach(e=>{e.selected=!0})},permissionOptions:{deep:!0,handler(e){const t=e.every(e=>e.selected);this.allPermission.selected=t}}},created(){var e=this;return i()((function*(){e.loadPermissionOptions()}))()},methods:{dynamicSort(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(a,o){return-1===t?o[e].localeCompare(a[e]):a[e].localeCompare(o[e])}},loadPermissionOptions(){var e=this;return i()((function*(){try{yield e.$store.dispatch("GetAllPermissions");const t=Z["a"].all().filter(e=>e.name.includes("Module")||"SKOpenExternalDesignCad"===e.name),a=["SKModuleUserManagement","SKModuleBranchManagement","SKModuleItemList","SKModuleCampaign","SKModuleOnlineLeads","SKModuleQualifiedLeads","SKModuleDesignProposal","SKModuleOrderConfirmation","SKModuleServiceReport","SKModuleMaintenanceReport","SKOpenExternalDesignCad"],o=a.map(e=>t.find(t=>t.name===e));e.permissionOptions=o,console.log("sorted",o)}catch(t){console.log(t)}}))()},reset(){this.errorMessageSCCode="",this.errorMessageEmail="",this.errorMessagePhone="",this.errorMessagePassword="",this.errorMessageRole="",this.errorMessageBranchId="",this.errorMessageName="",this.errorMessageLoginId="",this.errorMessageKujialeEmail="",this.errorMessageAppUID="",this.form={username:"",password:"",name:"",sccode:"",appUID:"",mobile:"",email:"",kujialeEmail:"",status:!0,module_access:"",designCAD_access:"",branchId:"",role:""}},onAddUser(){var e=this;return i()((function*(){const t=n()({},e.form),a=[],o=e.permissionOptions.filter(e=>e.selected);o.forEach(e=>{a.push(e.getBodyRequest.uuid)}),e.$refs.myForm.validate().then(function(){var o=i()((function*(o){if(o){e.$q.loading.show();const o=yield e.$store.dispatch("RegisterUser",t);e.$refs.dialog.$children[0].hide();for(const t of a)yield e.$store.dispatch("AssignPermissionToUser",{userUuid:o.uuid,permissionUuid:t});console.log(t),e.$q.loading.hide(),e.$notify("success",`User with name ${t.name} created!`),e.reset()}else e.$q.loading.hide(),e.$notify("error","All field is required");e.permissionOptions.forEach(e=>{e.selected=!1})}));return function(e){return o.apply(this,arguments)}}())}))()},onClickShowPasswords(){"password"===this.type?this.type="text":this.type="password"},onInputFormRole(){let e=this.roles.find(e=>e.value===this.form.role).name;e=e.charAt(0).toLowerCase()+e.slice(1);const t=re[e];this.permissionOptions.forEach(e=>{e.selected=!!t.includes(e.name)})},onSCCodeCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.sccode.length<=0?e.errorMessageSCCode="Field cannot be blank":yield e.$store.dispatch("CheckSCCodeExist",e.form.sccode).then(t=>{e.errorMessageSCCode=t?"SC Code already exist":""})}))()},onEmailCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.email.length<=0?e.errorMessageEmail="Field cant be blank":yield e.$store.dispatch("CheckEmailExist",e.form.email).then(t=>{e.errorMessageEmail=t?"Email already exist":""})}))()},onKujialeEmailCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),0===e.form.kujialeEmail.length)return!0;yield e.$store.dispatch("CheckKujialeEmailExist",e.form.kujialeEmail).then(t=>{e.errorMessageKujialeEmail=t?"Design Cad 4.0 Email already exist":""})}))()},onAppUIDCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),0===e.form.appUID.length)return!0;yield e.$store.dispatch("CheckAppUIDExist",e.form.appUID).then(t=>{e.errorMessageAppUID=t?"Design Cad 4.0 AppUID already exist":""})}))()},onMobileCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.mobile.length<=0?e.errorMessagePhone="Field cant be blank":(yield e.$store.dispatch("CheckMobileExist",e.form.mobile).then(t=>{e.errorMessagePhone=t?"Mobile already exist":""}),e.form.mobile.length>=10&&e.form.mobile.length<=15||(e.errorMessagePhone="Mobile No. must between 10-15 digits"))}))()},onPasswordCheck(){this.$v.form.$touch(),this.form.password.length<4||this.form.password.length>12?this.errorMessagePassword="Password length must be from 4 to 12 characters":this.errorMessagePassword=""},onRoleCheck(){this.$v.form.$touch(),this.form.role.length<=0?this.errorMessageRole="Field cant blank":this.errorMessageRole=""},onLoginIdCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.loginId.length<=0?e.errorMessageLoginId="Field cant blank":e.errorMessageLoginId="",yield e.$store.dispatch("CheckLoginIdExist",e.form.loginId).then(t=>{e.errormessage9=t?"Login Id already exist":""})}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errorMessageName="Field cant blank":this.errorMessageName=""},onBranchCheck(){this.$v.form.$touch(),this.form.branchId.length<=0?this.errorMessageBranchId="Field cant blank":this.errorMessageBranchId=""},onClickAllPermissions(e){e?this.permissionOptions.forEach(e=>{e.selected=!0}):this.form.role?this.onInputFormRole():this.permissionOptions.forEach(e=>{e.selected=!1})}}},le=ie,ne=Object(b["a"])(le,V,W,!1,null,null,null),de=ne.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"assigntodesign"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign Leads to Design Proposal\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Lead Details\n          ")]),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Email",disable:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Mobile",disable:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Full Property Address (Site Address)"},model:{value:e.form.siteAddress,callback:function(t){e.$set(e.form,"siteAddress",t)},expression:"form.siteAddress"}})],1),a("q-input",{attrs:{outlined:"",label:"NRIC First 6 Characters",type:"number",mask:"######",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"},function(e){return 6!=e.length||"Must only have 6 characters"}],"lazy-rules":""},model:{value:e.form.nricFirstSixCharacters,callback:function(t){e.$set(e.form,"nricFirstSixCharacters",e._n(t))},expression:"form.nricFirstSixCharacters"}}),a("q-select",{attrs:{outlined:"",options:e.options.race,label:"Race","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}],"lazy-rules":""},model:{value:e.form.race,callback:function(t){e.$set(e.form,"race",t)},expression:"form.race"}}),a("q-select",{attrs:{outlined:"",options:e.options.age,label:"Age group","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}],"lazy-rules":""},model:{value:e.form.age,callback:function(t){e.$set(e.form,"age",t)},expression:"form.age"}}),a("q-select",{attrs:{outlined:"",options:e.options.propertyStatus,label:"Property status","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}]},model:{value:e.form.propertyStatus,callback:function(t){e.$set(e.form,"propertyStatus",t)},expression:"form.propertyStatus"}}),a("q-select",{attrs:{outlined:"",options:e.options.renovationStatus,label:"Renovation status","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}]},model:{value:e.form.renovationStatus,callback:function(t){e.$set(e.form,"renovationStatus",t)},expression:"form.renovationStatus"}}),a("q-select",{attrs:{outlined:"",options:e.options.propertyUsageStatus,label:"Property usage status","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}]},model:{value:e.form.propertyUsageStatus,callback:function(t){e.$set(e.form,"propertyUsageStatus",t)},expression:"form.propertyUsageStatus"}}),a("q-select",{attrs:{outlined:"",options:e.options.propertyType,label:"Property type","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}]},model:{value:e.form.propertyType,callback:function(t){e.$set(e.form,"propertyType",t)},expression:"form.propertyType"}}),a("q-select",{attrs:{outlined:"",options:e.options.propertyValue,label:"Property value (RM)","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}]},model:{value:e.form.propertyValue,callback:function(t){e.$set(e.form,"propertyValue",t)},expression:"form.propertyValue"}}),a("q-select",{attrs:{outlined:"",options:e.options.buildUpSizeSquareFeet,label:"Build up size (square feet)","emit-value":"","map-options":"","stack-label":"",rules:[function(e){return null!==e&&""!==e||"Field cannot be blank"}]},model:{value:e.form.buildUpSizeSquareFeet,callback:function(t){e.$set(e.form,"buildUpSizeSquareFeet",t)},expression:"form.buildUpSizeSquareFeet"}}),a("q-separator"),a("div",{staticClass:"row justify-end"},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1),a("div",[a("q-btn",{attrs:{label:"submit",color:"primary",disabled:e.isBtnDisabled},on:{click:e.onAssignLeads}}),e.isBtnDisabled?a("q-tooltip",[e._v("\n                Lead is not assigned to a Sales Consultant\n              ")]):e._e()],1)])],1)])],1)])],1)},ue=[],me=a("a193"),pe={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{branchId:"",siteAddress:"",race:"",age:"",nricFirstSixCharacters:"",propertyStatus:"",renovationStatus:"",propertyUsageStatus:"",propertyType:"",propertyValue:"",buildUpSizeSquareFeet:""},suggestedBranchId:"",options:{race:["Malay","Indian","Chinese","Others"],age:["<=29","30-39","40-49",">=50"],propertyStatus:["New","Second Hand","Existing"],renovationStatus:["Ready for Cabinet Installation, Renovation in Progress","Renovation not Started"],propertyUsageStatus:["Own Stay","For Rent/Investment"],propertyType:["Condo/Apartment","Terrace/Link/Townhouse","Semi-Detached","Bungalow","Studio/SOHO","Shop/Office"],propertyValue:["<500k","500k - 749k","750k - 999k","1 mil - 1.9 mil","2 mil - 4 mil",">4 mil"],buildUpSizeSquareFeet:["<=1000","1001-1500","1501-2000","2001-3000",">3000"]}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isBtnDisabled(){return"Assigned"!==this.form.status},selections(){const e=this.$store.getters.tableSelection;if(!e.length)return[];if(!e[0]instanceof me["a"])return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},selections(e,t){e.length&&(this.selectedLeadId=this.selections[0].value)}},methods:{reset(){this.selectedLeadId="",this.form={}},onAssignLeads(){var e=this;return i()((function*(){const t=n()({},e.form);try{me["a"].update({where:t.$id,data:t}),e.$q.loading.show(),yield e.$store.dispatch("AssignLeadToDesign",t),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Successfully assigned lead to Design Proposal")}catch(a){console.log(a);const t=a.response.message.error;e.$q.loading.hide(),e.$notify("error",t)}}))()}}},he=pe,fe=Object(b["a"])(he,ce,ue,!1,null,null,null),ge=fe.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"qualifyQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign Leads to Sales Consultant\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Assign leads to Sales Consultant\n          ")]),"sysadmin"!==e.roles[0]?a("div",[a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.salesConsultantsOptions,label:"Selected sales consultant",disable:!e.salesConsultantsOptions.length||e.branchManagerAssignLeadToSelf,"emit-value":"","map-options":"","stack-label":""},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}}),e.salesConsultantsOptions.length?e._e():a("q-tooltip",[e._v("\n              There are no Sales Consultant in your branch.\n            ")]),e.branchManagerAssignLeadToSelf?a("q-tooltip",[e._v("\n              You cannot assign a lead to a Sales Consultant in your branch if you want to assign the lead to yourself.\n            ")]):e._e()],1):e._e(),"sysadmin"===e.roles[0]&&e.isSalesConsultantLoaded?a("div",e._l(Object.keys(e.branchesUsersMap),(function(t){return a("div",{key:t.value},[a("q-select",{staticClass:"col q-mt-sm",attrs:{outlined:"",options:e.branchesUsersMap[t],label:t,disable:!e.branchesUsersMap[t].length,"emit-value":"","map-options":"",clickable:"","stack-label":"","options-selected-class":"text-deep-orange"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(a){a.stopPropagation(),e.assignModel[t]=""}}})]},proxy:!0}],null,!0),model:{value:e.assignModel[t],callback:function(a){e.$set(e.assignModel,t,a)},expression:"assignModel[branch]"}}),e.branchesUsersMap[t].length?e._e():a("q-tooltip",[e._v("\n                There are no Sales Consultant in this branch.\n              ")])],1)})),0):e._e(),a("div",{staticClass:"col"},[a("q-checkbox",{staticClass:"col",attrs:{label:"Assign lead to self"},model:{value:e.branchManagerAssignLeadToSelf,callback:function(t){e.branchManagerAssignLeadToSelf=t},expression:"branchManagerAssignLeadToSelf"}},[a("q-tooltip",[e._v("\n                Check this box if you are a branch manager and wish to assign a qualified lead for yourself\n              ")])],1)],1),a("q-separator"),a("div",{staticClass:"row justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md",attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"assign",color:"primary",disable:e.leadHasBeenAssigned||e.leadAssignmentChoiceInvalid},on:{click:e.onAssignLeads}}),e.leadHasBeenAssigned?a("q-tooltip",[e._v("\n                Lead is already assigned\n              ")]):e._e(),e.leadAssignmentChoiceInvalid?a("q-tooltip",[e._v("\n                Either assign this lead to a Sales Consultant or to yourself.\n              ")]):e._e()],1)],1)],1)])],1)])],1)},ye=[],ve={components:{ModalDialog:v},data(){return{selectedLeadId:"",salesConsultants:[],form:{},selections:[],branchesUsersMap:{},assignModel:{},isSalesConsultantLoaded:!1,branchManagerAssignLeadToSelf:!1}},computed:n()(n()({},Object(q["b"])(["tableSelection","roles","userId"])),{},{leadHasBeenAssigned(){return"Assigned"===this.form.status||"Pending Visit"===this.form.status},leadAssignmentChoiceInvalid(){return!this.branchManagerAssignLeadToSelf&&!this.form.userId},salesConsultantsOptions(){if(!this.salesConsultants.length)return[];const e=this.salesConsultants.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t});return e},selectedSCName(){return this.form.userId?this.salesConsultantsOptions.find(e=>e.value===this.form.userId).label:""}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},assignModel:{deep:!0,handler(e){for(const t in e)if(e[t])return this.form.userId=e[t],void console.log(t,this.form.userId)}}},methods:{onShowDialog(){var e=this;return i()((function*(){if(e.selections=e.$store.getters.tableSelection,!e.selections.length)return;e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value,e.$q.loading.show(),yield e.$store.dispatch("GetAllRoles");const t=ee["a"].query().where("name","salesconsultant").first().$id,a={where:{branchId:e.$store.state.user.branchId}};if(e.roles[0].includes("sysadmin")){yield e.$store.dispatch("GetAllBranches",{});const a=I["a"].all().filter(e=>"HQ"!==e.name);for(const t of a)e.branchesUsersMap[t.name]=[],e.$set(e.assignModel,t.name,"");e.salesConsultants=(yield e.$store.dispatch("GetRoleUsers",{id:t})).data.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t.branchId=e.branchId,t});for(const t of e.salesConsultants){const[a]=yield I["a"].query().withAll().whereId(t.branchId).get();"HQ"!==a.name&&(e.branchesUsersMap[a.name]||(e.branchesUsersMap[a.name]=[]),e.branchesUsersMap[a.name].push(t),e.branchesUsersMap[a.name].map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}))}e.$q.loading.hide()}else e.$q.loading.hide(),e.salesConsultants=(yield e.$store.dispatch("GetRoleUsers",{id:t,filter:a})).data;e.isSalesConsultantLoaded=!0}))()},reset(){this.selectedLeadId="",this.form={}},onAssignLeads(){var e=this;return i()((function*(){e.branchManagerAssignLeadToSelf&&(e.form.userId=e.userId);const t=n()({},e.form);console.log("lead",t);try{e.$q.loading.show(),yield e.$store.dispatch("AssignLeadToSC",t),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Successfully assigned lead"),console.log("entering ere")}catch(a){e.$q.loading.hide(),console.log("error cb here",a)}}))()}}},qe=ve,xe=Object(b["a"])(qe,be,ye,!1,null,null,null),Ce=xe.exports,we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"qualifyOL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign Leads to Branch\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Assign branch to qualified lead\n          ")]),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.branches,label:"Assign to Branch","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.branchId,callback:function(t){e.$set(e.form,"branchId",t)},expression:"form.branchId"}}),a("q-input",{staticClass:"col",attrs:{type:"textarea",outlined:"",label:"Remark"},model:{value:e.form.noteToBranch,callback:function(t){e.$set(e.form,"noteToBranch",t)},expression:"form.noteToBranch"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"assign",color:"primary",disabled:e.isAssignBtnDisabled},on:{click:e.onAssignLeads}})],1)],1)])],1)])],1)},ke=[],_e={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{branchId:""},suggestedBranchId:""}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isAssignBtnDisabled(){return""===this.selectedLeadId||!this.form.branchId},branches(){const e=I["a"].all(),t=e.filter(e=>"HQ"!==e.name).map(e=>{const t={};return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection;if(!e.length)return[];if(!e[0]instanceof me["a"])return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t},selectedBranchName(){return this.selectedBranchId?this.branches.find(e=>e.value===this.selectedBranchId).label:""}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},selections(e,t){e.length&&(this.selectedLeadId=this.selections[0].value)}},methods:{onShowDialog(){this.getBranchRecommendation()},getBranchRecommendation(){var e=this;return i()((function*(){e.selectedBranchId="";try{yield e.$store.dispatch("getRecommendedBranch").then(t=>{e.form.branchId=t.branch,e.suggestedBranchId=t.branch})}catch(t){e.$notify("error","Failed to get branch recommendation")}}))()},onAssignLeads(){var e=this;return i()((function*(){const t=n()({},e.form);try{console.log(t),e.$q.loading.show(),yield e.$store.dispatch("AssignLeadToBranch",t),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Successfully assigned lead to branch "+e.selectedBranchName)}catch(a){console.log(a),e.$q.loading.hide(),e.$notify("error","Failed to assign lead to branch. Please try again")}}))()},reset(){this.selectedLeadId="",this.suggestedBranchId="",this.form={}}}},Se=_e,Ae=Object(b["a"])(Se,we,ke,!1,null,null,null),Me=Ae.exports,Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"assignScope"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign scope access to modules\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a user\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected user","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedUserId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Roles\n            ")]),a("q-form",{ref:"myForm",on:{submit:e.onAssignUser}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"col"},[a("q-select",{attrs:{outlined:"",options:e.roles,"stack-label":"",label:"Roles",error:e.$v.form.role.$error},on:{input:e.onInputFormRole},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}})],1),a("div",{staticClass:"text-negative"},[e._v("\n                  "+e._s(e.errormessage)+"\n                ")]),a("div",{staticClass:"text-negative"},[e._v("\n                  "+e._s(e.errormessage2)+"\n                ")]),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                  Scope Access for User\n                ")]),a("q-checkbox",{staticClass:"text-uppercase",attrs:{label:"Select All"},on:{input:e.onClickAllPermissions},model:{value:e.allPermission.selected,callback:function(t){e.$set(e.allPermission,"selected",t)},expression:"allPermission.selected"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                  Modules Access\n                ")]),e._l(e.permissionOptions.filter((function(e){return e.name.includes("Module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                  Buttons Access\n                ")]),e._l(e.permissionOptions.filter((function(e){return!e.name.includes("Module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errormessage.length>0||e.errormessage2.length>0},on:{click:e.onAssignUser}})],1)],2)])]:e._e()],2)])],1)])],1)},$e=[],De=a("0f30"),Te={components:{ModalDialog:v},data(){return{textRules:[e=>e&&e.length>0],options:{roles:[]},selectedUserId:"",form:{role:{}},errormessage:"",errormessage2:"",type:"password",permissionOptions:[],allPermission:{selected:!1}}},validations:{form:{role:{required:M["required"]}}},computed:n()(n()({profile(){const e=De["a"].query().where("userId",this.selectedUserId).first();return this.reassignProfile(e),e}},Object(q["b"])(["tableSelection"])),{},{users(){return X["a"].query().withAll().get()},roles(){const e=ee["a"].all(),t=e.map(e=>{const t=[];return t.name=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.label=e.displayName,t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection;if(!e.length)return[];if(!(e[0]instanceof X["a"]))return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{"allPermission.selected":function(e){e&&this.permissionOptions.forEach(e=>{e.selected=!0})},permissionOptions:{deep:!0,handler(e){this.allPermission.selected=e.every(e=>e.selected)}},selectedUserId(e,t){var a=this;return i()((function*(){if(a.selectedUserId){const e=yield a.$store.dispatch("GetUserPermissions",a.selectedUserId);a.permissionOptions.map(t=>{t.selected=!1;for(const a of e.data)t.uuid===a.uuid&&(t.selected=!0)}),yield a.$store.dispatch("GetUserRoles",a.selectedUserId);const t=X["a"].query().withAll().where("uuid",a.selectedUserId).first();if(t.roles.length){const e=a.options.roles.find(e=>e.value===t.roles[0].$id);a.form.role=e}}a.errormessage=""}))()},selections(e,t){e.length&&(this.selectedUserId=e[0].value)}},created(){var e=this;return i()((function*(){e.loadRoleOptions(),e.loadPermissionOptions()}))()},methods:{reset(){this.selectedUserId="",this.errormessage="",this.errormessage2="",this.form={role:""}},onAssignUser(){var e=this;return i()((function*(){const t=e.permissionOptions.filter(e=>e.selected),a=[];for(const e of t)a.push(e.uuid);try{e.$q.loading.show(),yield e.$store.dispatch("UpdateUserPermission",{userId:e.selectedUserId,permissionIds:a,rolesIds:[e.form.role.value]}),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","User roles & permissions have been updated.")}catch(o){console.log(o),e.$q.loading.hide(),e.$notify("error","Error updating user roles & permissions. Try again.")}}))()},loadRoleOptions(){var e=this;return i()((function*(){const t=yield e.$store.dispatch("GetAllRoles");t.forEach(t=>{e.options.roles.push({value:t.uuid,label:t.name.charAt(0).toUpperCase()+t.name.slice(1)})})}))()},loadPermissionOptions(){var e=this;return i()((function*(){try{yield e.$store.dispatch("GetAllPermissions"),e.permissionOptions=Z["a"].all().filter(e=>e.name.includes("Module")||"SKOpenExternalDesignCad"===e.name)}catch(t){console.log(t)}}))()},onInputFormRole(){if(!this.form.role.value)return;let e=this.options.roles.find(e=>e.value===this.form.role.value).label;e=e.charAt(0).toLowerCase()+e.slice(1);const t=re[e];this.permissionOptions.forEach(e=>{e.selected=!!t.includes(e.name)})},onClickAllPermissions(e){e?this.permissionOptions.forEach(e=>{e.selected=!0}):this.form.role?this.onInputFormRole():this.permissionOptions.forEach(e=>{e.selected=!1})}}},Oe=Te,Ne=Object(b["a"])(Oe,Ie,$e,!1,null,null,null),Re=Ne.exports,Fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"userassignrole"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          User Role Edit\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a user\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected user","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedUserId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Select user roles\n            ")]),a("q-option-group",{attrs:{options:e.rolesOpt,label:"Roles",type:"checkbox"},model:{value:e.form.roles,callback:function(t){e.$set(e.form,"roles",t)},expression:"form.roles"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Update"},on:{click:e.onUpdateUser}})],1)]:e._e()],2)])],1)])],1)},je=[],Le={components:{ModalDialog:v},data(){return{selectedUserId:"",form:{roles:[]}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{rolesOpt(){const e=ee["a"].all(),t=e.map(e=>{const t={};return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection,t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,this.loadUserRole(e.uuid),t});return t}}),watch:{selectedUserId(e,t){const a=X["a"].query().where("uuid",this.selectedUserId).withAll().first();if(this.form.roles=[],a.roles)for(const o of a.roles)this.form.roles.push(o.uuid)}},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllRoles")}))()},methods:{reset(){this.selectedUserId="",this.form={}},loadUserRole(e){var t=this;return i()((function*(){try{yield t.$store.dispatch("GetUserRoles",e)}catch(a){const e=a.response.message.error;t.$notify("error",e)}}))()},onUpdateUser(){var e=this;return i()((function*(){try{for(const t of e.form.roles)yield e.$store.dispatch("AssignUserRole",{userId:e.selectedUserId,roleId:t});e.$refs.dialog.$children[0].hide(),e.$notify("success",`User with name ${e.form.name} updated!`)}catch(t){console.log(t);const a=t.response.message.error;e.$notify("error",a)}}))()}}},Ee=Le,Pe=Object(b["a"])(Ee,Fe,je,!1,null,null,null),Ue=Pe.exports,Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"rrbranch"},on:{"show-dialog":e.setupBranchesList,"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n        Arrange Branches\n      ")])]),a("div",{staticClass:"q-pa-md"},[e.form.length>0?a("q-list",[a("q-item",{staticClass:"row"},[a("q-item-section",{staticClass:"col-2"},[e._v("\n            Priority\n          ")]),a("q-item-section",{staticClass:"col"},[e._v("\n            Branch Name\n          ")]),a("q-item-section",{staticClass:"col-2"},[e._v("\n            Sales Consultant Available\n          ")]),a("q-item-section",{staticClass:"col-2"},[e._v("\n            Multiplier\n          ")]),a("q-item-section",{staticClass:"col-2"},[e._v("\n            Capacity\n          ")])],1),e._l(e.branches,(function(t,o){return a("q-item",{key:t.uuid,staticClass:"row"},[e.form[o]?a("q-item-section",{staticClass:"col-2"},[a("q-input",{attrs:{filled:"",dense:"",min:1,type:"number",error:e.hasSamePriorities(e.form[o].priority,o)||e.isValidPriorityValue(e.form[o].priority,o)},scopedSlots:e._u([{key:"error",fn:function(){return[e._v("\n                "+e._s(e.errors[o].priority)+"\n              ")]},proxy:!0}],null,!0),model:{value:e.form[o].priority,callback:function(t){e.$set(e.form[o],"priority",e._n(t))},expression:"form[index].priority"}})],1):e._e(),a("q-item-section",{staticClass:"col q-mb-md"},[e._v("\n            "+e._s(t.name)+" ("+e._s(t.code)+")\n          ")]),e.form[o]?a("q-item-section",{staticClass:"col-2 q-mb-md"},[a("q-input",{attrs:{filled:"",dense:"",disable:""},model:{value:e.form[o].scCount,callback:function(t){e.$set(e.form[o],"scCount",e._n(t))},expression:"form[index].scCount"}})],1):e._e(),e.form[o]?a("q-item-section",{staticClass:"col-2"},[a("q-input",{attrs:{filled:"",dense:"",min:0,type:"number",error:e.isValidMultiplierValue(e.form[o].multiplier,o)},scopedSlots:e._u([{key:"error",fn:function(){return[e._v("\n                "+e._s(e.errors[o].multiplier)+"\n              ")]},proxy:!0}],null,!0),model:{value:e.form[o].multiplier,callback:function(t){e.$set(e.form[o],"multiplier",e._n(t))},expression:"form[index].multiplier"}})],1):e._e(),e.form[o]?a("q-item-section",{staticClass:"col-2 q-mb-md"},[a("q-input",{attrs:{filled:"",dense:"",disable:""},model:{value:e.form[o].leadcapacity,callback:function(t){e.$set(e.form[o],"leadcapacity",e._n(t))},expression:"form[index].leadcapacity"}})],1):e._e()],1)}))],2):e._e(),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"row justify-between"},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Close"}}),a("q-btn",{attrs:{color:"primary",label:"Save",disabled:e.isSaveButtonDisabled},on:{click:e.onClickSave}})],1)])],1)],1)],1)},ze=[],Ge=(a("a434"),{components:{ModalDialog:v},data(){return{form:[],branches:[],errors:[]}},computed:{fakeForm(){return JSON.parse(JSON.stringify(this.form))},isSaveButtonDisabled(){return this.form.some((e,t)=>this.hasSamePriorities(e.priority,t)||this.isValidPriorityValue(e.priority,t)||this.isValidMultiplierValue(e.multiplier,t))}},watch:{fakeForm:{deep:!0,handler(e,t){if(e.length!==t.length)return;const[a]=e.filter((e,a)=>e.multiplier!==t[a].multiplier);if(!a)return;const o=this.form.findIndex(e=>e.uuid===a.uuid);this.form[o].leadcapacity=parseInt(this.form[o].scCount*this.form[o].multiplier)}}},methods:{setupBranchesList(){var e=this;return i()((function*(){e.$q.loading.show(),e.branches=yield I["a"].query().where("code",e=>"HQ"!==e).orderBy("priority","ASC").get();const{data:t}=yield e.$repository.role.listing({where:{name:"salesconsultant"}}),[a]=t;for(const o of e.branches){const{data:t}=yield e.$repository.role.users(a.uuid,{where:{branchId:o.uuid}}),{length:s}=t;e.form.push({isInRR:!!o.isInRR&&o.isInRR,multiplier:o.multiplier,priority:o.priority,scCount:s,leadcapacity:o.leadcapacity?o.leadcapacity:0,type:o.type,uuid:o.uuid})}e.$q.loading.hide()}))()},onClickSave(){var e=this;return i()((function*(){try{e.$q.loading.show();for(const t of e.form)yield e.$store.dispatch("UpdateBranchRotation",t);e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Branch round robin configuration successfully updated!")}catch(t){console.log(t),e.$q.loading.hide(),e.$notify("error","Branch round robin configuration faile to be updated!")}}))()},hasSamePriorities(e,t){this.errors[t]||(this.errors[t]={}),e=parseInt(e);const a=this.form.map(e=>e.priority);return a.splice(t,1),!!a.some(t=>t===e)&&(this.errors[t].priority="No similar priorities.",!0)},isValidMultiplierValue(e,t){return this.errors[t]||(this.errors[t]={}),e=parseFloat(e),Number.isNaN(e)?(this.errors[t].multiplier="Multiplier required.",!0):e<0?(this.errors[t].multiplier="Multiplier must be more than 0",!0):!Number.isInteger(e)&&(this.errors[t].multiplier="Multiplier must be in whole number.",!0)},isValidPriorityValue(e,t){return this.errors[t]||(this.errors[t]={}),e=parseInt(e),Number.isNaN(e)?(this.errors[t].priority="Priority required.",!0):e<1?(this.errors[t].priority="Priority must be more than 1.",!0):!Number.isInteger(e)&&(this.errors[t].priority="Priority must be in whole number.",!0)},reset(){this.form=[]}}}),Qe=Ge,Ye=Object(b["a"])(Qe,Be,ze,!1,null,null,null),Je=Ye.exports,Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"delete"}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Are you sure?\n      ")])]),a("q-card-section",{staticClass:"row items-center"},[e._v("\n      Do you really want to delete this\n      "),a("span",{staticClass:"text-weight-bold"},[e._v(e._s(e.tableSelection.length)+" record(s)")]),e._v(" ?\n    ")]),a("q-card-section",{staticClass:"row items-center text-negative text-weight-bold"},[e._v("\n      This process cannot be undone\n    ")]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Delete",color:"negative"},on:{click:e.onClickDelete}})],1)],1)],1)},He=[],Ve={components:{ModalDialog:v},computed:n()({},Object(q["b"])(["datatabs","activeDataTab","tableSelection"])),methods:{onClickDelete(){var e=this;this.tableSelection.forEach(function(){var t=i()((function*(t){try{e.$q.loading.show(),yield e.$store.dispatch("DeleteData",t.uuid),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Delete item successful!")}catch(a){const t=a.response.data.error.message;console.log(t),e.$q.loading.hide(),e.$notify("error","Error: "+t)}}));return function(e){return t.apply(this,arguments)}}()),this.$store.dispatch("OnTableSelection",[])}}},We=Ve,Xe=Object(b["a"])(We,Ke,He,!1,null,null,null),Ze=Xe.exports,et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"detailedQuotation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Detailed Quotation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Drawings\n          ")]),a("q-checkbox",{staticClass:"text-uppercase",attrs:{label:"Select All Drawings"},on:{input:e.onClickAllDrawings},model:{value:e.allDrawing.selected,callback:function(t){e.$set(e.allDrawing,"selected",t)},expression:"allDrawing.selected"}}),a("q-separator",{staticClass:"q-my-md"}),e._l(e.drawings,(function(t){return a("q-list",{key:t.uuid,staticClass:"row"},[a("q-chip",{staticClass:"row q-ml-lg",attrs:{color:"primary","text-color":"white"}},[e._v("\n              "+e._s(t.referenceName)+"\n            ")]),a("div",{staticClass:"row justify-center"},[a("q-checkbox",{attrs:{val:t.uuid},on:{input:e.onClickRemoveAllDrawings},model:{value:e.drawingSelections,callback:function(t){e.drawingSelections=t},expression:"drawingSelections"}}),a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Drawing Number",disable:""},model:{value:t.drawingNumber,callback:function(a){e.$set(t,"drawingNumber",a)},expression:"drawing.drawingNumber"}}),a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Total Price (RM)",disable:""},model:{value:t.discountedTotalPrice,callback:function(a){e.$set(t,"discountedTotalPrice",a)},expression:"drawing.discountedTotalPrice"}}),a("q-btn",{attrs:{outline:"",color:"primary",label:"Edit","no-caps":""},on:{click:function(a){return e.onClickDetailed(t.uuid)}}})],1)],1)}))],2)]),e.drawings.length?a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Additional Charges\n        ")]),a("q-separator",{staticClass:"q-mb-md"}),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Lump Sum Discount")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{label:"Lump Sum",value:e.lumpsum,prefix:"RM",outlined:"",dense:""},model:{value:e.lumpsum,callback:function(t){e.lumpsum=e._n(t)},expression:"lumpsum"}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Installation Charges")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{prefix:"RM",value:e.totalInstallationCharges,outlined:"",dense:"",disable:""}}),e.enableOptionalIncludeMiscPrices()?a("q-checkbox",{staticClass:"col",attrs:{label:"Include"},model:{value:e.drawings[0].isIncludedInstallationCharge,callback:function(t){e.$set(e.drawings[0],"isIncludedInstallationCharge",t)},expression:"drawings[0].isIncludedInstallationCharge"}}):a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Installer Outstation Charges")])]),a("q-input",{staticClass:"col",attrs:{label:"Distance",suffix:"KM",outlined:"",dense:""},model:{value:e.drawings[0].installerOutstationDistance,callback:function(t){e.$set(e.drawings[0],"installerOutstationDistance",e._n(t))},expression:"drawings[0].installerOutstationDistance"}}),a("q-input",{staticClass:"col",attrs:{value:e.installerOutstationCharge,prefix:"RM",outlined:"",dense:"",disable:""}}),e.enableOptionalIncludeMiscPrices()?a("q-checkbox",{staticClass:"col",attrs:{label:"Include"},model:{value:e.drawings[0].isIncludedInstallerOutstationCharge,callback:function(t){e.$set(e.drawings[0],"isIncludedInstallerOutstationCharge",t)},expression:"drawings[0].isIncludedInstallerOutstationCharge"}}):a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Transportation Charges")])]),a("q-input",{staticClass:"col",attrs:{label:"Distance",suffix:"KM",outlined:"",dense:""},model:{value:e.drawings[0].transportationDistance,callback:function(t){e.$set(e.drawings[0],"transportationDistance",e._n(t))},expression:"drawings[0].transportationDistance"}}),a("q-input",{staticClass:"col",attrs:{value:e.transportationCharge,prefix:"RM",outlined:"",dense:"",disable:""}}),e.enableOptionalIncludeMiscPrices()?a("q-checkbox",{staticClass:"col",attrs:{label:"Include"},model:{value:e.drawings[0].isIncludedTransportationCharge,callback:function(t){e.$set(e.drawings[0],"isIncludedTransportationCharge",t)},expression:"drawings[0].isIncludedTransportationCharge"}}):a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"}),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{value:e.totalAdditionalCharge,prefix:"RM",label:"Total Charges",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Grand Total")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{value:e.grandTotal,prefix:"RM",label:"Grand Total",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1)],1):e._e(),a("q-card-actions",{attrs:{align:"right"}},[a("div",{staticClass:"q-mt-lg",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Calculate Additional Charges","no-caps":""},on:{click:e.onClickCalculateAdditionalCharges}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{color:"primary",label:"To Summary","no-caps":"",disabled:!e.buttonToggles.clickedCalculateAdditionalCharges},on:{click:e.onClickSubmit}}),e.buttonToggles.clickedCalculateAdditionalCharges?e._e():a("q-tooltip",[e._v("\n            Please recalculate additional charges first\n          ")])],1)])],1)])],1)},tt=[],at={components:{ModalDialog:v},mixins:[x["a"]],data(){return{selectedLeadId:"",selections:[],drawingSelections:[],form:{},drawings:{},isSummary:null,lumpsum:0,buttonToggles:{clickedCalculateAdditionalCharges:!1},allDrawing:{selected:!1}}},computed:n()(n()({},Object(q["b"])(["tableSelection","roles"])),{},{totalInstallationCharges(){let e=0;return this.drawings.forEach(t=>{this.drawingSelections.includes(t.uuid)&&(e+=Math.ceil(t.totalInstallationCharges),console.log("TOTAL INSTALLATION CHARGES"),console.log(t.totalInstallationCharges))}),e},installerOutstationCharge(){let e=0;return this.drawings.forEach(t=>{this.drawingSelections.includes(t.uuid)&&(e+=Math.ceil(t.installerOutstationCharge),console.log("TOTAL TRANSPORTATION CHARGES"),console.log(t.installerOutstationCharge))}),e},transportationCharge(){let e=0;return this.drawings.forEach(t=>{this.drawingSelections.includes(t.uuid)&&(e+=Math.ceil(t.transportationCharge),console.log("TOTAL OUTSTATION CHARGES"),console.log(t.transportationCharge))}),e},totalAdditionalCharge(){const[e]=this.drawings,{isIncludedInstallationCharge:t,isIncludedTransportationCharge:a,isIncludedInstallerOutstationCharge:o}=e;let s=0;return s+=t?this.totalInstallationCharges:0,s+=a?this.installerOutstationCharge:0,s+=o?this.transportationCharge:0,Math.ceil(s.toFixed(2))},grandTotal(){const[e]=this.drawings,{isIncludedInstallationCharge:t,isIncludedTransportationCharge:a,isIncludedInstallerOutstationCharge:o}=e;let s=0;s+=t?this.totalInstallationCharges:0,s+=a?this.transportationCharge:0,s+=o?this.installerOutstationCharge:0;let r=0,i=0;return console.log("aa",this.drawings),this.drawings.forEach(e=>{console.log("d",e.isToSummary),this.drawingSelections.includes(e.uuid)&&(i+=e.discountedTotalPrice)}),r+=i+s,r-=this.lumpsum,Math.ceil(r.toFixed(2))}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},methods:{enableOptionalIncludeMiscPrices(){return!this.roles.includes("salesconsultant")},onShowDialog(){var e=this;return i()((function*(){var t,a;if(e.selections=e.$store.getters.tableSelection,!e.selections.length)return;e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value,e.$q.loading.show();const o=yield e.$store.dispatch("GetDetailedQuotations",e.selectedLeadId);e.drawings=o;for(let s=0;s<e.drawings.length;s++)e.drawings[s].discountedTotalPriceDrawingItems||(e.drawings[s].discountedTotalPriceDrawingItems=Math.ceil(e.drawings[s].totalPriceDrawingItems)),e.drawings[s].discountedTotalPrice||(e.drawings[s].discountedTotalPrice=Math.ceil(e.drawings[s].totalPrice)),e.drawings[s].totalPrice=Math.ceil(e.drawings[s].totalPrice),e.drawings[s].discountedTotalPrice=Math.ceil(e.drawings[s].discountedTotalPrice),e.drawings[s].discountedTotalPriceDrawingItems=Math.ceil(e.drawings[s].discountedTotalPriceDrawingItems),e.drawings[s].transportationCharge=Math.ceil(e.drawings[s].transportationCharge),e.drawings[s].totalInstallationCharges=Math.ceil(e.drawings[s].totalInstallationCharges),e.drawings[s].totalPriceTradingItems=Math.ceil(e.drawings[s].totalPriceTradingItems),e.enableOptionalIncludeMiscPrices()||(e.drawings[s].isIncludedInstallationCharge=!0,e.drawings[s].isIncludedTransportationCharge=!0,e.drawings[s].isIncludedInstallerOutstationCharge=!0,e.drawings[s].isIncludedWorktopOutstationCharge=!0);e.lumpsum=null!==(t=null===(a=e.drawings[0])||void 0===a?void 0:a.lumpsum)&&void 0!==t?t:0,console.log("res: "+JSON.stringify(e.drawings)),e.$q.loading.hide()}))()},onClickDetailed(e){var t=this;return i()((function*(){try{const a=t.$router.resolve({path:`/lead/${t.selectedLeadId}/detailed-quotation/${e}`});window.open(a.href,"_blank")}catch(a){console.log(a.response)}}))()},onClickSubmit(){var e=this;return i()((function*(){console.log("dasdsa",JSON.stringify(e.drawingSelections));try{e.$q.loading.show(),yield e.$store.dispatch("UpdateDesignState",{leadId:e.selectedLeadId,designIds:e.drawingSelections});const t=yield e.$store.dispatch("GetDetailedQuotations",e.selectedLeadId);console.log("AFTER MOVE TO SUMMARY: "+JSON.stringify(t)),e.drawings=t,e.buttonToggles.clickedCalculateAdditionalCharges=!1,e.$notify("success","Successfully moved to summary quotation"),e.$q.loading.hide()}catch(t){e.$q.loading.hide(),console.log(t)}}))()},onClickCalculateAdditionalCharges(){var e=this;return i()((function*(){const[t]=e.drawings,{isIncludedInstallationCharge:a,isIncludedInstallerOutstationCharge:o,isIncludedTransportationCharge:s,isIncludedWorktopOutstationCharge:r,isToSummary:i}=t;let{transportationDistance:l,installerOutstationDistance:n}=t;l=parseFloat(l),n=parseFloat(n),e.$q.loading.show();for(const c of e.drawings)yield e.$repository.lead.updateDesignById(c.uuid,{isIncludedInstallationCharge:a,isIncludedInstallerOutstationCharge:o,isIncludedTransportationCharge:s,isIncludedWorktopOutstationCharge:r,transportationDistance:l,installerOutstationDistance:n,isToSummary:!!i,lumpsum:e.lumpsum?e.lumpsum:0});const d=yield e.$store.dispatch("GetDetailedQuotations",e.selectedLeadId);e.drawings=d,e.$q.loading.hide(),e.buttonToggles.clickedCalculateAdditionalCharges=!0}))()},onClickAllDrawings(){this.drawingSelections=[],this.allDrawing.selected&&this.drawings.forEach(e=>{this.drawingSelections.push(e.uuid)})},onClickRemoveAllDrawings(){this.allDrawing.selected=!1},reset(){this.drawings=[],this.drawingSelections=[],this.form={},this.allDrawing.selected=[]}}},ot=at,st=Object(b["a"])(ot,et,tt,!1,null,null,null),rt=st.exports,it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"disqualifyOL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Disqualify Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedLeadId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Lead detail\n            ")]),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Name",disable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Email",disable:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Mobile",disable:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reasons\n            ")]),a("q-select",{attrs:{outlined:"",options:e.options.rejects,label:"Selected reject reason","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.rejectReason,callback:function(t){e.$set(e.form,"rejectReason",t)},expression:"form.rejectReason"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"negative",label:"Disqualify",disable:e.isDisqualifyBtnDisabled},on:{click:e.onDisqualifiedLead}})],1)]:e._e()],2)])],1)])],1)},lt=[],nt={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{},options:{rejects:["Unreachable","Lost Interest","Non Purchase Query"]}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isDisqualifyBtnDisabled(){return"disqualified"===this.form.status},branches(){const e=I["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection,t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},mounted(){this.form={}},methods:{onShowDialog(){this.tableSelection.length&&(this.selections=this.tableSelection.map(e=>({label:e.name,value:e.uuid})),this.selectedLeadId=this.selections[0].value)},onDisqualifiedLead(){var e=this;return i()((function*(){const t=n()({},e.form);try{e.$q.loading.show(),yield e.$store.dispatch("DisqualifyOnlineLead",t),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success",t.name+" have been disqualified")}catch(a){console.log(a),e.$q.loading.hide(),e.$notify("error","Failed to disqualify lead. Please try again")}}))()},reset(){this.selectedLeadId="",this.form={}}}},dt=nt,ct=Object(b["a"])(dt,it,lt,!1,null,null,null),ut=ct.exports,mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"disqualifyQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Disqualify Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedLeadId?[a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reasons\n            ")]),a("q-select",{attrs:{outlined:"",options:e.options.rejects,label:"Selected reject reason","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.rejectReason,callback:function(t){e.$set(e.form,"rejectReason",t)},expression:"form.rejectReason"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"negative",label:"Disqualify"},on:{click:e.onDisqualifiedLead}})],1)]:e._e()],2)])],1)])],1)},pt=[],ht={components:{ModalDialog:v},data(){return{selectedLeadId:"",selections:[],form:{},options:{rejects:["Unreachable","Lost Interest","Non Purchase Query"]}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{branches(){const e=I["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},mounted(){this.form={}},methods:{onShowDialog(){this.$store.getters.tableSelection.length&&(this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedLeadId=this.selections[0].value)},reset(){this.selectedLeadId="",this.form={}},onDisqualifiedLead(){var e=this;return i()((function*(){const t=n()({},e.form);try{e.$q.loading.show(),yield e.$store.dispatch("DisqualifiedQualifiedLead",t),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success",t.name+" have been disqualified")}catch(a){console.log(a);const t=a.response.message.error;e.$q.loading.hide(),e.$notify("error",t)}}))()}}},ft=ht,gt=Object(b["a"])(ft,mt,pt,!1,null,null,null),bt=gt.exports,yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"editbranch"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          View/Edit Branch\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a branch\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected branch","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedBranchId,callback:function(t){e.selectedBranchId=t},expression:"selectedBranchId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedBranchId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Company Logo\n            ")]),a("div",{staticClass:"col q-py-md q-gutter-y-md"},[a("q-img",{staticStyle:{height:"140px"},attrs:{"placeholder-src":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAG1BMVEXMzMyWlpaqqqq3t7fFxcW+vr6xsbGjo6OcnJyLKnDGAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABAElEQVRoge3SMW+DMBiE4YsxJqMJtHOTITPeOsLQnaodGImEUMZEkZhRUqn92f0MaTubtfeMh/QGHANEREREREREREREtIJJ0xbH299kp8l8FaGtLdTQ19HjofxZlJ0m1+eBKZcikd9PWtXC5DoDotRO04B9YOvFIXmXLy2jEbiqE6Df7DTleA5socLqvEFVxtJyrpZFWz/pHM2CVte0lS8g2eDe6prOyqPglhzROL+Xye4tmT4WvRcQ2/m81p+/rdguOi8Hc5L/8Qk4vhZzy08DduGt9eVQyP2qoTM1zi0/uf4hvBWf5c77e69Gf798y08L7j0RERERERERERH9P99ZpSVRivB/rgAAAABJRU5ErkJggg==",src:e.logo,ratio:16/9,contain:""}}),a("q-file",{ref:"fileupload",attrs:{accept:".png, .jpg, .jpeg",label:"Change Logo",outlined:""},model:{value:e.fileUpload,callback:function(t){e.fileUpload=t},expression:"fileUpload"}})],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Branch detail\n            ")]),a("div",{staticClass:"col "},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Branch Name","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errorMessageBranchName.length>0,rules:[e.onNameCheck,e.textRules]},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errorMessageBranchName.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageBranchName)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"Branch Code","lazy-rules":"",error:e.errorMessageBranchCode.length>0,rules:[e.onBranchCodeCheck,e.textRules]},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}},[e.errorMessageBranchCode.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageBranchCode)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.types,label:"Branch Type","bottom-slots":!1,"hide-hint":!0,"emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errorMessageBranchType.length>0,rules:[e.textRules]},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e.errorMessageBranchType.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageBranchType)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"Telephone No.",mask:"## - #############","unmasked-value":"",rules:[e.onMobileCheck],error:!!e.errorMessagePhone},model:{value:e.form.telno,callback:function(t){e.$set(e.form,"telno",t)},expression:"form.telno"}},[e.errorMessagePhone?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessagePhone)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",placeholder:"07-23456789",label:"Fax No.",mask:"## - #############","unmasked-value":"","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errorMessageFaxNo.length>0,rules:[e.onFaxCheck,e.textRules]},model:{value:e.form.faxno,callback:function(t){e.$set(e.form,"faxno",t)},expression:"form.faxno"}},[e.errorMessageFaxNo.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageFaxNo)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Email","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errorMessageEmail.length>0,rules:[e.onEmailCheck,e.textRules]},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errorMessageEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageEmail)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Address","bottom-slots":!1,"hide-hint":!0,"aria-rowcount":"2","lazy-rules":"",error:e.errorMessageAddress.length>0,rules:[e.onAddressCheck,e.textRules]},model:{value:e.form.address1,callback:function(t){e.$set(e.form,"address1",t)},expression:"form.address1"}},[e.errorMessageAddress.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageAddress)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"Address 2"},model:{value:e.form.address2,callback:function(t){e.$set(e.form,"address2",t)},expression:"form.address2"}})],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"State","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errorMessageState.length>0,rules:[e.onStateCheck,e.textRules]},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[e.errorMessageState.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageState)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Country","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",options:e.countryOptions},on:{filter:e.filterFn},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},[e.errorMessageState.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageState)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"SSM No.","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errorMessageSSMNo.length>0,rules:[e.onSSMCheck,e.textRules]},model:{value:e.form.SSMNo,callback:function(t){e.$set(e.form,"SSMNo",e._n(t))},expression:"form.SSMNo"}},[e.errorMessageSSMNo.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageSSMNo)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"GST No","lazy-rules":"",error:e.errorMessageGSTNo.length>0,rules:[e.onGSTCheck,e.textRules]},model:{value:e.form.GSTNo,callback:function(t){e.$set(e.form,"GSTNo",e._n(t))},expression:"form.GSTNo"}},[e.errorMessageGSTNo.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageGSTNo)+"\n                  ")])]):e._e()],1)],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{staticClass:"q-mx-sm",attrs:{color:"grey",label:"Reset Form"},on:{click:e.resetToUser}},[a("q-tooltip",[e._v("\n                  Reset form to original attributes.\n                ")])],1),a("q-btn",{attrs:{color:"primary",label:"Update"},on:{click:e.onEditBranch}})],1)]:e._e()],2)])],1)])],1)},vt=[],qt={components:{ModalDialog:v},data(){return{countryOptions:[],selectedResetId:"",textRules:[e=>e&&e.length>0&&e.length<13],selectedBranchId:"",form:{},fileUpload:null,logo:"",branchName:"",selections:[],errorMessageBranchName:"",errorMessageBranchCode:"",errorMessageBranchType:"",errorMessagePhone:"",errorMessageFaxNo:"",errorMessageEmail:"",errorMessageAddress:"",errorMessageState:"",errorMessageCountry:"",errorMessageSSMNo:"",errorMessageGSTNo:"",opts:{types:[{label:"Home Branch",value:"home"},{label:"Dealer Branch",value:"dealer"}]}}},validations:{form:{email:{required:M["required"],email:M["email"]},password:{required:M["required"],minLength:Object(M["minLength"])(3)},mobile:{required:M["required"],minLength:Object(M["minLength"])(8)},name:{required:M["required"]},branchId:{required:M["required"]},role:{required:M["required"]}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{countries(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.name,t.flag=e.flag,t});return t}}),watch:{selectedBranchId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.selectedResetId=this.tableSelection.find(t=>t.uuid===e),this.form=n()({},a),this.form.branch=this.getBranchName,this.logo="https://api-prod.skcrm.com.my/containers/download/"+this.form.logo}},created(){this.$store.dispatch("GetAllCountries")},methods:{filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.countryOptions=this.countries.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.countryOptions=this.countries})},resetToUser(){this.form=n()({},this.selectedResetId),this.form.branch=this.getBranchName,this.logo="https://api-prod.skcrm.com.my/containers/download/"+this.form.logo},onShowDialog(){var e=this;return i()((function*(){if(!e.$store.getters.tableSelection.length)return;e.selections=e.$store.getters.tableSelection,e.selections=e.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),e.selectedBranchId=e.selections[0].value;const t=I["a"].query().where("name","HQ").first();e.branchName=t.name,e.countryOptions=e.countries}))()},reset(){this.selectedBranchId="",this.form={}},loadImage(e){var t=this;return i()((function*(){e&&(yield t.$store.dispatch("GetImage",e))}))()},onEditBranch(){var e=this;return i()((function*(){if(e.fileUpload){const t=yield e.$store.dispatch("UploadFile",e.fileUpload);e.form.logo=t.name}try{e.$q.loading.show(),yield e.$store.dispatch("UpdateBranch",e.form),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success",`Branch with name ${e.form.name} updated!`)}catch(t){const a=t.response.message.error;e.$q.loading.hide(),e.$notify("error",a)}}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errorMessageBranchName="Field cant blank":this.errorMessageBranchName=""},onEmailCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),e.form.email===e.selectedResetId.email)return!0;e.form.email.length<=0?e.errorMessageEmail="Field cant be blank":yield e.$store.dispatch("CheckEmailBranchExist",e.form.email).then(t=>{e.errorMessageEmail=t?"Email already exist":""})}))()},onBranchCodeCheck(){var e=this;return i()((function*(){if(e.form.code===e.selectedResetId.code)return!0;e.form.code.length<=0?e.errorMessageBranchCode="Field cant be blank":yield e.$store.dispatch("CheckBranchCodeExist",e.form.code).then(t=>{e.errorMessageBranchCode=t?"Branch Code already exist":""})}))()},onAddressCheck(){this.$v.form.$touch(),this.form.address1.length<=0?this.errorMessageAddress="Field cant blank":this.errorMessageAddress=""},onStateCheck(){this.$v.form.$touch(),this.form.state.length<=0?this.errorMessageState="Field cant blank":this.errorMessageState=""},onCountryCheck(){this.$v.form.$touch(),this.form.country.length<=0?this.errorMessageCountry="Field cant blank":this.errorMessageCountry=""},onSSMCheck(){this.$v.form.$touch(),this.form.SSMNo.length<=0?this.errorMessageSSMNo="Field cant blank":this.errorMessageSSMNo=""},onGSTCheck(){this.$v.form.$touch(),this.form.GSTNo.length<=0?this.errorMessageGSTNo="Field cant blank":this.errorMessageGSTNo=""},onFaxCheck(){var e=this;return i()((function*(){if(e.form.faxno===e.selectedResetId.faxno)return!0;e.form.faxno<=0?e.errorMessageFaxNo="Field cant be blank":(yield e.$store.dispatch("CheckFaxExist",e.form.faxno).then(t=>{e.errorMessageFaxNo=t?"Fax number already exist":""}),e.form.faxno.length>=8&&e.form.faxno.length<=15||(e.errorMessageFaxNo="Fax No. must between 8-15 digits"))}))()},onMobileCheck(){var e=this;return i()((function*(){return e.errorMessagePhone="",e.form.telno===e.selectedResetId.telno||(e.form.telno.length<=0?void(e.errorMessagePhone="Field cant be blank"):(yield e.$store.dispatch("CheckMobileBranchExist",e.form.telno).then(t=>{e.errorMessagePhone=t?"Mobile already exist":""}),e.form.telno.length>=8&&e.form.telno.length<=15||(e.errorMessagePhone="Telephone No. must between 8-15 digits"),!e.errorMessagePhone))}))()}}},xt=qt,Ct=Object(b["a"])(xt,yt,vt,!1,null,null,null),wt=Ct.exports,kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"edituser"},on:{"close-dialog":e.onHideDialog,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          View/Edit User\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a user\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected user","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedUserId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              User detail\n            ")]),a("q-form",{ref:"myForm",on:{submit:e.onUpdateUser}},[a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Login ID","lazy-rules":"",error:e.errorMessageName.length>0,rules:[e.onNameCheck,e.textRules]},model:{value:e.form.loginId,callback:function(t){e.$set(e.form,"loginId",t)},expression:"form.loginId"}},[e.errorMessageName.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errorMessageName)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Fullname","lazy-rules":"",error:e.errorMessageName.length>0,rules:[e.onNameCheck,e.textRules]},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errorMessageName.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errorMessageName)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{debounce:"500",outlined:"",label:"SC Code",rules:[e.onSCCodeCheck,e.textRules],error:!!e.error.sccode},model:{value:e.form.sccode,callback:function(t){e.$set(e.form,"sccode",t)},expression:"form.sccode"}},[e.error.sccode?a("q-tooltip",[e._v("\n                    "+e._s(e.error.sccode)+"\n                  ")]):e._e()],1),a("q-input",{staticClass:"col q-pb-xs",attrs:{mask:"### - ############",outlined:"","unmasked-value":"",label:"Telephone No.",rules:[e.onMobileCheck],error:!!e.error.mobile},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}},[e.error.mobile?a("q-tooltip",[e._v("\n                    "+e._s(e.error.mobile)+"\n                  ")]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Email","lazy-rules":"",rules:[e.onEmailCheck,e.emailRules],error:e.errorMessageEmail.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errorMessageEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errorMessageEmail)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-select",{attrs:{outlined:"",options:e.branches,label:"Branch","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.branchId,callback:function(t){e.$set(e.form,"branchId",t)},expression:"form.branchId"}})],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Design Cad 4.0 AppUID","lazy-rules":"",rules:[e.onAppUIDCheck],error:e.errorMessageAppUID.length>0},model:{value:e.form.appUID,callback:function(t){e.$set(e.form,"appUID",t)},expression:"form.appUID"}},[e.errorMessageAppUID.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errorMessageAppUID)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Design Cad 4.0 Email","lazy-rules":"",rules:[e.onKujialeEmailCheck,e.emailRules],error:e.errorMessageKujialeEmail.length>0},model:{value:e.form.kujialeEmail,callback:function(t){e.$set(e.form,"kujialeEmail",t)},expression:"form.kujialeEmail"}},[e.errorMessageKujialeEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errorMessageKujialeEmail)+"\n                    ")])]):e._e()],1)],1)]),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reset user's password\n            ")]),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Password","lazy-rules":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mx-sm",attrs:{flat:"",outline:"",color:"primary",label:"Reset"},on:{click:e.resetPassword}})],1),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Toggle user's status\n            ")]),a("div",[a("q-toggle",{attrs:{color:"teal-8"},model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}},[a("q-tooltip",[e._v("\n                  Toggle User's status\n                ")])],1)],1),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mx-sm",attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{staticClass:"q-mx-sm",attrs:{color:"grey",label:"Reset Form"},on:{click:e.resetToUser}},[a("q-tooltip",[e._v("\n                  Reset form to user's original attributes.\n                ")])],1),a("q-btn",{staticClass:"q-mx-sm",attrs:{color:"primary",label:"Update",disabled:!!e.error.name||!!e.error.sccode},on:{click:e.onUpdateUser}})],1)]:e._e()],2)])],1)])],1)},_t=[],St={components:{ModalDialog:v},mixins:[x["a"]],data(){return{selectedUserId:"",isUserActive:!0,user:{},form:{uuid:"",name:"",sccode:"",mobile:"",email:"",active:null,branchId:"",kujialeEmail:"",appUID:""},password:"",error:{name:"",sccode:"",mobile:""},errorMessageEmail:"",errorMessageName:"",errorMessageLoginId:"",errorMessageKujialeEmail:"",errorMessageAppUID:"",selections:[]}},validations:{form:{email:{required:M["required"],email:M["email"]},password:{required:M["required"],minLength:Object(M["minLength"])(3)},mobile:{required:M["required"],minLength:Object(M["minLength"])(8)},name:{required:M["required"]},branchId:{required:M["required"]},role:{required:M["required"]},kujialeEmail:{email:M["email"]}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{branches(){const e=I["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t}}),watch:{selectedUserId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.user=n()({},t);try{yield a.$store.dispatch("GetUserProfile",e)}catch(s){a.$notify("error","Error getting user profile")}const o=De["a"].query().where("userId",a.selectedUserId).first();a.user.sccode=null===o||void 0===o?void 0:o.sccode,a.form={uuid:t.uuid,loginId:t.loginId,name:t.name,sccode:null===o||void 0===o?void 0:o.sccode,mobile:t.mobile,email:t.email,branchId:t.branchId,active:t.active,kujialeEmail:t.kujialeEmail,appUID:t.appUID},a.error={name:"",sccode:"",mobile:""}}))()}},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllBranches")}))()},methods:{onShowDialog(){this.$store.getters.tableSelection.length&&(this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedUserId=this.selections[0].value)},onHideDialog(){this.selectedUserId="",this.form={uuid:"",name:"",sccode:"",mobile:"",email:"",branchId:"",kujialeEmail:"",appUID:""}},resetToUser(){this.form=n()({},this.user),this.error={name:"",sccode:"",mobile:""},this.errorMessageEmail="",this.errorMessageName="",this.errorMessageKujialeEmail="",this.errorMessageAppUID="",this.errorMessageLoginId=""},onUpdateUser(){var e=this;return i()((function*(){e.isUserActive||(e.form.active=!1);try{e.$q.loading.show(),yield e.$store.dispatch("UpdateUser",e.form),1===e.selections.length&&e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success",`User with name ${e.form.name} updated!`)}catch(o){var t,a;console.log(o);const s=null===(t=o.response)||void 0===t||null===(a=t.message)||void 0===a?void 0:a.error;e.$q.loading.hide(),e.$notify("error",s)}}))()},onLoginIdCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),e.form.loginId===e.user.loginId)return!0;e.form.loginId.length<=0?e.errorMessageLoginId="Field cant be blank":yield e.$store.dispatch("CheckLoginIdExist",e.form.email).then(t=>{e.errorMessageLoginId=t?"Login ID already exist":""})}))()},onEmailCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),e.form.email===e.user.email)return!0;e.form.email.length<=0?e.errorMessageEmail="Field cant be blank":yield e.$store.dispatch("CheckEmailExist",e.form.email).then(t=>{e.errorMessageEmail=t?"Email already exist":""})}))()},onKujialeEmailCheck(){var e=this;return i()((function*(){return e.$v.form.$touch(),e.form.kujialeEmail===e.user.kujialeEmail||(0===e.form.kujialeEmail.length||void(yield e.$store.dispatch("CheckKujialeEmailExist",e.form.kujialeEmail).then(t=>{e.errorMessageKujialeEmail=t?"Design Cad 4.0 Email already exist":""})))}))()},onAppUIDCheck(){var e=this;return i()((function*(){return e.$v.form.$touch(),e.form.appUID===e.user.appUID||(0===e.form.appUID.length||void(yield e.$store.dispatch("CheckAppUIDExist",e.form.appUID).then(t=>{e.errorMessageAppUID=t?"Design Cad 4.0 AppUID already exist":""})))}))()},onMobileCheck(){var e=this;return i()((function*(){return e.error.mobile="",e.form.mobile===e.user.mobile||(e.form.mobile.length<=0?e.error.mobile="Field cant blank":e.error.mobile="",yield e.$store.dispatch("CheckMobileExist",e.form.mobile).then(t=>{t&&(e.error.mobile="Mobile already exist")}),e.form.mobile.length>=10&&e.form.mobile.length<=15||(e.error.mobile="Mobile No. must be between 10-15 digits"),!e.error.mobile)}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?(this.errorMessageName="Field cant blank",console.log("dadsa",this.errorMessageName)):this.errorMessageName="",console.log("here",this.errorMessageName)},onSCCodeCheck(){var e=this;return i()((function*(){return e.error.sccode="",e.form.sccode===e.user.sccode||(e.form.sccode.length<=0?e.error.sccode="Field cant blank":e.error.sccode="",yield e.$store.dispatch("CheckSCCodeExist",e.form.sccode).then(t=>{t&&(e.error.sccode="SCCode already exist")}),!e.error.sccode)}))()},resetPassword(){var e=this;return i()((function*(){yield e.$store.dispatch("ResetUserPassword",{password:e.password,userId:e.selectedUserId}),e.$notify("success","Successfully updated user password")}))()}}},At=St,Mt=Object(b["a"])(At,kt,_t,!1,null,null,null),It=Mt.exports,$t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importitemlist"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("\n        Import\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx file which contain master item data\n    ")]),a("q-card-section",[a("q-uploader",{ref:"itemlistUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        File upload mode\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-radio",{attrs:{val:"update",label:"Update"},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Update mode only creates or updates existing item list records in the SFM database.\n        ")])],1),a("q-radio",{attrs:{val:"reset",label:"Reset",disable:""},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Reset mode will delete all item list records in the SFM database, and create new item list records using items in the attached spreadsheet.\n          Currently reset mode is disabled in order to perform further testing.\n        ")])],1)],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        Notes on file upload modes\n      ")]),a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"assessment",label:"Update Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Update mode only creates or updates existing item list records in the SFM database. Each item list record in the uploaded spreadsheet will be checked against the SFM database using the item `name` to find any existing items; used for updating. "),a("br"),a("br"),e._v("\n              This mode is useful if you would want to only create new items or update existing items. Fast upload processing if only a part of the entire item list needs to be updated. "),a("br")])],1)],1),a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"receipt",label:"Reset Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Reset mode will delete all item list records in the SFM database, and create new item list records using items in the attached spreadsheet."),a("br"),a("br"),e._v("\n              This mode is useful when you would want to reset the entire item list in SFM database to have only items in the attached spreadsheet. Upload processing is slower than update mode."),a("br")])],1)],1)],1)],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1)],1)],1)},Dt=[],Tt={components:{ModalDialog:v},data(){return{uploadMode:"update"}},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.itemlistUploader,o=e[0];try{const e=yield t.$repository.itemlist.upload(o,t.uploadMode);a.removeFile(o),console.log("Upload item list res:",e);const{created:s,updated:r}=e.data;t.$notify("success",`Item successfully created: ${s}, updated: ${r}.`),t.$store.dispatch("GetAllItems")}catch(s){let e=s;console.log("Failed to upload item list file:",JSON.stringify(s)),s["message"].includes("422")&&(e="Failed to upload item list due to unsupported file type. Only Excel spreadsheet is supported."),t.$notify("error",e)}}))()}}},Ot=Tt,Nt=Object(b["a"])(Ot,$t,Dt,!1,null,null,null),Rt=Nt.exports,Ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importonlineleads"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("\n        Import\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx or .csv file which contain this leads data, and auto populate the online leads.\n    ")]),a("q-card-section",[a("q-uploader",{ref:"leadsUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx, .csv",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{flat:"",color:"primary",label:"Select"}})],1)],1)],1)},jt=[],Lt={components:{ModalDialog:v},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.leadsUploader,o=e[0];try{const e=yield t.$repository.lead.upload(o);a.removeFile(o),console.log("Upload leads res:",e)}catch(s){console.log("Failed to upload leads file:",s)}}))()}}},Et=Lt,Pt=Object(b["a"])(Et,Ft,jt,!1,null,null,null),Ut=Pt.exports,Bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{staticStyle:{height:"500px"},attrs:{name:"opendesigncad"}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Open Design CAD 4.0 App\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{},[e._v("\n            Opening Design CAD 4.0 at external tab. Click button below to proceed\n          ")]),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"Open Design CAD 4.0",color:"primary"},on:{click:e.onClickOpenDesign}})],1)],1)])],1)]),a("iframe",{staticStyle:{position:"absolute",width:"0",height:"0",border:"0"},attrs:{src:e.kujialeURL},on:{load:e.loadKujiale}})],1)},zt=[],Gt=(a("e6cf"),{components:{ModalDialog:v},data(){return{kujialeURL:"",kujialeToken:""}},computed:n()({},Object(q["b"])(["appUID","kujialeEmail"])),methods:{onClickOpenDesign(){var e=this;return i()((function*(){e.$q.loading.show(),e.kujialeToken=yield e.$store.dispatch("GetSSOToken"),e.appUID&&e.kujialeEmail?"0"===e.kujialeToken.c&&e.kujialeToken.d?(e.kujialeURL=`https://www.kujiale.com/v/auth?accesstoken=${e.kujialeToken.d}&dest=5`,console.log("kujialeUrl: "+e.kujialeURL),window.open(e.kujialeURL),yield e.sleep(500),window.open("https://www.kujiale.com/vc/design/all","_blank")):e.$notify("error","Email has been binded with another App key, unable to register current user with Design CAD 4.0."):e.$notify("error","Current user does not have access to Design CAD 4.0"),e.$q.loading.hide()}))()},sleep(e){return i()((function*(){return new Promise(t=>setTimeout(t,e))}))()},loadKujiale(){var e=this;return i()((function*(){e.kujialeURL}))()}}}),Qt=Gt,Yt=Object(b["a"])(Qt,Bt,zt,!1,null,null,null),Jt=Yt.exports,Kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"requalifyQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Requalify Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedLeadId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Lead detail\n            ")]),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Name",disable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Email",disable:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Mobile",disable:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reasons\n            ")]),a("q-input",{staticClass:"col",attrs:{outlined:"",label:"Requalify Reason",type:"textarea"},model:{value:e.form.requalifyReason,callback:function(t){e.$set(e.form,"requalifyReason",t)},expression:"form.requalifyReason"}}),a("q-separator"),a("div",{staticClass:"row justify-end"},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1),a("div",[a("q-btn",{attrs:{color:"positive",label:"Requalify",disable:e.isBtnDisabled},on:{click:e.onRequalifiedLead}}),e.isBtnDisabled?a("q-tooltip",[e._v("\n                  Lead is not disqualified\n                ")]):e._e()],1)])]:e._e()],2)])],1)])],1)},Ht=[],Vt={components:{ModalDialog:v},data(){return{selections:[],selectedLeadId:"",form:{}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isBtnDisabled(){return"disqualified"!==this.form.status},branches(){const e=I["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a),console.log(this.form)}},mounted(){this.form={}},methods:{onShowDialog(){this.$store.getters.tableSelection.length&&(this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedLeadId=this.selections[0].value)},reset(){this.selectedLeadId="",this.form={}},onRequalifiedLead(){var e=this;return i()((function*(){const t=n()({},e.form);try{e.$q.loading.show(),yield e.$store.dispatch("RequalifyQualifiedLead",t),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success",t.name+" have been requalified")}catch(a){console.log(a),console.log(a.response);const t=a.response.message.error;e.$q.loading.hide(),e.$notify("error",t)}}))()}}},Wt=Vt,Xt=Object(b["a"])(Wt,Kt,Ht,!1,null,null,null),Zt=Xt.exports,ea=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"submitOrderConfirmationToAccount"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Add Deposit Information\n        ")])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Deposit\n        ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Deposit Amount","lazy-rules":"",rules:[e.floatRules],prefix:"RM"},model:{value:e.form.paidAmountDeposit,callback:function(t){e.$set(e.form,"paidAmountDeposit",t)},expression:"form.paidAmountDeposit"}}),"FCO"!==e.form.state?a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload Supporting Documents",color:"teal",multiple:""},on:{uploaded:e.fileUploaded}}):e._e(),a("q-separator",{staticClass:"q-my-md"}),e.form.paymentAttachments&&e.form.paymentAttachments.length?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Supporting Documents\n          ")]):e._e(),e.form.paymentAttachments&&e.form.paymentAttachments.length?a("q-list",{attrs:{bordered:""}},e._l(e.form.paymentAttachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-paperclip"}})],1),a("q-item-section",{attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[e._v("\n                "+e._s(t.fileName)+"\n              ")]),a("q-item-section",{attrs:{clickable:"",avatar:""},on:{click:function(a){return e.deleteAttachment(t)}}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-trash"}})],1)],1)})),1):e._e(),a("div",{staticClass:"flex justify-end q-my-lg"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{color:"primary",label:"Submit"},on:{click:e.onSubmit}}),e.isDisabledSubmit&&0===e.form.paidAmountDeposit?a("q-tooltip",[e._v("\n                Deposit Amount cannot be 0\n              ")]):e.isDisabledSubmit&&"OC"===e.form.state?a("q-tooltip",[e._v("\n                No deposit attachment found for the order\n              ")]):e.isDisabledSubmit&&"FCO"===e.form.state?a("q-tooltip",[e._v("\n                Order is already in Final Confirmation Order\n              ")]):e._e()],1)],1)],1)],1)],1)])],1)},ta=[],aa={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isDisabledSubmit:!0,form:{leadId:"",paidAmountDeposit:"",promoCode:"",promoAmount:""}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"}}),methods:{fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const[{name:o}]=e;try{const{files:e}=JSON.parse(t.response),[{name:s}]=e[o],{uuid:r}=a.form;if(!s)throw new Error;yield a.$store.dispatch("AddFCOAttachment",{fileName:o,name:s,orderId:r}),a.isDisabledSubmit=!1,yield a.$store.dispatch("GetFcoLeads",{}),yield a.$store.dispatch("GetCoLeads",{}),a.$notify("success","File upload success")}catch(s){a.$notify("error","Error uploading attachment "+o)}}))()},onShowDialog(){this.form=n()({},this.tableSelection[0]),this.form.promoAmount&&(this.form.promoAmount*=100),this.form.paymentAttachments&&this.form.paymentAttachments.length&&(this.isDisabledSubmit=!1),"FCO"===this.form.state&&(this.isDisabledSubmit=!0),0===this.form.paidAmountDeposit&&(this.isDisabledSubmit=!0)},reset(){this.isDisabledSubmit=!0,this.form={paidAmountDeposit:null,promoCode:"",promoAmount:null}},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},sleep(e){return i()((function*(){return new Promise(t=>setTimeout(t,e))}))()},deleteAttachment(e){var t=this;return i()((function*(){var a;const o={orderId:e.finalConfirmationOrderId,fileName:e.fileName,name:e.name,type:null!==(a=e.type)&&void 0!==a?a:""};console.log("file: ",JSON.stringify(e));try{if(!o)throw new Error;console.log({isUserRoleDetailer:t.isUserRoleDetailer}),console.log("data: ",JSON.stringify(o)),yield t.$store.dispatch("DeleteFCOAttachment",o),t.isDisabledSubmit=!1,yield t.$store.dispatch("GetFcoLeads",{}),yield t.$store.dispatch("GetCoLeads",{}),t.form.paymentAttachments&&t.form.paymentAttachments.length&&(t.form.paymentAttachments=t.form.paymentAttachments.filter(t=>t.uuid!==e.uuid)),t.$notify("success","File delete success"),yield t.sleep(2500),location.reload()}catch(s){console.log(s),t.$notify("error","Error deleting attachment "+e.fileName)}}))()},onSubmit(){var e=this;return i()((function*(){try{const{leadId:t,uuid:a,paidAmountDeposit:o,promoAmount:s,promoCode:r}=e.form;e.$q.loading.show(),yield e.$store.dispatch("OrderConfirmationAddDeposit",{leadId:t,orderId:a,paidAmountDeposit:parseFloat(o),promoAmount:parseFloat(s/100),promoCode:r}),e.$q.loading.hide(),e.$notify("success","Order Confirmation successfully submitted to HQ Accountant or branch manager for approval.")}catch(t){e.$q.loading.hide(),e.$notify("error","Action failed. Please try again")}}))()}}},oa=aa,sa=Object(b["a"])(oa,ea,ta,!1,null,null,null),ra=sa.exports,ia=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"summaryQuotation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Summary Quotation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Drawings\n          ")]),a("q-separator",{staticClass:"q-mb-md"}),e._l(e.drawings,(function(t){return a("q-list",{key:t.uuid},[a("q-chip",{staticClass:"row q-ml",attrs:{color:"primary","text-color":"white"}},[e._v("\n              "+e._s(t.referenceName)+"\n            ")]),a("div",{staticClass:"row justify-center"},[a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Drawing Number",disable:""},model:{value:t.drawingNumber,callback:function(a){e.$set(t,"drawingNumber",a)},expression:"drawing.drawingNumber"}}),a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Total Price (RM)",disable:""},model:{value:t.discountedTotalPrice,callback:function(a){e.$set(t,"discountedTotalPrice",a)},expression:"drawing.discountedTotalPrice"}})],1)],1)}))],2)]),e.drawings.length?a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Additional Charges\n        ")]),a("q-separator",{staticClass:"q-mb-md"}),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Lump Sum Discount")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{label:"Lump Sum",value:e.lumpsum,prefix:"RM",outlined:"",dense:"",disable:""},model:{value:e.lumpsum,callback:function(t){e.lumpsum=e._n(t)},expression:"lumpsum"}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Installation Charges")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{prefix:"RM",value:e.totalInstallationCharges,outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Installer Outstation Charges")])]),a("q-input",{staticClass:"col",attrs:{label:"Distance",suffix:"KM",outlined:"",dense:"",disable:""},model:{value:e.drawings[0].installerOutstationDistance,callback:function(t){e.$set(e.drawings[0],"installerOutstationDistance",e._n(t))},expression:"drawings[0].installerOutstationDistance"}}),a("q-input",{staticClass:"col",attrs:{value:e.installerOutstationCharge,prefix:"RM",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Transportation Charges")])]),a("q-input",{staticClass:"col",attrs:{label:"Distance",suffix:"KM",outlined:"",dense:"",disable:""},model:{value:e.drawings[0].transportationDistance,callback:function(t){e.$set(e.drawings[0],"transportationDistance",e._n(t))},expression:"drawings[0].transportationDistance"}}),a("q-input",{staticClass:"col",attrs:{value:e.transportationCharge,prefix:"RM",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"}),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{value:e.totalAdditionalCharge,prefix:"RM",label:"Total Charges",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Grand Total")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{value:e.grandTotal,prefix:"RM",label:"Grand Total",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1)],1):e._e(),a("q-card-actions",{attrs:{align:"right"}},[a("div",{attrs:{align:"right"}},[a("q-btn",{attrs:{outline:"",color:"primary",label:"View / Print","no-caps":""},on:{click:e.generatePdf}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{color:"primary",label:"To Order Confirmation","no-caps":""},on:{click:e.onClickToOrderConfirmation}})],1)])],1)])],1)},la=[],na=(a("e01a"),a("680c")),da=a.n(na),ca=a("e499"),ua=a("4ebb"),ma={components:{ModalDialog:v},mixins:[x["a"]],data(){return{quotation:[],selectedLeadId:"",selections:[],drawingSelections:[],form:{leadId:"",designId:""},drawings:{},lumpsum:0}},computed:n()(n()({},Object(q["b"])(["tableSelection","roles"])),{},{totalInstallationCharges(){let e=0;return this.drawings.forEach(t=>{e+=Math.ceil(t.totalInstallationCharges)}),e},installerOutstationCharge(){let e=0;return this.drawings.forEach(t=>{e+=Math.ceil(t.installerOutstationCharge)}),e},transportationCharge(){let e=0;return this.drawings.forEach(t=>{e+=Math.ceil(t.transportationCharge)}),e},totalAdditionalCharge(){const[e]=this.drawings,{isIncludedInstallationCharge:t,isIncludedTransportationCharge:a,isIncludedInstallerOutstationCharge:o}=e;let s=0;return s+=t?this.totalInstallationCharges:0,s+=a?this.transportationCharge:0,s+=o?this.installerOutstationCharge:0,Math.ceil(s.toFixed(2))},grandTotal(){const[e]=this.drawings,{isIncludedInstallationCharge:t,isIncludedTransportationCharge:a,isIncludedInstallerOutstationCharge:o}=e;let s=0;s+=t?this.totalInstallationCharges:0,s+=a?this.transportationCharge:0,s+=o?this.installerOutstationCharge:0;let r=0,i=0;return console.log("aa",this.drawings),this.drawings.forEach(e=>{console.log("d",e.isToSummary),i+=e.discountedTotalPrice}),r+=i+s,r-=this.lumpsum,Math.ceil(r.toFixed(2))}}),methods:{enableOptionalIncludeMiscPrices(){return!this.roles.includes("salesconsultant")},onShowDialog(){var e=this;return i()((function*(){var t,a;if(e.$q.loading.show(),e.selections=e.$store.getters.tableSelection,!e.selections.length)return;e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value;const o=e.tableSelection.find(t=>t.uuid===e.selectedLeadId);e.form=n()({},o);const s=yield e.$store.dispatch("GetSummaryQuotation",e.selectedLeadId);e.drawings=s;var r,i=!0,l=!1;try{for(var d,c,u=da()(e.drawings);d=yield u.next(),i=d.done,c=yield d.value,!i;i=!0){const t=c,a=yield e.$store.dispatch("GetDesigns",t.uuid);e.quotation.push(a)}}catch(m){l=!0,r=m}finally{try{i||null==u.return||(yield u.return())}finally{if(l)throw r}}console.log("Pushed quotations are here: "+JSON.stringify(e.quotation)),e.lumpsum=null!==(t=null===(a=e.drawings[0])||void 0===a?void 0:a.lumpsum)&&void 0!==t?t:0,e.$q.loading.hide()}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===ca["vfs"]&&(ca["vfs"]=ua["pdfMake"].vfs);var a=[],o=0,s=0,r=0,i=0;a.push([{text:"Item",style:"headerTitle"},{text:"Description",style:"headerTitle"},{text:"Qty",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"Unit Price\n(RM)",alignment:"center",style:"headerTitle"},{text:"Discount\n(%)",alignment:"center",style:"headerTitle"},{text:"Price\n(RM)",alignment:"center",style:"headerTitle"}]);try{for(var l of(console.log(JSON.stringify(e.quotation)),e.quotation)){const e=1;if(s+=l.totalInstallationCharges,s=Math.ceil(s),o+=l.discountedTotalPrice,r+=l.transportationCharge,i+=l.installerOutstationCharge,!l.quotationDetails)continue;const t=Math.ceil(l.totalPriceDrawingItems).toFixed(2),n=(Math.ceil(l.discountedTotalPriceDrawingItems)*e).toFixed(2);a.push(["Drawing Item: "+l.referenceName,l.materials,{text:e.toFixed(2),alignment:"center"},{text:"Set",alignment:"center"},{text:t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"},{text:l.masterItemDiscount,alignment:"center"},{text:n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"}])}for(var n of e.quotation){if(n.tradingItems)for(var d of n.tradingItems){const e=Math.ceil(d.stdcost*d.markuprate).toFixed(2),t=Math.ceil(d.stdcost*d.markuprate*d.designAdditionalItems[0].quantity*(1-d.designAdditionalItems[0].discount)).toFixed(2);a.push(["Optional Item: "+d.category,d.name+" | "+d.itemcode,{text:d.designAdditionalItems[0].quantity.toFixed(2),alignment:"center"},{text:d.uom,alignment:"center"},{text:e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"},{text:100*d.designAdditionalItems[0].discount,alignment:"center"},{text:t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"}])}if(n.looseItems)for(var c of n.looseItems){const e=Math.ceil(c.stdcost*c.markuprate).toFixed(2),t=Math.ceil(c.stdcost*c.markuprate*c.designAdditionalLooseItems[0].quantity*(1-c.designAdditionalLooseItems[0].discount)).toFixed(2);a.push(["Loose Item: "+c.category,c.name+" | "+c.itemcode,{text:c.designAdditionalLooseItems[0].quantity.toFixed(2),alignment:"center"},{text:`${c.puom} (puom)\n${c.suom} (suom)`,alignment:"center"},{text:e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"},{text:100*c.designAdditionalLooseItems[0].discount,alignment:"center"},{text:t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"}])}if(n.designOtherItems)for(const e of n.designOtherItems)a.push([{text:"Other Item",alignment:"left"},{text:`${e.name}: ${e.description}`,alignment:"left"},{text:e.quantity.toFixed(2),alignment:"center"},{text:e.UOM,alignment:"center"},{text:e.unitPrice.toFixed(2),alignment:"right"},{text:e.discount,alignment:"center"},{text:e.discountedPrice.toFixed(2),alignment:"right"}])}for(var u of(a.push([{text:" ",colSpan:7},{text:" ",colSpan:7}]),e.drawings)){if(u.lumpsum&&(e.lumpsum=u.lumpsum),u.isIncludedInstallationCharge){const e=Math.ceil(u.totalInstallationCharges).toFixed(2);a.push([{text:"Others"},{text:"Installation Charges"},{text:"",colSpan:4},{},{},{},{text:e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"}])}if(u.isIncludedInstallerOutstationCharge){const e=Math.ceil(u.installerOutstationCharge).toFixed(2);a.push([{text:"Others"},{text:"Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"}])}if(u.isIncludedTransportationCharge){const e=Math.ceil(u.transportationCharge).toFixed(2);a.push([{text:"Others"},{text:"Transportation Charges"},{text:"",colSpan:4},{},{},{},{text:e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),alignment:"right"}])}}o+=s+r+i}catch(g){console.log("error bro",g),e.$notify("error","No Quotation Details")}let m=.08*o;m=0;const p=o+m-e.lumpsum,h=Math.floor(p);console.log("abc",a),console.log("form",e.form);var f={images:{logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACB1BMVEUdHRscHBofHx0XFxUlJSPNzc3////9/f3+/v78/Pzf3944ODYYGBYeHhwhIR8MDApYWFaUlJMREQ8bGxkuLiwZGRYgIB7AwMDn5+dCQkETExFDQ0Lo6OiLi4oQEA4vLy0eHh0aGhe8vLz7+/vs7OxEREMSEhA/Pz2Hh4YxMS8aGhi0tLPx8fFMTEogIB84ODfi4uJ6enkfHxysrKz09PRSUlEPDw0UFBIzMzLc3NyPj44VFROlpaT29vZZWVfW1tadnZz5+flgYF8PDwwWFhQqKijQ0M+VlZRnZ2YODgwmJiTJycmOjo1vb24ZGRciIiDDw8Lj4+JKSkizs7N3d3Xp6elFRUQLCwkjIyENDQt+fnx+fn21tbXt7e3KysmGhoUYGBWwsK/9/fzy8vJRUU8QEA0nJyWoqKjQ0NCWlpWhoaD6+vpfX10pKSjV1dWZmZhmZmXNzcyRkZD8/PttbWwODgvGxsasrKuJiYh1dXTAwL8bGxiCgoF9fXy5ubi7u7uFhYSysrFzc3KNjYyqqqn39/eMjItra2qkpKN0dHOKiolkZGOcnJthYV+AgH9dXVz4+PhsbGsyMjBycnD19fWrq6qMjIxzc3GxsbC4uLeCgoC+vr6bm5rFxcWQkI8SEg/MzMsmJiVmZmSYmJfT09IrKyleXlygoJ/U1NRaWllAQD8WFhNNTUvAqG3jAAAAAWJLR0QGYWa4fQAAAAlwSFlzAAASdAAAEnQB3mYfeAAAAAd0SU1FB+YIHgI1LB8SQ2kAAAKaSURBVDjLPZPpW9NAEIc3qU422nC0GLBqqkQrFjxQTNUWpVLFIIKCSiuIF4r3BSioKB4o3veN4o3XH+nMbB77Kc/zzu7O+5upEOqn6aFp08GQYMKMmWFLaEXFJaURK1r2n8+yy8EkXjE7pmuaHZkzF+Y5Wjzg8xeISnCJL1zk2MgTiyvAhariJYpb0WQ1cQNqljrLkMeWr8D7TKhdGfDQKsXrVntFyFNr1uJlIKW7jrmWzihev96j8+n4BrwfuZQGcRFrYC6zGxvxfT23aTNxwzAACzRhRZoUd7f4NvqEm7cyhzoTK4SwnBbmhrGNeWvbduIm7GjvwA+he1XkLw3YyTxpVSq+a3dnvhxcUdjD3ISuRp18ot2K72138qF8D4guyhf5Po/5/gP03kE41HvYxnaO9AhXMm9xLPbtC3xLPPaJHxV03oVjEYt9jyt+4qTP/NRpEMwbEsIi3zPK1zzL/Yaaz2GTxDMpjbhzHvrJVw4Mch5tF0gT+cVcFLneOBT4Dhc4D/0Scilc6Gi9TNy/EviODOqUR/Qqz0PAtWhS14RdqA34qM++4evUD86iOx9mfgNoNibc5Dy03C3V75i47eGDduEO834o5TxEajzYn7sC7hX0osJ9E5vDfh8kLAt5Ipi/+VAIAx453uMnwHw8xnk4TdSPIeXTzmcCTz7vfaH4yxzloXuvAt/XvlUmcBT1NYq/CXMe3mjgUztoJ8twFpJ2C53fsq/ujwT8HfpigcQKSfw9Zoe+/nAw/yH0pYIJqkf+oY3z8Ad4V134SL5UMDmBRi58+hxi/sVVvl8niVOBlspAFr59z9Ef0v+RlZznFPtyAabaBz/jaVqQyK8x8jEgk9aY8w1Wqz71O2JjPn/+sq8J1eyrCv4BVZVzssZYsOsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDgtMzBUMDI6NTM6MjErMDA6MDBmmUewAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA4LTMwVDAyOjUzOjIxKzAwOjAwF8T/DAAAAABJRU5ErkJggg=="},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:e.form.branch.name},{text:e.form.branch.address1},{text:e.form.branch.address2}]},{text:"Quotation Customized Furniture",style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",e.form.name],["Contact No",":",e.form.phone],["Email",":",e.form.email],["Site Address",":",e.form.siteAddress]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(e.form.updatedAt,"DD MMM YYYY")],["Summary Quotation No",":",e.drawings[0].quotationNumber],["Branch",":",e.form.branch.name],["SC Name",":",e.form.salesConsultant.name],["SC Contact No",":",e.form.salesConsultant.mobile]]},layout:"noBorders"}]]},layout:"noBorders",style:"pagePadding"},{style:"tableExample",table:{widths:[80,"*","auto","auto",50,40,50],body:a}},{table:{widths:[80,"*","auto","auto",50,40,50],body:[[{stack:["\nTerms & Condition",{ol:["Quotation is subject to site measurement, design amendment and material selection","Quotation exclude electrical, plumbing, ducting and masonry work","Quotation is inclusive of delivery and installation","Payment terms: 10% deposit upon signing of Quotation, 90% upon final confirmation. The deposit is nontransferable and non-refundable","Quotation is valid for 30 days from the date hereof","This Quotation incorporates our terms and conditions set out on attached Terms and Conditions which you confirm you have read and understood. Both parties agree to be bound by these terms and conditions by signing this quotation"]}],colSpan:4,rowSpan:1,border:[!0,!1,!0,!0]},"","","",{text:"Total",style:"footerTitle",colSpan:2,border:[!0,!1,!0,!0]},{},{text:o.toFixed(2),style:"priceCol",border:[!0,!1,!0,!0]}],[{text:"",colSpan:4,rowSpan:6},"","","",{text:"Round Up Discount",colSpan:2,style:"footerTitle"},{},{text:e.lumpsum.toFixed(2),style:"priceCol"}],["","","","",{text:"GST/SST",style:"footerTitle",colSpan:2},{},{text:m.toFixed(2),style:"priceCol"}],["","","","",{text:"Nett Total",style:"footerTitle",colSpan:2},{},{text:p.toFixed(2),style:"priceCol"}],["","","","",{text:"Round-Down",style:"footerTitle",colSpan:2},{},{text:h.toFixed(2),style:"priceCol"}],["","","","",{text:"Down Payment",style:"footerTitle",colSpan:2},{},{text:"0.00",style:"priceCol"}],["","","","",{text:"Balance Payment",style:"footerTitle",colSpan:2},{},{text:h.toFixed(2),style:"priceCol"}]]}},{table:{widths:["*"],body:[[{stack:["By signing this Quotation, you have signified your consent to Signature Kitchen Sdn Bhd and all its associate companies and/or other related parties to collect and process your personal data (“Personal Data”) for purposes related to the products and services requested by you in accordance with the Personal Data Protection Act 2010.","\nPlease visit our website at www.signaturekitchen.com.my for further details on our Personal Data Protection Policy including access to correct your data or limit or withdraw consent to the processing of your Personal Data."]}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:["*","auto"],body:[[{stack:["Yours Faithfully",{text:"",style:"topMargin"},"_______________________________",e.form.salesConsultant.name,e.form.salesConsultant.mobile,e.form.salesConsultant.email]},{stack:["Agreed and confirmed by",{text:"",style:"topMargin"},"_______________________________","Customer Name :   "+e.form.name,"IC No : "]}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:["*"],body:[[{text:"TERMS AND CONDITIONS",style:"header"}],[{stack:[{ol:[{text:"Quotation and Final Confirmation",style:"headerTitle",counter:1},{text:"This Quotation contains a brief description of the kitchen cabinets and/or wardrobe, worktop, living products, accessories and appliances (if any) (hereafter called “the Products”) and the price in the quotation is based on the initial proposal of the layout and subject to change upon Final Confirmation Order between the Customer and Signature Kitchen Sdn Bhd (hereafter referred to the Company).",counter:1.1},{text:"\n",listType:"none"},{text:"The Final Confirmation Order with the Price is generated based on the Quotation, site measurement, design amendment, material selection and drawings. The Customer shall be responsible to verify the accuracy of the details of the Product as shown in the Final Confirmation Order.",counter:1.2},{text:"\n",listType:"none"},{text:"All prices are subject to adjustments due to all relevant taxes, if any, to be imposed by the authorities.",counter:1.3},{text:"\n",listType:"none"},{text:"The Company expressly reserves the right to make any changes to the design and/or specifications of the Products from time to time, withdraw any obsolete design, and/or make alterations or modifications due to product improvements and/or technological improvements, which would be notified to the Customer before the Final Confirmation.",counter:1.4},{text:"\n",listType:"none"},{text:"Booking Deposit",style:"headerTitle",counter:2},{text:'Upon signing of the Quotation, the Customer shall pay ten percent (10%) of the price as deposit (hereafter called "Booking Deposit") to the Company.',counter:2.1},{text:"\n",listType:"none"},{text:"The Booking Deposit paid by the Customer shall be irrevocably forfeited by the Company in the event that the Customer cancels the Quotation or does not proceed within twelve (12) months from the date of the Quotation. Upon forfeiture of the Booking Deposit, the Customer shall have no right to any claim against the Company and any subsequent order (if any) by the Customer shall be deemed as a fresh order.",counter:2.2},{text:"\n",listType:"none"},{text:"The Booking Deposit is non-transferable and non-refundable.",counter:2.3},{text:"\n",listType:"none"},{text:"Payment",style:"headerTitle",counter:3},{text:"Payment by cheques, credit card or online transfers will only be considered as having been paid subject to the clearance thereof.",counter:3.1},{text:"\n",listType:"none"},{text:"The Customer shall make full payment upon issuance of their confirmed requirements in the Final Confirmation.",counter:3.2},{text:"\n",listType:"none"},{text:"In no circumstances whatsoever shall the Customer withhold any payment to the Company upon issuance of the Final Confirmation.",counter:3.3},{text:"\n",listType:"none"},{text:"Time for payment shall be of the essence.",counter:3.4},{text:"\n",listType:"none"},{text:"Delivery",style:"headerTitle",counter:4},{text:"All Product sold and delivered to the customer in accordance with the Final Confirmation Order shall be non-returnable.",counter:4.1},{text:"\n",listType:"none"},{text:'The delivery date (hereafter called the "Delivery Date") provided to the Customer is an approximate date.',counter:4.2},{text:"\n",listType:"none"},{text:"The Company shall not be held liable for any losses in respect of any delay in production, shipment, transit or delivery arising from the following circumstances: -",counter:4.3},{text:"\n",listType:"none"},{ul:[{text:"changes, modification and/or alterations made by the Customer after issuance of the Final Confirmation;"},{text:"\n",listType:"none"},{text:"supplier’s failure to provide materials, labour, fuel, parts and/or machinery to the Company;"},{text:"\n",listType:"none"},{text:"shortage in obtaining materials for the production of the Products for any reason whatsoever; and/or"},{text:"\n",listType:"none"},{text:"any other unforeseen circumstances beyond the reasonable control of the Company."},{text:"\n",listType:"none"}]},{text:"If the Customer does not accept delivery within sixty (60) days from the completion of the production of the Product or the Customer cannot be located, without prejudice to any other right or remedy available to the Company, the Company shall be entitled to:",counter:4.4,pageBreak:"before"},{text:"\n",listType:"none"},{ul:[{text:"charge the Customer storage for the period commencing from the expiry of sixty (60) days from the completion of production of the Product until delivery thereof; and"},{text:"\n",listType:"none"},{text:"treat the Final Confirmation Order as cancelled after six (6) months from the completion of production of the Product and forfeit all payments made pursuant thereto and dispose the Product at the Company’s sole discretion."},{text:"\n",listType:"none"}]},{text:"The Customer shall confirm delivery and installation of the Product at the Customer’s Premises in accordance with the Final Confirmation Order by signing the Handover Letter immediately upon delivery and installation (thereafter referred to as the “Completion Date”). In the event of failure by the Customer to do so, then, it shall be deemed that the Customer has duly accepted the completion and handover the job within three (3) days of such Completion Date.",counter:4.5},{text:"\n",listType:"none"},{text:"Installation",style:"headerTitle",counter:5},{text:'The Company shall bear no responsibility for any ducting, wiring, plumbing, concreting, masonry, installation and/or renovation works required by the Customer (hereafter called "Other Works") and in the event that the Customer engages their own contractor to undertake such Other Works, the Customer shall bear full responsibility for such Other Works as the arrangement shall be regarded as a private arrangement between the Customer and an independent contractor which shall not bind the Company in any way whatsoever.',counter:5.1},{text:"\n",listType:"none"},{text:"Any complaint by the Customer in relation to defective works carried-out by the Company’s authorized contractors shall include an explanation of the circumstances relating to the claim. The Company shall on a best endeavor basis, investigate and verify such complaint, whereupon, the Company shall rectify the same.",counter:5.2},{text:"\n",listType:"none"},{text:"Short Delivery",style:"headerTitle",counter:6},{text:"Any complaint by the Customer regarding any short delivery of the Product must be made promptly in writing within three (3) days from the Completion Date as stated in Clause 4.5 above. The Company shall on a best endeavor basis investigate and verify such complaints and thereafter remedy and/or rectify the same.",counter:6.1},{text:"\n",listType:"none"},{text:"Warranty for the Product",style:"headerTitle",counter:7},{text:"The Product is covered by a one (1) year warranty by the Company against manufacturing defects with effective from the date of invoice, subject to the followings (hereafter called “the Warranty”):-",counter:7.1},{text:"\n",listType:"none"},{ul:[{text:"This Warranty is to the benefit of the Customer and it is not transferable to any other party."},{text:"\n",listType:"none"},{text:"This Warranty shall not cover the following circumstances and the costs to replace or repair shall be borne by the Customer: -"},{ul:[{text:"the effects of normal wear and tear of the Product;"},{text:"cosmetic damage, including scratches, dents, chips, cut or damages caused by impacts or accidents unless such damage results from defects in materials or workmanship and is reported to the Company within 30 days from the date of installation;"},{text:"the damages caused by power surges or outages;"},{text:"the damages caused by water leakages from water outlets or water spillage due to user’s negligence;"},{text:"the damages caused by fire, flood, explosion, acts of God, or other external causes beyond the Company’s control;"},{text:"the damages caused by lack of normal maintenance, negligence, misuse, willful damage or it was cleaned with wrong cleaning methods or wrong cleaning products;"},{text:"the damages caused by extreme conditions such as excessive exposure to direct sunlight, exposure to moisture or exposure to extreme temperatures;"},{text:"the defects caused by cats, dogs, household pests including but not limited to termites, ants, wood borers and rats;"},{text:"natural variations in the color, materials or textures, changes arising from natural aging process of the material and grain of the wood, deterioration or tarnishing to surface finishes; or"},{text:"the Product has undergone repairs, modifications, alterations or dismantlement without the Company’s approval."}]}]},{text:"\n",listType:"none"},{text:"Any complaint by the Customer in relation to the Warranty must be made promptly in writing within the period of the Warranty as stated in Clause 7.1 and shall include an explanation of the circumstances leading to such claim and the Customer confirms that the Company shall not be liable and responsible for any defects occur after the period of Warranty.",counter:7.2},{text:"\n",listType:"none"},{text:"All warranty claims are subject to the Company’s discretion with verification from the Company’s authorised service contractor and the Customer shall present the following documents for warranty claim: -",counter:7.3},{text:"\n",listType:"none"},{ul:[{text:"the invoice and official receipt from the Company; and"},{text:"\n",listType:"none"},{text:"the hand over letter."},{text:"\n",listType:"none"}]},{text:"The Company shall at its discretion, either repair the defective Product or replace it with the same or a comparable Product in the event that the Product is discontinued.",counter:7.4},{text:"\n",listType:"none"},{text:"Any defected parts removed in the course of repair or dismantlement works will become the property of the Company.",counter:7.5},{text:"\n",listType:"none"},{text:"The Company shall have the right to impose additional labour costs and transportation if the Product is not made accessible to the Company’s authorised service contractor or the Product installed location is remote.",counter:7.6},{text:"\n",listType:"none"},{text:"The Company shall be under no liability whatsoever to the Customer for any special, indirect, economic or consequential loss or damage suffered by the Customer arising out of a breach by the Company’s obligations or delay in performing, or any failure to perform any of the Company’s obligations.",counter:7.7},{text:"\n",listType:"none"},{text:"Variation of Terms and Conditions",style:"headerTitle",counter:8},{text:"The Company expressly reserves its right to amend any of the terms and conditions herein contained.",counter:8.1},{text:"\n",listType:"none"},{text:"General",style:"headerTitle",counter:9},{text:"Any notices related to the Product shall be forwarded to the intended recipient at their contact numbers or addresses as previously notified and sent by short messaging services (“SMS”), text messaging or other instant messaging applications, web applications or sent to the intended recipient through the Company’s official social media networks.",counter:9.1},{text:"\n",listType:"none"},{text:"Any notice of legal process or demand required to be served by either party shall be in writing and deemed served if: -",counter:9.2},{text:"\n",listType:"none"},{ul:[{text:"sent by prepaid registered post addressed to the other party or that party(ies)’s address or solicitors’ address five (5) days after the same shall have been delivered to the relevant party for delivery;"},{text:"\n",listType:"none"},{text:"dispatched by hand to the other party, or that other party’s(ies)’s solicitors when receipt of the same is acknowledged on the duplicate thereof; or"},{text:"\n",listType:"none"},{text:"if sent by facsimile or email transmission, on the day of the transmission by the sender if on a business day or if not, on the next succeeding business day provided that there’s an automatically generated report that the recipient shall have received such document upon completion of the transmission."}]},{text:"\n",listType:"none"},{text:"If any of these terms and conditions are held by any competent authority to be invalid or unenforceable the validity of the remaining terms and conditions shall not be affected thereby.",counter:9.3},{text:"\n",listType:"none"},{text:"The terms and conditions contained herein shall be governed by and any construed in all respect in accordance with the current laws of Malaysia.",counter:9.4},{text:"\n",listType:"none"}]},{text:"_________________________________________________________________________________",alignment:"center"},{text:"(The rest of this page is intentionally left blank)",alignment:"center",italics:!0}]}]]},layout:"noBorders",style:"pagePadding",pageBreak:"before"}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"portrait"};ca["createPdf"](f).open()}))()},onClickToOrderConfirmation(){var e=this;return i()((function*(){try{e.drawings=e.drawings.map(e=>e.uuid),e.$q.loading.show();const t=yield e.$store.dispatch("CreateOrUpdateOrderConfirmationFromSummaryQuotations",{designIds:e.drawings,leadId:e.selectedLeadId});e.$q.loading.hide(),e.$notify("success","Successfully move to order confirmation"),console.log(e.drawings),console.log(t)}catch(t){e.$q.loading.hide(),console.log(t)}}))()},reset(){this.drawings={},this.quotation=[],this.form={leadId:"",designId:""}}}},pa=ma,ha=Object(b["a"])(pa,ia,la,!1,null,null,null),fa=ha.exports,ga=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Order Confirmation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm"},[a("div",[a("q-chip",{staticClass:"q-ma-none",attrs:{square:"",color:e.statusColour[e.form.status],"text-color":"white"}},[e._v("\n              "+e._s(e.form.status)+"\n              "),a("q-tooltip",[e._v("Order Confirmation Status")])],1)],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8"},[e._v("\n            Details\n          ")]),a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{disable:"",outlined:"",label:"Deposit Amount","lazy-rules":""},model:{value:e.form.paidAmountDeposit,callback:function(t){e.$set(e.form,"paidAmountDeposit",t)},expression:"form.paidAmountDeposit"}})],1),"Rejected"===e.form.status?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-7 q-mt-lg"},[e._v("\n            Remarks\n          ")]):e._e(),"Rejected"===e.form.status?a("q-input",{attrs:{filled:"",disable:"",type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}}):e._e(),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Supporting Documents\n          ")]),a("q-list",{attrs:{bordered:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.generatePdf}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v("Quotation Customised Furniture")])],1),e._l(e.form.paymentAttachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v(e._s(t.fileName))])],1)}))],2)],1)])],1)])],1)},ba=[],ya={components:{ModalDialog:v},data(){return{selectedLeadId:"",statusColour:{New:"secondary","Pending for Account or Manager approval":"secondary",Cancelled:"negative",Acknowledged:"positive",Rejected:"negative"},form:{},quotation:[],lumpsum:0}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{depositPdfUrl(){return this.form&&this.form.attachedDocumentDeposit?"https://api-prod.skcrm.com.my/containers/download/"+this.form.attachedDocumentDeposit:null}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0]),e.quotation=yield Promise.all(e.form.designs.filter(e=>"Confirmed"===e.state).map(function(){var t=i()((function*(t){return yield e.$store.dispatch("GetDesigns",t.uuid)}));return function(e){return t.apply(this,arguments)}}())),e.selectedLeadId=e.form.leadId}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===ca["vfs"]&&(ca["vfs"]=ua["pdfMake"].vfs),console.log("quotes",e.quotation),console.log("form",e.form);const a=e.form.lead.userId,o=e.form.lead.branchId,[s]=X["a"].query().withAll().whereId(a).get();console.log(s);const[r]=I["a"].query().withAll().whereId(o).get(),{lead:i}=e.form;var l=[],n=0,d=0,c=0,u=0;l.push([{text:"Item",style:"headerTitle"},{text:"Description",style:"headerTitle"},{text:"Qty",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"Unit Price\n(RM)",alignment:"center",style:"headerTitle"},{text:"Discount\n(%)",alignment:"center",style:"headerTitle"},{text:"Amount\n(RM)",alignment:"center",style:"headerTitle"}]);try{for(var m of e.quotation){const e=1;n+=m.discountedTotalPrice,d+=m.totalInstallationCharges,d=Math.ceil(d),c+=m.transportationCharge,u+=m.installerOutstationCharge,m.quotationDetails&&l.push(["Drawing Item: "+m.referenceName,m.materials,{text:e.toFixed(2),alignment:"center"},{text:"Set",alignment:"center"},{text:Math.ceil(m.totalPriceDrawingItems.toFixed(2)),alignment:"right"},{text:m.masterItemDiscount,alignment:"center"},{text:Math.ceil((m.discountedTotalPriceDrawingItems*e).toFixed(2)),alignment:"right"}])}for(var p of e.quotation){if(p.tradingItems)for(var h of p.tradingItems)l.push(["Optional Item: "+h.category,h.name+" | "+h.itemcode,{text:h.designAdditionalItems[0].quantity.toFixed(2),alignment:"center"},{text:h.uom,alignment:"center"},{text:Math.ceil((h.stdcost*h.markuprate).toFixed(2)),alignment:"right"},{text:100*h.designAdditionalItems[0].discount,alignment:"center"},{text:Math.ceil((h.stdcost*h.markuprate*h.designAdditionalItems[0].quantity*(1-h.designAdditionalItems[0].discount)).toFixed(2)),alignment:"right"}]);if(p.looseItems)for(var f of p.looseItems)l.push(["Loose Item: "+f.category,f.name+" | "+f.itemcode,{text:f.designAdditionalLooseItems[0].quantity.toFixed(2),alignment:"center"},{text:`${f.puom} (puom)\n${f.suom} (suom)`,alignment:"center"},{text:Math.ceil((f.stdcost*f.markuprate).toFixed(2)),alignment:"right"},{text:100*f.designAdditionalLooseItems[0].discount,alignment:"center"},{text:Math.ceil((f.stdcost*f.markuprate*f.designAdditionalLooseItems[0].quantity*(1-f.designAdditionalLooseItems[0].discount)).toFixed(2)),alignment:"right"}]);if(p.designOtherItems)for(const e of p.designOtherItems)l.push([{text:"Other Item",alignment:"left"},{text:`${e.name}: ${e.description}`,alignment:"left"},{text:e.quantity.toFixed(2),alignment:"center"},{text:e.UOM,alignment:"center"},{text:e.unitPrice.toFixed(2),alignment:"right"},{text:e.discount,alignment:"center"},{text:e.discountedPrice.toFixed(2),alignment:"right"}])}for(var g of(l.push([{text:" ",colSpan:7},{text:" ",colSpan:7}]),e.quotation))g.lumpsum&&(e.lumpsum=g.lumpsum),g.isIncludedInstallationCharge&&l.push([{text:"Others"},{text:"Installation Charges"},{text:"",colSpan:4},{},{},{},{text:Math.ceil(g.totalInstallationCharges.toFixed(2)),alignment:"right"}]),g.isIncludedTransportationCharge&&l.push([{text:"Others"},{text:"Transportation Charges"},{text:"",colSpan:4},{},{},{},{text:Math.ceil(g.transportationCharge.toFixed(2)),alignment:"right"}]),g.isIncludedInstallerOutstationCharge&&l.push([{text:"Others"},{text:"Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:Math.ceil(g.installerOutstationCharge.toFixed(2)),alignment:"right"}]),g.isIncludedTransportationCharge&&l.push([{text:"Others"},{text:"Transportation Charges"},{text:"",colSpan:4},{},{},{},{text:g.transportationCharge.toFixed(2),alignment:"right"}]);console.log(n,e.quotation[0].discountedTotalPrice,d,c),n+=d+c+u}catch(x){console.log("error bro",x),e.$notify("error","No Quotation Details")}let b=.08*n;b=0;const y=n+b-e.lumpsum,v=Math.floor(y);var q={images:{logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACB1BMVEUdHRscHBofHx0XFxUlJSPNzc3////9/f3+/v78/Pzf3944ODYYGBYeHhwhIR8MDApYWFaUlJMREQ8bGxkuLiwZGRYgIB7AwMDn5+dCQkETExFDQ0Lo6OiLi4oQEA4vLy0eHh0aGhe8vLz7+/vs7OxEREMSEhA/Pz2Hh4YxMS8aGhi0tLPx8fFMTEogIB84ODfi4uJ6enkfHxysrKz09PRSUlEPDw0UFBIzMzLc3NyPj44VFROlpaT29vZZWVfW1tadnZz5+flgYF8PDwwWFhQqKijQ0M+VlZRnZ2YODgwmJiTJycmOjo1vb24ZGRciIiDDw8Lj4+JKSkizs7N3d3Xp6elFRUQLCwkjIyENDQt+fnx+fn21tbXt7e3KysmGhoUYGBWwsK/9/fzy8vJRUU8QEA0nJyWoqKjQ0NCWlpWhoaD6+vpfX10pKSjV1dWZmZhmZmXNzcyRkZD8/PttbWwODgvGxsasrKuJiYh1dXTAwL8bGxiCgoF9fXy5ubi7u7uFhYSysrFzc3KNjYyqqqn39/eMjItra2qkpKN0dHOKiolkZGOcnJthYV+AgH9dXVz4+PhsbGsyMjBycnD19fWrq6qMjIxzc3GxsbC4uLeCgoC+vr6bm5rFxcWQkI8SEg/MzMsmJiVmZmSYmJfT09IrKyleXlygoJ/U1NRaWllAQD8WFhNNTUvAqG3jAAAAAWJLR0QGYWa4fQAAAAlwSFlzAAASdAAAEnQB3mYfeAAAAAd0SU1FB+YIHgI1LB8SQ2kAAAKaSURBVDjLPZPpW9NAEIc3qU422nC0GLBqqkQrFjxQTNUWpVLFIIKCSiuIF4r3BSioKB4o3veN4o3XH+nMbB77Kc/zzu7O+5upEOqn6aFp08GQYMKMmWFLaEXFJaURK1r2n8+yy8EkXjE7pmuaHZkzF+Y5Wjzg8xeISnCJL1zk2MgTiyvAhariJYpb0WQ1cQNqljrLkMeWr8D7TKhdGfDQKsXrVntFyFNr1uJlIKW7jrmWzihev96j8+n4BrwfuZQGcRFrYC6zGxvxfT23aTNxwzAACzRhRZoUd7f4NvqEm7cyhzoTK4SwnBbmhrGNeWvbduIm7GjvwA+he1XkLw3YyTxpVSq+a3dnvhxcUdjD3ISuRp18ot2K72138qF8D4guyhf5Po/5/gP03kE41HvYxnaO9AhXMm9xLPbtC3xLPPaJHxV03oVjEYt9jyt+4qTP/NRpEMwbEsIi3zPK1zzL/Yaaz2GTxDMpjbhzHvrJVw4Mch5tF0gT+cVcFLneOBT4Dhc4D/0Scilc6Gi9TNy/EviODOqUR/Qqz0PAtWhS14RdqA34qM++4evUD86iOx9mfgNoNibc5Dy03C3V75i47eGDduEO834o5TxEajzYn7sC7hX0osJ9E5vDfh8kLAt5Ipi/+VAIAx453uMnwHw8xnk4TdSPIeXTzmcCTz7vfaH4yxzloXuvAt/XvlUmcBT1NYq/CXMe3mjgUztoJ8twFpJ2C53fsq/ujwT8HfpigcQKSfw9Zoe+/nAw/yH0pYIJqkf+oY3z8Ad4V134SL5UMDmBRi58+hxi/sVVvl8niVOBlspAFr59z9Ef0v+RlZznFPtyAabaBz/jaVqQyK8x8jEgk9aY8w1Wqz71O2JjPn/+sq8J1eyrCv4BVZVzssZYsOsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDgtMzBUMDI6NTM6MjErMDA6MDBmmUewAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA4LTMwVDAyOjUzOjIxKzAwOjAwF8T/DAAAAABJRU5ErkJggg=="},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:r.name},{text:r.address1},{text:r.address2}]},{text:"Quotation Customized Furniture",style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",i.name],["Contact No",":",i.phone],["Email",":",i.email],["Site Address",":",i.siteAddress]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(e.form.updatedAt,"DD MMM YYYY")],["Summary Quotation No",":",e.form.quotationNumber],["Branch",":",r.name],["SC Name",":",s.name],["SC Contact No",":",s.mobile]]},layout:"noBorders"}]]},layout:"noBorders",style:"pagePadding"},{style:"tableExample",table:{widths:[80,"*","auto","auto",50,40,50],body:l}},{table:{widths:[80,"*","auto","auto",50,40,50],body:[[{stack:["\nTerms & Condition",{ol:["Quotation is subject to site measurement, design amendment and material selection","Quotation exclude electrical, plumbing, ducting and masonry work","Quotation is inclusive of delivery and installation","Payment terms: 10% deposit upon signing of Quotation, 90% upon final confirmation. The deposit is nontransferable and non-refundable","Quotation is valid for 30 days from the date hereof","This Quotation incorporates our terms and conditions set out on attached Terms and Conditions which you confirm you have read and understood. Both parties agree to be bound by these terms and conditions by signing this quotation"]}],colSpan:4,rowSpan:7,border:[!0,!1,!0,!0]},"","","",{text:"Total",style:"footerTitle",colSpan:2,border:[!0,!1,!0,!0]},{},{text:n.toFixed(2),style:"priceCol",border:[!0,!1,!0,!0]}],["","","","",{text:"Round Up Discount",colSpan:2,style:"footerTitle"},{},{text:e.lumpsum.toFixed(2),style:"priceCol"}],["","","","",{text:"GST/SST",style:"footerTitle",colSpan:2},{},{text:b.toFixed(2),style:"priceCol"}],["","","","",{text:"Nett Total",style:"footerTitle",colSpan:2},{},{text:y.toFixed(2),style:"priceCol"}],["","","","",{text:"Round-Down",style:"footerTitle",colSpan:2},{},{text:v.toFixed(2),style:"priceCol"}],["","","","",{text:"Down Payment",style:"footerTitle",colSpan:2},{},{text:"0.00",style:"priceCol"}],["","","","",{text:"Balance Payment",style:"footerTitle",colSpan:2},{},{text:v.toFixed(2),style:"priceCol"}]]}},{table:{widths:["*"],body:[[{stack:["By signing this Quotation, you have signified your consent to Signature Kitchen Sdn Bhd and all its associate companies and/or other related parties to collect and process your personal data (“Personal Data”) for purposes related to the products and services requested by you in accordance with the Personal Data Protection Act 2010.","\nPlease visit our website at www.signaturekitchen.com.my for further details on our Personal Data Protection Policy including access to correct your data or limit or withdraw consent to the processing of your Personal Data."]}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:["*","auto"],body:[[{stack:["Yours Faithfully",{text:"",style:"topMargin"},"_______________________________",s.name,s.mobile,s.email]},{stack:["Agreed and confirmed by",{text:"",style:"topMargin"},"_______________________________","Customer Name :   "+i.name,"IC No : "]}]]},layout:"noBorders",style:"pagePadding"}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"portrait"};ca["createPdf"](q).open()}))()},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},openPdfInNewPage(e){window.open(e,"_blank")},reset(){this.form={},this.quotation=[]}}},va=ya,qa=Object(b["a"])(va,ga,ba,!1,null,null,null),xa=qa.exports,Ca=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"toFinalOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          To Final Confirmation Order\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Send Order To Final Confirmation Order?\n          ")]),a("div",{attrs:{align:"right"}},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"To Final Confirmation Order",color:"primary",disabled:e.isBtnDisabled},on:{click:e.onAssignLeads}}),e.isBtnDisabled&&"FCO"===e.form.state?a("q-tooltip",[e._v("\n                Order is already in Final Confirmation Order\n              ")]):e.isBtnDisabled&&"home"===e.userBranchType?a("q-tooltip",[e._v("\n                Must have HQ Accountant's acknowledgement\n              ")]):e.isBtnDisabled&&"dealer"===e.userBranchType?a("q-tooltip",[e._v("\n                Must have Branch Manager's acknowledgement\n              ")]):e.isBtnDisabled?a("q-tooltip",[e._v("\n                Must have HQ Accountant's acknowledgement\n              ")]):e._e()],1)])])])],1)])],1)},wa=[],ka={components:{ModalDialog:v},data(){return{selectedLeadId:"",userBranch:{},form:{},suggestedBranchId:"",isBtnDisabled:!1,userBranchType:""}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{selections(){const e=this.$store.getters.tableSelection;if(console.log("selection",e),!e.length)return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},selections(e,t){e.length&&(this.selectedLeadId=this.selections[0].value)}},methods:{reset(){this.selectedLeadId="",this.form={}},onShowDialog(){var e=this;return i()((function*(){e.form=e.$store.getters.tableSelection[0],e.isBtnDisabled="Acknowledged"!==e.form.status,e.isBtnDisabled="FCO"===e.form.state,e.selectedLeadId=e.form.leadId;const{data:t}=yield e.$repository.branch.getById(e.$store.state.user.branchId);e.userBranchType=t.type}))()},onAssignLeads(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("ToFco",{orderId:e.$store.getters.tableSelection[0].uuid,leadId:e.$store.getters.tableSelection[0].leadId}),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Successfully assigned lead to Final Confirmation Order")}catch(t){console.log(t),e.$q.loading.hide(),e.$notify("error","Error")}}))()}}},_a=ka,Sa=Object(b["a"])(_a,Ca,wa,!1,null,null,null),Aa=Sa.exports,Ma=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"submitToManager"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Add Additional Data\n        ")])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Additional Data\n        ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Total Amount","lazy-rules":"",prefix:"RM",disable:""},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}}),a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload Supporting Documents",color:"teal",multiple:""},on:{uploaded:e.fileUploaded}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{color:"primary",disabled:e.isDisabledSubmit,label:"Submit to manager"},on:{click:e.onSubmit}}),e.isDisabledSubmit&&"Production"===e.form.status?a("q-tooltip",[e._v("\n                Order is already in Production\n              ")]):e._e(),e.isDisabledSubmit&&"Production"!==e.form.status?a("q-tooltip",[e._v("\n                No supporting document uploaded\n              ")]):e._e()],1)],1)],1)],1)],1)])],1)},Ia=[],$a={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isDisabledSubmit:!0,fileUpload:null,options:{races:["Malay","Chinese","Indian","Others"],property_types:["Condo","Terrace House","Semi-D","Bungalow","Shop & Office"]},form:{leadId:"",birthday:"",race:"",propertySize:"",deliveryAddress:"",property_type:"",email:"",amount:""},selection:{}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"}}),methods:{fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const[{name:o}]=e;try{const{files:e}=JSON.parse(t.response),[{name:s}]=e[o],{uuid:r}=a.form;if(!s)throw new Error;yield a.$store.dispatch("AddFCOAttachment",{fileName:o,name:s,type:"Others",orderId:r}),a.isDisabledSubmit=!1,a.$notify("success","File upload success")}catch(s){a.$notify("error","Error uploading attachment "+o)}}))()},onShowDialog(){this.selection=this.$store.getters.tableSelection[0],this.form=n()({},this.selection),console.log(this.form);const e=this.selection.designs?this.selection.designs.reduce((e,t)=>{let a=0;return this.selection.designs.forEach(e=>{a+=Math.ceil(e.totalInstallationCharges),a+=Math.ceil(e.transportationCharge),a+=Math.ceil(e.installerOutstationCharge),a+=Math.ceil(e.discountedTotalPrice)}),Math.floor(a-t.lumpsum)},0):0;this.form.amount=e,this.form.paymentAttachments&&this.form.paymentAttachments.length&&(this.isDisabledSubmit=!1),"Production"===this.form.status&&(this.isDisabledSubmit=!0)},reset(){this.form={},this.isDisabledSubmit=!0},onSubmit(){var e=this;return i()((function*(){try{const{uuid:t}=e.tableSelection[0];e.$q.loading.show(),yield e.$store.dispatch("UpdateFCO",{uuid:t,status:"Pending"}),e.reset(),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Final Confirmation Order submitted to Branch Manager.")}catch(t){e.$q.loading.hide(),e.$notify("error","Action failed. Please try again")}}))()}}},Da=$a,Ta=Object(b["a"])(Da,Ma,Ia,!1,null,null,null),Oa=Ta.exports,Na=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewFinalOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Final Confirmation Order\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8"},[e._v("\n            Order Details\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-chip",{staticClass:"q-ml-md q-my-sm",attrs:{square:"",color:e.statusColour[e.form.status],"text-color":"white"}},[e._v("\n            "+e._s(e.form.displayStatusForFCO)+"\n            "),a("q-tooltip",[e._v("Final Confirmation Order Status")])],1),["Production","Detailer"].includes(e.form.status)?a("div",e._l(e.form.designs,(function(t){return a("q-card",{key:t.uuid,staticClass:"\n            flex\n            items-center\n            justify-around\n            q-mx-lg\n            q-mb-lg\n            q-py-md\n            "},[a("div",{staticClass:"text-center"},[a("p",{staticClass:"text-weight-bold"},[e._v("\n                  Drawing Number and Job Number for "+e._s(t.referenceName)+"\n                ")]),t.referenceName.includes("Kitchen")||t.referenceName.includes("Pantry")?a("p",[e._v("\n                  "+e._s(t.drawingNumber)+" "+e._s("K"+e.form.jobId.toString().slice(0,8))+" "+e._s(t.jobPart)+"\n                ")]):a("p",[e._v("\n                  "+e._s(t.drawingNumber)+" "+e._s("W"+e.form.jobId.toString().slice(0,8))+" "+e._s(t.jobPart)+"\n                ")])])])})),1):e._e(),e.form.lead?a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Total Amount","lazy-rules":"",prefix:"RM",disable:""},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}}),e.form.status.includes("Rejected")?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-7 q-mt-lg"},[e._v("\n              Remarks\n              "),e.form.status.includes("Rejected")?a("p",[e._v("\n                "+e._s(e.form.remarks)+"\n              ")]):e._e()]):e._e()],1):e._e(),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8 q-mt-lg"},[e._v("\n            Supporting Documents\n          ")]),a("q-separator"),a("div",[a("q-list",{staticClass:"q-my-md",attrs:{bordered:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.generatePdf}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v("Quotation Customised Furniture")])],1),e._l(e.form.paymentAttachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",{attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[e._v("\n                  "+e._s(t.fileName)+"\n                ")]),e.isUserRoleAccount?e._e():a("q-item-section",{attrs:{clickable:"",avatar:""},on:{click:function(a){return e.deleteAttachment(t)}}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-trash"}})],1)],1)}))],2)],1),e.isUserRoleAccount?e._e():a("div",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8 q-mt-lg"},[e._v("\n              Upload Documents\n            ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload Supporting Documents",color:"teal",multiple:"","max-files":"1"},on:{uploaded:e.fileUploaded},scopedSlots:e._u([{key:"list",fn:function(t){return[a("q-list",{attrs:{separator:""}},e._l(t.files,(function(t){return a("q-item",{key:t.name},[a("q-item-section",{attrs:{side:""}},[a("q-item-label",{staticClass:"full-width ellipsis"},[e._v("\n                        "+e._s(t.name)+"\n                      ")]),a("q-item-label",{attrs:{caption:""}},[e._v("\n                        "+e._s(t.__sizeLabel)+" / "+e._s(t.__progressLabel)+"\n                      ")])],1),a("q-item-section",[a("q-select",{attrs:{outlined:"",options:e.paymentSelections,label:"Payment Option:","emit-value":"","map-options":"","stack-label":"","lazy-rules":""},on:{filter:e.filterFn},model:{value:e.form.paymentOption,callback:function(t){e.$set(e.form,"paymentOption",t)},expression:"form.paymentOption"}})],1),t.__img?a("q-item-section",{staticClass:"gt-xs",attrs:{thumbnail:""}},[a("img",{attrs:{src:t.__img.src}})]):e._e(),a("q-item-section",{attrs:{top:"",side:""}},[a("q-input",{attrs:{label:"Cheque Number (if applicable)"},model:{value:e.form.cheque,callback:function(t){e.$set(e.form,"cheque",t)},expression:"form.cheque"}})],1)],1)})),1)]}}],null,!1,1322147079)})],1)],1)])],1)])],1)},Ra=[],Fa=a("5f36"),ja=a("07f9"),La={components:{ModalDialog:v},data(){return{statusColour:{"Follow Up":"secondary",Pending:"secondary",Submitted:"secondary",Detailer:"secondary","BM Rejected":"negative","HQA Rejected":"negative",Production:"success"},options:{races:["Malay","Chinese","Indian","Others"],property_types:["Condo","Terrace House","Semi-D","Bungalow","Shop & Office"]},form:{leadId:"",ic:"",birthday:"",race:"",propertySize:"",deliveryAddress:"",property_type:"",email:"",amount:"",paymentOption:[],cheque:[]},selectedLeadId:"",quotation:[],drawings:{},lumpsum:0,selection:{},attachments:{},paymentSelections:[]}},computed:n()(n()({},Object(q["b"])(["tableSelection","roles"])),{},{isUserRoleDetailer(){const[e]=this.roles;return"detailer"===e},isUserRoleAccount(){const[e]=this.roles;return"hQAccountant"===e},depositPdfUrl(){return this.form&&this.form.attachedDocumentDeposit?"https://api-prod.skcrm.com.my/containers/download/"+this.form.attachedDocumentDeposit:null},fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"},paymentOpts(){const e=ja["a"].all();console.log(ja["a"].all());const t=e.map(e=>{const t=[];return t.label=e.paymentDescription,t.value=e.uuid,t});return t}}),created(){this.$store.dispatch("GetAllPaymentOptions")},methods:{filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.paymentSelections=this.paymentOpts.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.paymentSelections=this.paymentOpts})},fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const o=a.form.paymentOption,s=a.form.cheque,[{name:r}]=e;try{a.$q.loading.show();const{files:e}=JSON.parse(t.response),[{name:i}]=e[r],{uuid:l}=a.form;if(!i)throw new Error;console.log({isUserRoleDetailer:a.isUserRoleDetailer}),yield a.$store.dispatch("AddFCOAttachmentFromDetailer",{fileName:r,name:i,orderId:l,type:a.isUserRoleDetailer?"Detailer":"",paymentOptionsId:o,chequeNo:s}),a.isDisabledSubmit=!1,yield a.$store.dispatch("GetFcoLeads",{}),yield a.$store.dispatch("GetCoLeads",{}),a.$q.loading.hide(),a.$notify("success","File upload success")}catch(i){console.log(i),a.$q.loading.hide(),a.$notify("error","Error uploading attachment "+r)}}))()},onShowDialog(){var e=this;return i()((function*(){e.paymentSelections=e.paymentOpts,e.selection=e.$store.getters.tableSelection[0];const[{uuid:t}]=e.tableSelection,[a]=yield Fa["a"].query().withAll().whereId(t).get();e.form=a;const o=e.selection.designs?e.selection.designs.reduce((t,a)=>{let o=0;return e.selection.designs.forEach(e=>{o+=Math.ceil(e.totalInstallationCharges),o+=Math.ceil(e.transportationCharge),o+=Math.ceil(e.installerOutstationCharge),o+=Math.ceil(e.discountedTotalPrice)}),Math.floor(o-a.lumpsum)},0):0;e.form.amount=o,e.form.paymentAttachments&&e.form.paymentAttachments.length&&(e.isDisabledSubmit=!1),e.quotation=[],e.selectedLeadId=e.form.leadId,e.drawings=e.form.designs,console.log(e.drawings),e.drawings.forEach(function(){var t=i()((function*(t){const a=yield e.$store.dispatch("GetDesigns",t.uuid);e.quotation.push(a),console.log("res",a)}));return function(e){return t.apply(this,arguments)}}()),console.log("das",e.quotation)}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===ca["vfs"]&&(ca["vfs"]=ua["pdfMake"].vfs);const a=e.form.lead.userId,o=e.form.lead.branchId;let[s]=X["a"].query().withAll().whereId(a).get();"undefined"!==typeof s&&(yield e.$store.dispatch("GetAllUsers",{}),s=X["a"].query().withAll().whereId(a).get()[0]);const[r]=I["a"].query().withAll().whereId(o).get(),{lead:i}=e.form;var l=[],n=0,d=0,c=0,u=0;l.push([{text:"Item",style:"headerTitle"},{text:"Description",style:"headerTitle"},{text:"Qty",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"Unit Price\n(RM)",alignment:"center",style:"headerTitle"},{text:"Discount\n(%)",alignment:"center",style:"headerTitle"},{text:"Amount\n(RM)",alignment:"center",style:"headerTitle"}]);try{for(var m of e.quotation){const e=1;n+=m.discountedTotalPrice,d+=m.totalInstallationCharges,d=Math.ceil(d),c+=m.transportationCharge,u+=m.installerOutstationCharge,m.quotationDetails&&l.push(["Drawing Item: "+m.referenceName,m.materials,{text:e,alignment:"center"},{text:"Set",alignment:"center"},{text:Math.ceil(m.totalPriceDrawingItems.toFixed(2)),alignment:"right"},{text:m.masterItemDiscount,alignment:"center"},{text:Math.ceil((m.discountedTotalPriceDrawingItems*e).toFixed(2)),alignment:"right"}])}for(var p of e.quotation){if(p.tradingItems)for(var h of p.tradingItems)l.push(["Optional Item: "+h.category,h.name+" | "+h.itemcode,{text:h.designAdditionalItems[0].quantity.toFixed(2),alignment:"center"},{text:h.uom,alignment:"center"},{text:Math.ceil((h.stdcost*h.markuprate).toFixed(2)),alignment:"right"},{text:100*h.designAdditionalItems[0].discount,alignment:"center"},{text:Math.ceil((h.stdcost*h.markuprate*h.designAdditionalItems[0].quantity*(1-h.designAdditionalItems[0].discount)).toFixed(2)),alignment:"right"}]);if(p.looseItems)for(var f of p.looseItems)l.push(["Loose Item: "+f.category,f.name+" | "+f.itemcode,{text:f.designAdditionalLooseItems[0].quantity.toFixed(2),alignment:"center"},{text:""+f.puom,alignment:"center"},{text:Math.ceil((f.stdcost*f.markuprate).toFixed(2)),alignment:"right"},{text:100*f.designAdditionalLooseItems[0].discount,alignment:"center"},{text:Math.ceil((f.stdcost*f.markuprate*f.designAdditionalLooseItems[0].quantity*(1-f.designAdditionalLooseItems[0].discount)).toFixed(2)),alignment:"right"}]);if(p.designOtherItems)for(const e of p.designOtherItems)l.push([{text:"Other Item",alignment:"left"},{text:`${e.name}: ${e.description}`,alignment:"left"},{text:e.quantity.toFixed(2),alignment:"center"},{text:e.UOM,alignment:"center"},{text:e.unitPrice.toFixed(2),alignment:"right"},{text:e.discount,alignment:"center"},{text:e.discountedPrice.toFixed(2),alignment:"right"}])}for(var g of(l.push([{text:" ",colSpan:7},{text:" ",colSpan:7}]),e.drawings))g.lumpsum&&(e.lumpsum=g.lumpsum),g.isIncludedInstallationCharge&&l.push([{text:"Others"},{text:"Installation Charges"},{text:"",colSpan:4},{},{},{},{text:Math.ceil(g.totalInstallationCharges.toFixed(2)),alignment:"right"}]),g.isIncludedTransportationCharge&&l.push([{text:"Others"},{text:"Transportation Charges"},{text:"",colSpan:4},{},{},{},{text:Math.ceil(g.transportationCharge.toFixed(2)),alignment:"right"}]),g.isIncludedInstallerOutstationCharge&&l.push([{text:"Others"},{text:"Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:Math.ceil(g.installerOutstationCharge.toFixed(2)),alignment:"right"}]);console.log(n,e.quotation[0].discountedTotalPrice,d,c),n+=d+c+u}catch(x){console.log("error bro",x),e.$notify("error","No Quotation Details")}let b=.08*n;b=0;const y=n+b-e.lumpsum,v=Math.floor(y);var q={images:{logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACB1BMVEUdHRscHBofHx0XFxUlJSPNzc3////9/f3+/v78/Pzf3944ODYYGBYeHhwhIR8MDApYWFaUlJMREQ8bGxkuLiwZGRYgIB7AwMDn5+dCQkETExFDQ0Lo6OiLi4oQEA4vLy0eHh0aGhe8vLz7+/vs7OxEREMSEhA/Pz2Hh4YxMS8aGhi0tLPx8fFMTEogIB84ODfi4uJ6enkfHxysrKz09PRSUlEPDw0UFBIzMzLc3NyPj44VFROlpaT29vZZWVfW1tadnZz5+flgYF8PDwwWFhQqKijQ0M+VlZRnZ2YODgwmJiTJycmOjo1vb24ZGRciIiDDw8Lj4+JKSkizs7N3d3Xp6elFRUQLCwkjIyENDQt+fnx+fn21tbXt7e3KysmGhoUYGBWwsK/9/fzy8vJRUU8QEA0nJyWoqKjQ0NCWlpWhoaD6+vpfX10pKSjV1dWZmZhmZmXNzcyRkZD8/PttbWwODgvGxsasrKuJiYh1dXTAwL8bGxiCgoF9fXy5ubi7u7uFhYSysrFzc3KNjYyqqqn39/eMjItra2qkpKN0dHOKiolkZGOcnJthYV+AgH9dXVz4+PhsbGsyMjBycnD19fWrq6qMjIxzc3GxsbC4uLeCgoC+vr6bm5rFxcWQkI8SEg/MzMsmJiVmZmSYmJfT09IrKyleXlygoJ/U1NRaWllAQD8WFhNNTUvAqG3jAAAAAWJLR0QGYWa4fQAAAAlwSFlzAAASdAAAEnQB3mYfeAAAAAd0SU1FB+YIHgI1LB8SQ2kAAAKaSURBVDjLPZPpW9NAEIc3qU422nC0GLBqqkQrFjxQTNUWpVLFIIKCSiuIF4r3BSioKB4o3veN4o3XH+nMbB77Kc/zzu7O+5upEOqn6aFp08GQYMKMmWFLaEXFJaURK1r2n8+yy8EkXjE7pmuaHZkzF+Y5Wjzg8xeISnCJL1zk2MgTiyvAhariJYpb0WQ1cQNqljrLkMeWr8D7TKhdGfDQKsXrVntFyFNr1uJlIKW7jrmWzihev96j8+n4BrwfuZQGcRFrYC6zGxvxfT23aTNxwzAACzRhRZoUd7f4NvqEm7cyhzoTK4SwnBbmhrGNeWvbduIm7GjvwA+he1XkLw3YyTxpVSq+a3dnvhxcUdjD3ISuRp18ot2K72138qF8D4guyhf5Po/5/gP03kE41HvYxnaO9AhXMm9xLPbtC3xLPPaJHxV03oVjEYt9jyt+4qTP/NRpEMwbEsIi3zPK1zzL/Yaaz2GTxDMpjbhzHvrJVw4Mch5tF0gT+cVcFLneOBT4Dhc4D/0Scilc6Gi9TNy/EviODOqUR/Qqz0PAtWhS14RdqA34qM++4evUD86iOx9mfgNoNibc5Dy03C3V75i47eGDduEO834o5TxEajzYn7sC7hX0osJ9E5vDfh8kLAt5Ipi/+VAIAx453uMnwHw8xnk4TdSPIeXTzmcCTz7vfaH4yxzloXuvAt/XvlUmcBT1NYq/CXMe3mjgUztoJ8twFpJ2C53fsq/ujwT8HfpigcQKSfw9Zoe+/nAw/yH0pYIJqkf+oY3z8Ad4V134SL5UMDmBRi58+hxi/sVVvl8niVOBlspAFr59z9Ef0v+RlZznFPtyAabaBz/jaVqQyK8x8jEgk9aY8w1Wqz71O2JjPn/+sq8J1eyrCv4BVZVzssZYsOsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDgtMzBUMDI6NTM6MjErMDA6MDBmmUewAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA4LTMwVDAyOjUzOjIxKzAwOjAwF8T/DAAAAABJRU5ErkJggg=="},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:r.name},{text:r.address1},{text:r.address2}]},{text:"Final Confirmation Order Customized Furniture",style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",i.name],["Contact No",":",i.phone],["Email",":",i.email],["Site Address",":",i.siteAddress]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(e.form.updatedAt,"DD MMM YYYY")],["Summary Quotation No",":",e.form.quotationNumber],["Branch",":",r.name],["SC Name",":",s.name],["SC Contact No",":",s.mobile]]},layout:"noBorders"}]]},layout:"noBorders",style:"pagePadding"},{style:"tableExample",table:{widths:[80,"*","auto","auto",50,40,50],body:l}},{table:{widths:[80,"*","auto","auto",50,40,50],body:[[{stack:["\nTerms & Condition",{ol:["Quotation is subject to site measurement, design amendment and material selection","Quotation exclude electrical, plumbing, ducting and masonry work","Quotation is inclusive of delivery and installation","Payment terms: 10% deposit upon signing of Quotation, 90% upon final confirmation. The deposit is nontransferable and non-refundable","Quotation is valid for 30 days from the date hereof","This Quotation incorporates our terms and conditions set out on attached Terms and Conditions which you confirm you have read and understood. Both parties agree to be bound by these terms and conditions by signing this quotation"]}],colSpan:4,rowSpan:7,border:[!0,!1,!0,!0]},"","","",{text:"Total",style:"footerTitle",colSpan:2,border:[!0,!1,!0,!0]},{},{text:n.toFixed(2),style:"priceCol",border:[!0,!1,!0,!0]}],["","","","",{text:"Round Up Discount",colSpan:2,style:"footerTitle"},{},{text:e.lumpsum.toFixed(2),style:"priceCol"}],["","","","",{text:"GST/SST",style:"footerTitle",colSpan:2},{},{text:b.toFixed(2),style:"priceCol"}],["","","","",{text:"Nett Total",style:"footerTitle",colSpan:2},{},{text:y.toFixed(2),style:"priceCol"}],["","","","",{text:"Round-Down",style:"footerTitle",colSpan:2},{},{text:v.toFixed(2),style:"priceCol"}],["","","","",{text:"Down Payment",style:"footerTitle",colSpan:2},{},{text:"0.00",style:"priceCol"}],["","","","",{text:"Balance Payment",style:"footerTitle",colSpan:2},{},{text:v.toFixed(2),style:"priceCol"}]]}},{table:{widths:["*"],body:[[{stack:["By signing this Quotation, you have signified your consent to Signature Kitchen Sdn Bhd and all its associate companies and/or other related parties to collect and process your personal data (“Personal Data”) for purposes related to the products and services requested by you in accordance with the Personal Data Protection Act 2010.","\nPlease visit our website at www.signaturekitchen.com.my for further details on our Personal Data Protection Policy including access to correct your data or limit or withdraw consent to the processing of your Personal Data."]}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:["*","auto"],body:[[{stack:["Yours Faithfully",{text:"",style:"topMargin"},"_______________________________",s.name,s.mobile,s.email]},{stack:["Agreed and confirmed by",{text:"",style:"topMargin"},"_______________________________","Customer Name :   "+i.name,"IC No : "]}]]},layout:"noBorders",style:"pagePadding"}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"portrait"};ca["createPdf"](q).open()}))()},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},sleep(e){return i()((function*(){return new Promise(t=>setTimeout(t,e))}))()},deleteAttachment(e){var t=this;return i()((function*(){const a={fileName:e.fileName,name:e.name,type:e.type,orderId:e.finalConfirmationOrderId};try{if(!a)throw new Error;console.log({isUserRoleDetailer:t.isUserRoleDetailer}),yield t.$store.dispatch("DeleteFCOAttachment",a),t.isDisabledSubmit=!1,yield t.$store.dispatch("GetFcoLeads",{}),yield t.$store.dispatch("GetCoLeads",{}),t.form.paymentAttachments&&t.form.paymentAttachments.length&&(t.form.paymentAttachments=t.form.paymentAttachments.filter(t=>t.uuid!==e.uuid)),t.$notify("success","File delete success"),yield t.sleep(2500),location.reload()}catch(o){console.log(o),t.$notify("error","Error deleting attachment "+e.fileName)}}))()},openPdfInNewPage(e){window.open(e,"_blank")},reset(){}}},Ea=La,Pa=Object(b["a"])(Ea,Na,Ra,!1,null,null,null),Ua=Pa.exports,Ba=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"actionsFinalOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Final Confirmation Order Actions\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Acknowledge or Reject\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",{staticClass:"q-mx-sm"},[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:e.isDisabledReject},on:{click:e.onClickReject}}),e.isDisabledReject&&!e.isRemarksFilled&&e.isOrderPendingBMApproval?a("q-tooltip",[e._v("\n            Remarks is required\n          ")]):e._e(),e.isDisabledReject&&!e.isOrderPendingBMApproval?a("q-tooltip",[e._v("\n            Order is not pending BM approval.\n          ")]):e._e()],1),a("div",[a("q-btn",{attrs:{label:"Acknowledge",color:"positive",disable:e.isDisabledAcknowledged},on:{click:e.onClickAcknowledge}}),e.isDisabledAcknowledged?a("q-tooltip",[e._v("\n            Order is not pending BM approval or Rejected by HQ Accountant.\n          ")]):e._e(),a("div")],1)],1)],1)])],1)},za=[],Ga={components:{ModalDialog:v},mixins:[x["a"]],data(){return{form:{},remarks:""}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isOrderPendingBMApproval(){return this.form&&"Pending"===this.form.status},isOrderHQARejected(){return this.form&&"HQA Rejected"===this.form.status},isRemarksFilled(){return!!this.remarks.length},isDisabledReject(){return!this.isOrderPendingBMApproval||!this.isRemarksFilled},isDisabledAcknowledged(){return!(this.isOrderHQARejected||this.isOrderPendingBMApproval)}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=e.tableSelection[0],console.log(e.tableSelection[0])}))()},reset(){this.remarks=""},onClickAcknowledge(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("FinalOrderConfirmationSubmitted",{orderId:e.tableSelection[0].uuid}),e.reset(),e.$q.loading.hide(),e.$notify("success","Order state successfully updated")}catch(t){e.$q.loading.hide(),e.$notify("error","Order state failed to be updated")}}))()},onClickReject(){var e=this;return i()((function*(){try{e.$q.loading.show(),e.$store.dispatch("FinalOrderConfirmationBMRejected",{orderId:e.tableSelection[0].uuid,remarks:e.remarks}),e.reset(),e.$q.loading.hide(),e.$notify("success","Order state successfully updated")}catch(t){e.$q.loading.hide(),e.$notify("error","Order state failed to be updated")}}))()}}},Qa=Ga,Ya=Object(b["a"])(Qa,Ba,za,!1,null,null,null),Ja=Ya.exports,Ka=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"finalConfirmationOrderApproveForProduction"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Submit FCO to Detailer\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Submit or Reject\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("p",[e._v("Approve for production and get automatically generated job number?")]),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-card-section",[e.attachments.paymentAttachments&&e.attachments.paymentAttachments.length?a("div",[a("div",[a("q-list",{staticClass:"q-my-md",attrs:{bordered:""}},e._l(e.attachments.paymentAttachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""}},[a("q-item-section",{staticStyle:{"overflow-wrap":"anywhere"},attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[e._v("\n                  "+e._s(t.fileName)+"\n                ")]),a("q-item-section",[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",prefix:"RM",label:"Approved Amount (RM)",dense:"",disable:null!==t.status},model:{value:t.approvedAmount,callback:function(a){e.$set(t,"approvedAmount",a)},expression:"attachment.approvedAmount"}})],1),a("div",{staticClass:"q-mx-sm"},[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:null!==t.status},on:{click:function(a){return e.onClickRejectPayment(t)}}}),a("br"),a("q-btn",{staticClass:"q-mt-xs",attrs:{label:"Approve",color:"positive",disable:null!==t.status},on:{click:function(a){return e.onClickApprovePayment(t)}}}),a("div")],1)],1)})),1)],1)]):e._e()]),a("q-card-section",[a("q-item-section",[a("q-input",{staticClass:"col q-pb-xs",attrs:{value:e.totalApprovedAmount,outlined:"","unmasked-value":"",prefix:"RM",label:"Total Approved Amount (RM)",disable:!0}})],1)],1),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Reject",color:"negative",disable:!e.isOrderPendingHQACApproval&&e.isDisabledReject},on:{click:e.onClickReject}}),e.isDisabledReject?a("q-tooltip",[e._v("\n          Remarks is required\n        ")]):e._e(),e.isOrderPendingHQACApproval?e._e():a("q-tooltip",[e._v("\n          Order is not pending HQAC approval\n        ")]),a("q-btn",{attrs:{label:"Submit Payment Slip",color:"positive",disable:!e.isOrderPendingHQACApproval},on:{click:e.onClickSubmit}}),e.isOrderPendingHQACApproval?e._e():a("q-tooltip",[e._v("\n          Order is not pending HQAC approval\n        ")])],1)],1)])],1)},Ha=[],Va={components:{ModalDialog:v},mixins:[x["a"]],data(){return{remarks:"",form:{},attachments:{},paymentSelections:[],selectedResetId:"",totalApprovedAmount:0}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isOrderPendingHQACApproval(){return this.form&&"Submitted"===this.form.status},isDisabledReject(){return!this.remarks.length},paymentOpts(){const e=ja["a"].all(),t=e.map(e=>{const t=[];return t.label=e.paymentDescription,t.value=e.uuid,t});return t}}),created(){this.$store.dispatch("GetAllPaymentOptions")},methods:{filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.paymentSelections=this.paymentOpts.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.paymentSelections=this.paymentOpts})},onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0]);const[t]=yield Fa["a"].query().withAll().whereId(e.form.uuid).get();e.attachments=t,e.paymentSelections=e.paymentOpts;for(let a=0;a<e.attachments.paymentAttachments.length;a++)null==e.attachments.paymentAttachments[a].approvedAmount&&(e.attachments.paymentAttachments[a].approvedAmount=0),e.totalApprovedAmount+=Math.ceil(parseFloat(e.attachments.paymentAttachments[a].approvedAmount))}))()},reset(){},onClickSubmit(){var e=this;return i()((function*(){try{e.$q.loading.show(),e.totalApprovedAmount=0;for(let a=0;a<e.attachments.paymentAttachments.length;a++)e.totalApprovedAmount+=Math.ceil(parseFloat(e.attachments.paymentAttachments[a].approvedAmount));const t=yield e.$store.dispatch("GetOrderIdFromCron",{orderId:e.tableSelection[0].uuid});e.reset(),e.$q.loading.hide(),e.$notify("success","Order submitted to Detailer"),e.tableSelection[0].uuid!==t[0].orderId?(yield e.$store.dispatch("FinalOrderConfirmationSubmitToDetailer",{orderId:e.tableSelection[0].uuid,totalApprovedAmount:e.totalApprovedAmount}),yield e.$store.dispatch("FinalOrderConfirmationCreateCronJob",{orderId:e.tableSelection[0].uuid,createType:"create",createDone:"N"}),yield e.$store.dispatch("FinalOrderConfirmationCreateCronJob",{orderId:e.tableSelection[0].uuid,createType:"update",createDone:"N"}),e.reset(),e.$q.loading.hide(),e.$notify("success","Order submitted to Detailer")):(e.$q.loading.hide(),e.$notify("error","Order Already Exist In Production Order"))}catch(t){console.log(t),e.$q.loading.hide(),e.$notify("error","Order state failed to be updated")}}))()},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},onClickReject(){var e=this;return i()((function*(){try{e.$q.loading.show(),e.$store.dispatch("FinalOrderConfirmationHQARejected",{orderId:e.tableSelection[0].uuid,remarks:e.remarks}),e.reset(),e.$q.loading.hide(),e.$notify("success","Order rejected and sent back to Branch Manager")}catch(t){e.$q.loading.hide(),e.$notify("error","Order state failed to be updated")}}))()},onClickRejectPayment(e){var t=this;return i()((function*(){try{t.$q.loading.show();const a={uuid:e.uuid,status:"Rejected",approvedAmount:0,orderId:t.tableSelection[0].uuid};yield t.$store.dispatch("FinalOrderConfirmationRejectedAttachment",a),t.$q.loading.hide(),t.$notify("success","Payment rejected")}catch(a){t.$q.loading.hide(),t.$notify("error","Payment state failed to be updated")}}))()},onClickApprovePayment(e){var t=this;return i()((function*(){try{t.$q.loading.show();const a={uuid:e.uuid,status:"Approved",approvedAmount:parseFloat(e.approvedAmount),orderId:t.tableSelection[0].uuid};yield t.$store.dispatch("FinalOrderConfirmationApprovedAttachment",a),t.$q.loading.hide(),t.$notify("success","Payment approved")}catch(a){t.$q.loading.hide(),t.$notify("error","Payment state failed to be updated")}}))()}}},Wa=Va,Xa=Object(b["a"])(Wa,Ka,Ha,!1,null,null,null),Za=Xa.exports,eo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"addExhibition"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Add Campaign\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onAddExhibition}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Add into Campaign List\n            ")]),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Campaign Name","lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),a("q-input",{staticClass:"q-pa-none",attrs:{value:e.convertedDate(e.form.startDate),label:"Start Date",filled:"",mask:"##/##/####"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{options:e.startDateOptions},model:{value:e.form.startDate,callback:function(t){e.$set(e.form,"startDate",t)},expression:"form.startDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("q-input",{staticClass:"q-pa-none",attrs:{value:e.convertedDate(e.form.endDate),label:"End Date",filled:"",mask:"##/##/####"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{options:e.endDateOptions},model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("q-input",{staticClass:"q-pa-none",attrs:{value:e.convertedDate(e.form.hideDate),label:"Hide Date",filled:"",mask:"##/##/####"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.hideDate,callback:function(t){e.$set(e.form,"hideDate",t)},expression:"form.hideDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit"},on:{click:e.onAddExhibition}})],1)],1)])],1)],1)])],1)},to=[],ao={components:{ModalDialog:v},data(){return{dialog:{show:!1,userId:""},form:{name:"",startDate:"",endDate:"",hideDate:""}}},created(){},methods:{reset(){this.form={name:"",startDate:"",endDate:"",hideDate:""}},onAddExhibition(){var e=this;return i()((function*(){const t=new Date(2017,2,5);console.log(t);const a=yield e.$store.dispatch("CheckExhibitionExist",e.form.name);a?e.$notify("error","A campaign with this name has already been created, please use a different campaign name"):e.$refs.myForm.validate().then(function(){var t=i()((function*(t){t?(e.$q.loading.show(),yield e.$store.dispatch("AddExhibition",e.form),e.$q.loading.hide(),e.$notify("success","Exhibition created!"),e.reset(),e.$refs.dialog.$children[0].hide()):(e.$q.loading.hide(),e.$notify("error","All field is required"))}));return function(e){return t.apply(this,arguments)}}())}))()},convertedDate(e){let t=e.split("/");return t=`${t[2]}/${t[1]}/${t[0]}`,t},startDateOptions(e){return""===this.form.endDate||e<this.form.endDate},endDateOptions(e){return""===this.form.startDate||e>this.form.startDate}}},oo=ao,so=Object(b["a"])(oo,eo,to,!1,null,null,null),ro=so.exports,io=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"deleteExhibition"}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Are you sure?\n      ")])]),a("q-card-section",{staticClass:"row items-center"},[e._v("\n      Do you really want to delete this\n      "),a("span",{staticClass:"text-weight-bold"},[e._v(e._s(e.tableSelection.length)+" record(s)")]),e._v(" ?\n    ")]),a("q-card-section",{staticClass:"row items-center text-negative text-weight-bold"},[e._v("\n      This process cannot be undone\n    ")]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Delete",color:"negative"},on:{click:e.onClickDelete}})],1)],1)],1)},lo=[],no={components:{ModalDialog:v},computed:n()({},Object(q["b"])(["datatabs","activeDataTab","tableSelection"])),methods:{onClickDelete(){var e=this;this.tableSelection.forEach(function(){var t=i()((function*(t){try{e.$q.loading.show(),yield e.$store.dispatch("DeleteExhibition",t.uuid),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Delete item successful!")}catch(a){const t=a.response.data.error.message;console.log(t),e.$q.loading.hide(),e.$notify("error","Error: "+t)}}));return function(e){return t.apply(this,arguments)}}()),this.$store.dispatch("OnTableSelection",[])}}},co=no,uo=Object(b["a"])(co,io,lo,!1,null,null,null),mo=uo.exports,po=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"downloadMissingItem"},on:{"show-dialog":e.onShowDialog,"close-dialog":e.reset}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Download Missing Item List\n      ")])]),a("q-card-section",[a("q-form",{staticClass:"q-gutter-sm justify"},[a("q-select",{staticClass:"col q-pb-none",attrs:{clearable:"",outlined:"",label:"Drawing Number","emit-value":"","map-options":"","stack-label":"","lazy-rules":"","use-input":"","input-debounce":"0",rules:[e.onDrawingCheck],error:e.errorMessageDrawingNum.length>0,options:e.drawingNumberOptions},on:{filter:e.filterDrawing},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                No results\n              ")])],1)]},proxy:!0}]),model:{value:e.form.drawingNumber,callback:function(t){e.$set(e.form,"drawingNumber",t)},expression:"form.drawingNumber"}},[e.errorMessageDrawingNum.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n              "+e._s(e.errorMessageDrawingNum)+"\n            ")])]):e._e()],1)],1)],1),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Download",icon:"fas fa-file-csv",color:"positive",disabled:e.errorMessageQuotationNum.length>0||e.errorMessageDrawingNum.length>0},on:{click:e.onClickDownload}})],1)],1)],1)},ho=[],fo={components:{ModalDialog:v},mixins:[x["a"]],data(){return{csv:"",errorMessageQuotationNum:"",errorMessageDrawingNum:"",form:{quotationNumber:"",drawingNumber:""},quotationNumberOptions:[],drawingNumberOptions:[],drawingNumList:[]}},validations:{form:{quotationNumber:{required:M["required"]},drawingNumber:{required:M["required"]}}},computed:{},methods:{onShowDialog(){var e=this;return i()((function*(){e.$q.loading.show();const t=yield e.getDrawingList();e.drawingNumList=t,e.drawingNumberOptions=e.drawingNumList,e.$q.loading.hide()}))()},getDrawingList(){var e=this;return i()((function*(){const t=yield e.$repository.lead.getDrawings(),a=t.data.map(e=>e.drawingNumber);return a}))()},compareFn(e,t){return e.name<t.name?-1:e.name>t.name?1:0},getSortedData(e){let t=e.filter(e=>e.drawingNumber===this.form.drawingNumber);return t.sort(this.compareFn),t=t.map((e,t)=>n()({itemNo:t+1},e)),t.unshift(e[0]),t},onClickDownload(){var e=this;return i()((function*(){e.$q.loading.show();var t="export_missing_items.csv";let a=yield e.$store.dispatch("GetAllMissingItems");a=a.map(e=>e.getBodyRequest),a.unshift({itemNo:"itemNo",name:"Name",brandGoodName:"brandGoodName",productNumber:"productNumber",drawingNumber:"drawingNumber"}),e.csv=Object(j["f"])(e.getSortedData(a));var o=new Blob([e.csv],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");if(void 0!==s.download){var r=URL.createObjectURL(o);s.setAttribute("href",r),s.setAttribute("download",t),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}e.$q.loading.hide()}))()},onQuotationCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.quotationNumber<=0?e.errorMessageQuotationNum="Field cant be blank":e.errorMessageQuotationNum=""}))()},onDrawingCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.drawingNumber<=0?e.errorMessageDrawingNum="Field cant be blank":e.errorMessageDrawingNum=""}))()},filterDrawing(e,t){t(""!==e?()=>{const t=e;this.drawingNumberOptions=this.drawingNumList.filter(e=>e.toString().indexOf(t)>-1)}:()=>{this.drawingNumberOptions=this.drawingNumList})},reset(){this.form={quotationNumber:"",drawingNumber:""}}}},go=fo,bo=Object(b["a"])(go,po,ho,!1,null,null,null),yo=bo.exports,vo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"downloadCalculationLog"},on:{"show-dialog":e.onShowDialog,"close-dialog":e.reset}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Download Calculation Log CSV File\n      ")])]),a("q-card-section",[a("q-form",{staticClass:"q-gutter-sm justify"},[a("q-select",{staticClass:"col q-pb-none",attrs:{clearable:"",outlined:"",label:"Drawing Number","emit-value":"","map-options":"","stack-label":"","lazy-rules":"","lazy-load":"","use-input":"","input-debounce":"0",rules:[e.onDrawingCheck],error:e.errorMessageDrawingNum.length>0,options:e.drawingNumberOptions},on:{filter:e.filterDrawing},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                No results\n              ")])],1)]},proxy:!0}]),model:{value:e.form.drawingNumber,callback:function(t){e.$set(e.form,"drawingNumber",t)},expression:"form.drawingNumber"}},[e.errorMessageDrawingNum.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n              "+e._s(e.errorMessageDrawingNum)+"\n            ")])]):e._e()],1)],1)],1),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Download",icon:"fas fa-file-csv",color:"positive",disabled:e.errorMessageQuotationNum.length>0||e.errorMessageDrawingNum.length>0},on:{click:e.onClickDownload}})],1)],1)],1)},qo=[],xo={components:{ModalDialog:v},mixins:[x["a"]],data(){return{csv:"",errorMessageQuotationNum:"",errorMessageDrawingNum:"",form:{quotationNumber:"",drawingNumber:""},quotationNumberOptions:[],drawingNumberOptions:[],drawingNumList:[]}},validations:{form:{quotationNumber:{required:M["required"]},drawingNumber:{required:M["required"]}}},methods:{onShowDialog(){var e=this;return i()((function*(){e.$q.loading.show();const t=yield e.$repository.lead.getDrawings(),a=t.data.map(e=>e.drawingNumber);e.drawingNumList=a,e.drawingNumberOptions=e.drawingNumList,e.drawingNumberOptions=e.drawingNumList,e.$q.loading.hide()}))()},getDrawingList(){var e=this;return i()((function*(){const t=yield e.$repository.lead.getDrawings(),a=t.data.map(e=>e.drawingNumber);return a}))()},compareFn(e,t){const a=e.split("-"),o=t.split("-"),s=a.shift(),r=o.shift(),i=parseInt(s),l=parseInt(r);return i===l?0===a.length&&0===o.length?0:0===a.length?-1:0===o.length?1:this.compareFn(a.join("-"),o.join("-")):i>l?1:i<l?-1:void 0},getSortedData(e){let t=e.filter(e=>e.drawingNumber===this.form.drawingNumber);return t.sort((e,t)=>this.compareFn(e.itemId,t.itemId)),t=t.map((e,t)=>n()({itemNo:t+1},e)),t.unshift(e[0]),t},onClickDownload(){var e=this;return i()((function*(){e.$q.loading.show();var t="export_calculation_logs.csv";let a=yield e.$store.dispatch("GetAllCalculationLogs");a=a.map(e=>e.getBodyRequest),a.unshift({itemNo:"itemNo",uuid:"UUID",drawingNumber:"drawingNumber",kujialeSequenceId:"kujialeSequenceId",itemId:"itemId",parentItemId:"parentItemId",name:"Name",brandGoodName:"brandGoodName",brandGoodCode:"brandGoodCode",material:"material",colour:"colour",profile:"profile",width:"width",height:"height",depth:"depth",totalItemProcessCost:"totalItemProcessCost",ccost:"ccost",stdCost:"stdCost",markupRate:"markupRate",nonStdRate:"nonStdRate",totalCost:"totalCost",rrp:"rrp",quantity:"quantity"}),e.csv=Object(j["f"])(e.getSortedData(a));var o=new Blob([e.csv],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");if(void 0!==s.download){var r=URL.createObjectURL(o);s.setAttribute("href",r),s.setAttribute("download",t),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}e.$q.loading.hide()}))()},onQuotationCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.quotationNumber<=0?e.errorMessageQuotationNum="Field cant be blank":e.errorMessageQuotationNum=""}))()},onDrawingCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.drawingNumber<=0?e.errorMessageDrawingNum="Field cant be blank":e.errorMessageDrawingNum=""}))()},filterDrawing(e,t){t(""!==e?()=>{const t=e;this.drawingNumberOptions=this.drawingNumList.filter(e=>e.toString().indexOf(t)>-1)}:()=>{this.drawingNumberOptions=this.drawingNumList})},reset(){this.form={quotationNumber:"",drawingNumber:""}}}},Co=xo,wo=Object(b["a"])(Co,vo,qo,!1,null,null,null),ko=wo.exports,_o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"pendingQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Are you sure?\n      ")])]),a("q-card-section",{staticClass:"row items-center"},[e._v("\n      Change lead status to Follow Up?\n    ")]),a("q-card-section",{staticClass:"row items-center text-negative text-weight-bold"},[e._v("\n      This process cannot be undone\n    ")]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Submit",color:"positive",disable:e.isBtnDisabled},on:{click:e.onClickDelete}}),e.isBtnDisabled?a("q-tooltip",[e._v("\n          Lead status is not Assigned\n        ")]):e._e()],1)],1)],1)],1)},So=[],Ao={components:{ModalDialog:v},data(){return{form:{}}},computed:n()(n()({},Object(q["b"])(["datatabs","activeDataTab","tableSelection"])),{},{isBtnDisabled(){return"Assigned"!==this.form.status}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0])}))()},onClickDelete(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("PendingVisitQualifiedLead",e.form),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Lead updated successfully!")}catch(t){console.log(t);const a=t.response.data.error.message;e.$q.loading.hide(),e.$notify("error","Error: "+a)}e.$store.dispatch("OnTableSelection",[])}))()},reset(){this.form={}}}},Mo=Ao,Io=Object(b["a"])(Mo,_o,So,!1,null,null,null),$o=Io.exports,Do=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"leadLost"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Lost Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-center text-grey-8"},[e._v('\n          Set Lead status to "Lost"?\n        ')])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Select Reason\n        ")]),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.rejectlist,label:"Reason","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.lostReason,callback:function(t){e.$set(e.form,"lostReason",t)},expression:"form.lostReason"}})],1),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Remarks\n        ")]),a("q-input",{attrs:{filled:"",type:"textarea"},model:{value:e.form.lostRemark,callback:function(t){e.$set(e.form,"lostRemark",t)},expression:"form.lostRemark"}})],1),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"Yes",color:"primary"},on:{click:e.onSetLeadToLost}})],1)])])],1)])],1)},To=[],Oo={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{},rejectlist:[]}},computed:n()({},Object(q["b"])(["tableSelection"])),watch(){var e=this;return i()((function*(){yield e.getAllRejectionReason()}))()},created(){var e=this;return i()((function*(){yield e.getAllRejectionReason()}))()},methods:{onShowDialog(){this.form=n()({},this.tableSelection[0]),this.selectedLeadId=this.form.uuid},onSetLeadToLost(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("UpdateLead",{uuid:e.selectedLeadId,status:"Lost",lostReason:e.form.lostReason,lostRemark:e.form.lostRemark}),yield e.$store.dispatch("GetDesignLeads",{}),e.$q.loading.hide(),e.$notify("success","Successfully set lead status to Lost"),e.$refs.dialog.$children[0].hide()}catch(t){console.log(t),e.$q.loading.hide(),e.$notify("error","Error")}}))()},getAllRejectionReason(){var e=this;return i()((function*(){try{const t=yield e.$store.dispatch("GetAllRejectionReason");t.forEach(t=>{"Proposal Lost"===t.reasonCategory&&e.rejectlist.push(t.reasonTitle)})}catch(t){}}))()},reset(){this.selectedLeadId="",this.form={}}}},No=Oo,Ro=Object(b["a"])(No,Do,To,!1,null,null,null),Fo=Ro.exports,jo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"cancelOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Cancel Order Confirmation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Are you sure you want to cancel the selected order?\n          ")]),a("q-separator",{staticClass:"q-my-md"})],1)]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Select Reason\n        ")]),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.rejectlist,label:"Reason","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.cancelReason,callback:function(t){e.$set(e.form,"cancelReason",t)},expression:"form.cancelReason"}})],1),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Remarks\n        ")]),a("q-input",{attrs:{filled:"",type:"textarea"},model:{value:e.form.cancelRemark,callback:function(t){e.$set(e.form,"cancelRemark",t)},expression:"form.cancelRemark"}})],1),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"No"}}),a("q-btn",{attrs:{label:"Cancel",color:"negative"},on:{click:e.onClickCancel}})],1)],1)])],1)},Lo=[],Eo={components:{ModalDialog:v},data(){return{form:{},rejectlist:[]}},computed:n()({},Object(q["b"])(["tableSelection"])),watch(){var e=this;return i()((function*(){yield e.getAllRejectionReason()}))()},created(){var e=this;return i()((function*(){yield e.getAllRejectionReason()}))()},methods:{onShowDialog(){var e=this;return i()((function*(){const[t]=e.tableSelection;e.form=t}))()},onSetLeadToLost(){var e=this;return i()((function*(){try{yield e.$store.dispatch("UpdateLead",{uuid:e.selectedLeadId,status:"Lost",cancelReason:e.form.cancelReason,cancelRemark:e.form.cancelRemark}),e.$notify("success","Successfully set lead status to Lost"),e.$refs.dialog.$children[0].hide()}catch(t){console.log(t),e.$notify("error","Error")}}))()},getAllRejectionReason(){var e=this;return i()((function*(){try{const t=yield e.$store.dispatch("GetAllRejectionReason");t.forEach(t=>{"Disqualify Leads"===t.reasonCategory&&e.rejectlist.push(t.reasonTitle)})}catch(t){}}))()},reset(){this.form={}},onClickCancel(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("UpdateFCO",{uuid:e.form.uuid,status:"Cancelled",cancelReason:e.form.cancelReason,cancelRemark:e.form.cancelRemark}),e.$q.loading.hide(),e.$notify("success","Sucessfully cancelled order."),e.$refs.dialog.$children[0].hide()}catch(t){console.log(t),e.$q.loading.hide(),e.$notify("error","Error updating order state.")}}))()}}},Po=Eo,Uo=Object(b["a"])(Po,jo,Lo,!1,null,null,null),Bo=Uo.exports,zo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewCampaign"},on:{"show-dialog":e.onShowDialog,"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          View/Edit Campaign\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onAddExhibition}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Edit Campaign List\n            ")]),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Campaign Name","lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),a("q-input",{staticClass:"q-pa-none",attrs:{label:"Start Date",filled:"",mask:"date",rules:["date"]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.startDate,callback:function(t){e.$set(e.form,"startDate",t)},expression:"form.startDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.startDate,callback:function(t){e.$set(e.form,"startDate",t)},expression:"form.startDate"}}),a("q-input",{staticClass:"q-pa-none",attrs:{label:"End Date",filled:"",mask:"date",rules:["date"]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}}),a("q-input",{staticClass:"q-pa-none",attrs:{label:"Hide Date",filled:"",mask:"date",rules:["date"]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.hideDate,callback:function(t){e.$set(e.form,"hideDate",t)},expression:"form.hideDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.hideDate,callback:function(t){e.$set(e.form,"hideDate",t)},expression:"form.hideDate"}}),a("q-separator"),"sysadmin"===e.roles[0]||"branchManager"===e.roles[0]||"hQManager"===e.roles[0]?a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit"},on:{click:e.onAddExhibition}})],1):e._e()],1)])],1)],1)])],1)},Go=[],Qo={components:{ModalDialog:v},data(){return{dialog:{show:!1,userId:""},form:{name:"",startDate:"",endDate:"",hideDate:""}}},computed:n()({},Object(q["b"])(["tableSelection","roles"])),created(){},methods:{reset(){this.form={name:"",startDate:"",endDate:"",hideDate:""}},onShowDialog(){this.form=n()({},this.tableSelection[0]),console.log(this.form),console.log(this.roles[0])},onAddExhibition(){var e=this;return i()((function*(){e.$refs.myForm.validate().then(function(){var t=i()((function*(t){t?(e.$q.loading.show(),yield e.$store.dispatch("UpdateExhibition",e.form),e.$q.loading.hide(),e.$notify("success","Exhibition updated!"),e.reset(),e.$refs.dialog.$children[0].hide()):(e.$q.loading.hide(),e.$notify("error","All field is required"))}));return function(e){return t.apply(this,arguments)}}())}))()}}},Yo=Qo,Jo=Object(b["a"])(Yo,zo,Go,!1,null,null,null),Ko=Jo.exports,Ho=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},["ServiceReport"===e.form.type?a("div",{staticClass:"text-white text-h6"},[e._v("\n          Service Report\n        ")]):e._e(),"MaintenanceReport"===e.form.type?a("div",{staticClass:"text-white text-h6"},[e._v("\n          Repair Maintenance\n        ")]):e._e()]),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-uppercase text-grey-7"},[e._v("\n        Report Details\n      ")]),e.form.jobNumber?a("q-chip",{staticClass:"q-ml-md q-my-sm",attrs:{square:"","text-color":"white"}},[e._v("\n        "+e._s(e.form.jobNumber.split(" ")[0])+"\n        "),a("q-tooltip",[e._v("Job Number")])],1):e._e(),a("q-separator",{staticClass:"q-my-md"}),"salesconsultant"===e.roles[0]||"sysadmin"===e.roles[0]?a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-grey-7"},[e._v("\n        Sales Consultant Remarks\n        "),a("q-input",{staticClass:"q-ma-md",attrs:{filled:"",type:"textarea"},model:{value:e.form.remarksSalesConsultant,callback:function(t){e.$set(e.form,"remarksSalesConsultant",t)},expression:"form.remarksSalesConsultant"}}),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Update Remarks"},on:{click:e.onClickUpdateRemarksSalesConsultant}})],1),a("q-separator",{staticClass:"q-my-md"})],1):e._e(),"Rejected"===e.form.state?a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-grey-7"},[e._v("\n        Rejected Remarks\n        "),a("q-input",{staticClass:"q-ma-md",attrs:{filled:"",disable:"",type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}}),a("q-separator",{staticClass:"q-my-md"})],1):e._e(),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-grey-7"},[e._v("\n        Attachments\n      ")]),a("div",{staticClass:"q-ma-md"},[a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload",color:"teal",multiple:""},on:{uploaded:e.fileUploaded}})],1),e.attachments?a("q-list",{staticClass:"q-ma-md",attrs:{bordered:""}},e._l(e.attachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{size:"sm",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v(e._s(t.fileName))])],1)})),1):e._e(),a("q-card-actions",{attrs:{align:"right"}},["detailer"!==e.roles[0]&&"sysadmin"!==e.roles[0]||"Closed"===e.form.state?e._e():a("q-btn",{attrs:{color:"secondary",label:"Edit Report"},on:{click:e.onClickEditReport}}),a("q-btn",{attrs:{color:"primary",label:"View Report"},on:{click:e.generatePdf}})],1)],1)])],1)},Vo=[],Wo={components:{ModalDialog:v},data(){return{statusColour:{New:"success",Rejected:"negative",Detailer:"secondary"},selection:{},form:{},items:[],title:"",attachments:[]}},computed:n()(n()({},Object(q["b"])(["tableSelection","roles"])),{},{fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.selection=e.$store.getters.tableSelection[0],e.form=n()({},e.selection),e.reportId=e.form.uuid;const{data:t}=yield e.$repository.serviceReport.getById(e.reportId,{include:[{relation:"attachments"}]});e.attachments=t.attachments}))()},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const[{name:o}]=e;try{const{files:e}=JSON.parse(t.response),[{name:s}]=e[o],r=a.reportId;if(!s)throw new Error;yield a.$repository.serviceReport.addAttachment(r,s,o);const{data:i}=yield a.$repository.serviceReport.getById(a.reportId,{include:[{relation:"attachments"}]});a.attachments=i.attachments,a.$notify("success","File upload success")}catch(s){a.$notify("error","Error uploading attachment "+o)}}))()},onClickEditReport(){const{uuid:e}=this.selection,t=this.$router.resolve({path:"service-report/"+e});window.open(t.href,"_blank")},onClickUpdateRemarksSalesConsultant(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$repository.serviceReport.updateById(e.reportId,{remarksSalesConsultant:e.form.remarksSalesConsultant}),e.$q.loading.hide(),e.$notify("success","Remarks Updated")}catch(t){e.$q.loading.hide(),e.$notify("negative","Remarks failed to be updated")}}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===ca["vfs"]&&(ca["vfs"]=ua["pdfMake"].vfs);const{data:a}=yield e.$repository.lead.getById(e.form.leadId),{data:o}=yield e.$repository.user.getById(e.form.userId),{data:s}=yield e.$repository.branch.getById(o.branchId);if("MaintenanceReport"===e.form.type?e.title="Repair Maintenance Quotation(MR)":e.title="Service Report Quotation(SR)","factory"===e.roles[0]||"sysadmin"===e.roles[0]){const i=[];if(i.push([{text:"QTY",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"MODEL",alignment:"center",style:"headerTitle"},{text:"DESCRIPTION",style:"headerTitle",alignment:"center"},{text:"WIDTH",style:"headerTitle",alignment:"center"},{text:"HEIGHT",style:"headerTitle",alignment:"center"},{text:"DEPTH",style:"headerTitle",alignment:"center"},{text:"MATERIAL",style:"headerTitle",alignment:"center"},{text:"COLOUR",style:"headerTitle",alignment:"center"},{text:"PROFILE",style:"headerTitle",alignment:"center"}]),e.form.items.length>0)for(const t of e.form.items)i.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:t.item.uom,alignment:"center",style:"headerTitle"},{text:t.item.itemcode,alignment:"center",style:"headerTitle"},{text:t.item.name,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material.material,alignment:"center",style:"headerTitle"},{text:t.material.colour,alignment:"center",style:"headerTitle"},{text:t.material.profile,alignment:"center",style:"headerTitle"}]);if(e.form.customItems.length>0)for(const t of e.form.customItems)i.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:"Unit",alignment:"center",style:"headerTitle"},{text:"-",alignment:"center",style:"headerTitle"},{text:t.item,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material,alignment:"center",style:"headerTitle"},{text:t.colour,alignment:"center",style:"headerTitle"},{text:t.profile,alignment:"center",style:"headerTitle"}]);i.push([{text:"Remarks:  "+e.form.remarks,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{}]),i.push([{text:"Remarks SC:  "+e.form.remarksSalesConsultant,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{}]);var r={images:{logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACB1BMVEUdHRscHBofHx0XFxUlJSPNzc3////9/f3+/v78/Pzf3944ODYYGBYeHhwhIR8MDApYWFaUlJMREQ8bGxkuLiwZGRYgIB7AwMDn5+dCQkETExFDQ0Lo6OiLi4oQEA4vLy0eHh0aGhe8vLz7+/vs7OxEREMSEhA/Pz2Hh4YxMS8aGhi0tLPx8fFMTEogIB84ODfi4uJ6enkfHxysrKz09PRSUlEPDw0UFBIzMzLc3NyPj44VFROlpaT29vZZWVfW1tadnZz5+flgYF8PDwwWFhQqKijQ0M+VlZRnZ2YODgwmJiTJycmOjo1vb24ZGRciIiDDw8Lj4+JKSkizs7N3d3Xp6elFRUQLCwkjIyENDQt+fnx+fn21tbXt7e3KysmGhoUYGBWwsK/9/fzy8vJRUU8QEA0nJyWoqKjQ0NCWlpWhoaD6+vpfX10pKSjV1dWZmZhmZmXNzcyRkZD8/PttbWwODgvGxsasrKuJiYh1dXTAwL8bGxiCgoF9fXy5ubi7u7uFhYSysrFzc3KNjYyqqqn39/eMjItra2qkpKN0dHOKiolkZGOcnJthYV+AgH9dXVz4+PhsbGsyMjBycnD19fWrq6qMjIxzc3GxsbC4uLeCgoC+vr6bm5rFxcWQkI8SEg/MzMsmJiVmZmSYmJfT09IrKyleXlygoJ/U1NRaWllAQD8WFhNNTUvAqG3jAAAAAWJLR0QGYWa4fQAAAAlwSFlzAAASdAAAEnQB3mYfeAAAAAd0SU1FB+YIHgI1LB8SQ2kAAAKaSURBVDjLPZPpW9NAEIc3qU422nC0GLBqqkQrFjxQTNUWpVLFIIKCSiuIF4r3BSioKB4o3veN4o3XH+nMbB77Kc/zzu7O+5upEOqn6aFp08GQYMKMmWFLaEXFJaURK1r2n8+yy8EkXjE7pmuaHZkzF+Y5Wjzg8xeISnCJL1zk2MgTiyvAhariJYpb0WQ1cQNqljrLkMeWr8D7TKhdGfDQKsXrVntFyFNr1uJlIKW7jrmWzihev96j8+n4BrwfuZQGcRFrYC6zGxvxfT23aTNxwzAACzRhRZoUd7f4NvqEm7cyhzoTK4SwnBbmhrGNeWvbduIm7GjvwA+he1XkLw3YyTxpVSq+a3dnvhxcUdjD3ISuRp18ot2K72138qF8D4guyhf5Po/5/gP03kE41HvYxnaO9AhXMm9xLPbtC3xLPPaJHxV03oVjEYt9jyt+4qTP/NRpEMwbEsIi3zPK1zzL/Yaaz2GTxDMpjbhzHvrJVw4Mch5tF0gT+cVcFLneOBT4Dhc4D/0Scilc6Gi9TNy/EviODOqUR/Qqz0PAtWhS14RdqA34qM++4evUD86iOx9mfgNoNibc5Dy03C3V75i47eGDduEO834o5TxEajzYn7sC7hX0osJ9E5vDfh8kLAt5Ipi/+VAIAx453uMnwHw8xnk4TdSPIeXTzmcCTz7vfaH4yxzloXuvAt/XvlUmcBT1NYq/CXMe3mjgUztoJ8twFpJ2C53fsq/ujwT8HfpigcQKSfw9Zoe+/nAw/yH0pYIJqkf+oY3z8Ad4V134SL5UMDmBRi58+hxi/sVVvl8niVOBlspAFr59z9Ef0v+RlZznFPtyAabaBz/jaVqQyK8x8jEgk9aY8w1Wqz71O2JjPn/+sq8J1eyrCv4BVZVzssZYsOsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDgtMzBUMDI6NTM6MjErMDA6MDBmmUewAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA4LTMwVDAyOjUzOjIxKzAwOjAwF8T/DAAAAABJRU5ErkJggg=="},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:e.title,style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",a.name],["Customer Tel No",":",a.phone],["Customer Address",":",a.siteAddress],["Job No",":",e.form.jobNumber]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(o.updatedAt,"DD MMM YYYY")],["Branch Code",":",s.code],["SC Name",":",o.name],["SC Tel No",":",o.mobile],["Installer",":",e.form.installer],["Date Installed",":",t(e.form.installedDate,"DD MMM YYYY")]]},layout:"noBorders",alignment:"right"}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:[20,25,30,"*","*",30,30,30,40,60,60],body:i}}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0,fontSize:8},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"landscape"};ca["createPdf"](r).open()}if("purchaser"===e.roles[0]||"logistic"===e.roles[0]||"detailer"===e.roles[0]||"salesconsultant"===e.roles[0]||"sysadmin"===e.roles[0]){const r=[];let l=0;if(r.push([{text:"QTY",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"MODEL",alignment:"center",style:"headerTitle"},{text:"DESCRIPTION",style:"headerTitle",alignment:"center"},{text:"WIDTH",style:"headerTitle",alignment:"center"},{text:"HEIGHT",style:"headerTitle",alignment:"center"},{text:"DEPTH",style:"headerTitle",alignment:"center"},{text:"MATERIAL",style:"headerTitle",alignment:"center"},{text:"COLOUR",style:"headerTitle",alignment:"center"},{text:"PROFILE",style:"headerTitle",alignment:"center"},{text:"U/PRICE",style:"headerTitle",alignment:"center"},{text:"AMOUNT",style:"headerTitle",alignment:"center"}]),e.form.items.length>0)for(const t of e.form.items)r.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:t.item.uom,alignment:"center",style:"headerTitle"},{text:t.item.itemcode,alignment:"center",style:"headerTitle"},{text:t.item.name,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material.material,alignment:"center",style:"headerTitle"},{text:t.material.colour,alignment:"center",style:"headerTitle"},{text:t.material.profile,alignment:"center",style:"headerTitle"},{text:t.material.price.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.quantity).toFixed(2),alignment:"center",style:"headerTitle"}]),l=parseFloat(l+t.material.price*t.quantity);if(e.form.customItems.length>0)for(const t of e.form.customItems)r.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:"Unit",alignment:"center",style:"headerTitle"},{text:"-",alignment:"center",style:"headerTitle"},{text:t.item,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material,alignment:"center",style:"headerTitle"},{text:t.colour,alignment:"center",style:"headerTitle"},{text:t.profile,alignment:"center",style:"headerTitle"},{text:t.unitPrice.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.unitPrice*t.quantity).toFixed(2),alignment:"center",style:"headerTitle"}]),l=parseFloat(l)+t.amount;r.push([{text:"Remarks:  "+e.form.remarks,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{},{},{}]),r.push([{text:"Remarks SC:  "+e.form.remarksSalesConsultant,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{},"Total",{text:l.toFixed(2),alignment:"center",style:"headerTitle"}]);var i={images:{logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACB1BMVEUdHRscHBofHx0XFxUlJSPNzc3////9/f3+/v78/Pzf3944ODYYGBYeHhwhIR8MDApYWFaUlJMREQ8bGxkuLiwZGRYgIB7AwMDn5+dCQkETExFDQ0Lo6OiLi4oQEA4vLy0eHh0aGhe8vLz7+/vs7OxEREMSEhA/Pz2Hh4YxMS8aGhi0tLPx8fFMTEogIB84ODfi4uJ6enkfHxysrKz09PRSUlEPDw0UFBIzMzLc3NyPj44VFROlpaT29vZZWVfW1tadnZz5+flgYF8PDwwWFhQqKijQ0M+VlZRnZ2YODgwmJiTJycmOjo1vb24ZGRciIiDDw8Lj4+JKSkizs7N3d3Xp6elFRUQLCwkjIyENDQt+fnx+fn21tbXt7e3KysmGhoUYGBWwsK/9/fzy8vJRUU8QEA0nJyWoqKjQ0NCWlpWhoaD6+vpfX10pKSjV1dWZmZhmZmXNzcyRkZD8/PttbWwODgvGxsasrKuJiYh1dXTAwL8bGxiCgoF9fXy5ubi7u7uFhYSysrFzc3KNjYyqqqn39/eMjItra2qkpKN0dHOKiolkZGOcnJthYV+AgH9dXVz4+PhsbGsyMjBycnD19fWrq6qMjIxzc3GxsbC4uLeCgoC+vr6bm5rFxcWQkI8SEg/MzMsmJiVmZmSYmJfT09IrKyleXlygoJ/U1NRaWllAQD8WFhNNTUvAqG3jAAAAAWJLR0QGYWa4fQAAAAlwSFlzAAASdAAAEnQB3mYfeAAAAAd0SU1FB+YIHgI1LB8SQ2kAAAKaSURBVDjLPZPpW9NAEIc3qU422nC0GLBqqkQrFjxQTNUWpVLFIIKCSiuIF4r3BSioKB4o3veN4o3XH+nMbB77Kc/zzu7O+5upEOqn6aFp08GQYMKMmWFLaEXFJaURK1r2n8+yy8EkXjE7pmuaHZkzF+Y5Wjzg8xeISnCJL1zk2MgTiyvAhariJYpb0WQ1cQNqljrLkMeWr8D7TKhdGfDQKsXrVntFyFNr1uJlIKW7jrmWzihev96j8+n4BrwfuZQGcRFrYC6zGxvxfT23aTNxwzAACzRhRZoUd7f4NvqEm7cyhzoTK4SwnBbmhrGNeWvbduIm7GjvwA+he1XkLw3YyTxpVSq+a3dnvhxcUdjD3ISuRp18ot2K72138qF8D4guyhf5Po/5/gP03kE41HvYxnaO9AhXMm9xLPbtC3xLPPaJHxV03oVjEYt9jyt+4qTP/NRpEMwbEsIi3zPK1zzL/Yaaz2GTxDMpjbhzHvrJVw4Mch5tF0gT+cVcFLneOBT4Dhc4D/0Scilc6Gi9TNy/EviODOqUR/Qqz0PAtWhS14RdqA34qM++4evUD86iOx9mfgNoNibc5Dy03C3V75i47eGDduEO834o5TxEajzYn7sC7hX0osJ9E5vDfh8kLAt5Ipi/+VAIAx453uMnwHw8xnk4TdSPIeXTzmcCTz7vfaH4yxzloXuvAt/XvlUmcBT1NYq/CXMe3mjgUztoJ8twFpJ2C53fsq/ujwT8HfpigcQKSfw9Zoe+/nAw/yH0pYIJqkf+oY3z8Ad4V134SL5UMDmBRi58+hxi/sVVvl8niVOBlspAFr59z9Ef0v+RlZznFPtyAabaBz/jaVqQyK8x8jEgk9aY8w1Wqz71O2JjPn/+sq8J1eyrCv4BVZVzssZYsOsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDgtMzBUMDI6NTM6MjErMDA6MDBmmUewAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA4LTMwVDAyOjUzOjIxKzAwOjAwF8T/DAAAAABJRU5ErkJggg=="},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:e.title,style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",a.name],["Customer Tel No",":",a.phone],["Customer Address",":",a.siteAddress],["Job No",":",e.form.jobNumber]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(o.updatedAt,"DD MMM YYYY")],["Branch Code",":",s.code],["SC Name",":",o.name],["SC Tel No",":",o.mobile],["Installer",":",e.form.installer],["Date Installed",":",t(e.form.installedDate,"DD MMM YYYY")]]},layout:"noBorders",alignment:"right"}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:[20,25,30,"*","*",30,30,30,40,35,60,40,40],body:r}}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0,fontSize:8},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"landscape"};ca["createPdf"](i).open()}if("hQAccountant"===e.roles[0]||"sysadmin"===e.roles[0]){var l=[],n=0,d=0,c=0;if(l.push([{text:"QTY",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"MODEL",alignment:"center",style:"headerTitle"},{text:"DESCRIPTION",style:"headerTitle",alignment:"center"},{text:"WIDTH",style:"headerTitle",alignment:"center"},{text:"HEIGHT",style:"headerTitle",alignment:"center"},{text:"DEPTH",style:"headerTitle",alignment:"center"},{text:"MATERIAL",style:"headerTitle",alignment:"center"},{text:"COLOUR",style:"headerTitle",alignment:"center"},{text:"PROFILE",style:"headerTitle",alignment:"center"},{text:"U/PRICE",style:"headerTitle",alignment:"center"},{text:"AMOUNT",style:"headerTitle",alignment:"center"},{text:"DEALER PRICE",style:"headerTitle",alignment:"center"},{text:"SM PRICE",style:"headerTitle",alignment:"center"}]),e.form.items.length>0)for(const t of e.form.items)l.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:t.item.uom,alignment:"center",style:"headerTitle"},{text:t.item.itemcode,alignment:"center",style:"headerTitle"},{text:t.item.name,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material.material,alignment:"center",style:"headerTitle"},{text:t.material.colour,alignment:"center",style:"headerTitle"},{text:t.material.profile,alignment:"center",style:"headerTitle"},{text:t.material.price.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.quantity).toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.item.dealerprice).toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.item.SMPrice).toFixed(2),alignment:"center",style:"headerTitle"}]),n=parseFloat(n+t.material.price*t.quantity),d=parseFloat(d+t.material.price*t.item.dealerprice),c=parseFloat(c+t.material.price*t.item.SMPrice);if(e.form.customItems.length>0){console.log("here",n);for(const t of e.form.customItems)l.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:"Unit",alignment:"center",style:"headerTitle"},{text:"-",alignment:"center",style:"headerTitle"},{text:t.item,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material,alignment:"center",style:"headerTitle"},{text:t.colour,alignment:"center",style:"headerTitle"},{text:t.profile,alignment:"center",style:"headerTitle"},{text:t.unitPrice.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.unitPrice*t.quantity).toFixed(2),alignment:"center",style:"headerTitle",colSpan:3}]),n=parseFloat(n)+t.amount,d=parseFloat(d)+t.amount,c=parseFloat(c)+t.amount}l.push([{text:"Remarks:  "+e.form.remarks,colSpan:11,bold:!0},{},{},{},{},{},{},{},{},{},{},{},{},{}]),l.push([{text:"Remarks SC:  "+e.form.remarksSalesConsultant,colSpan:11,bold:!0},{},{},{},{},{},{},{},{},{},{},"Total",{text:n.toFixed(2),alignment:"center",style:"headerTitle"},{text:d.toFixed(2),alignment:"center",style:"headerTitle"},{text:c.toFixed(2),alignment:"center",style:"headerTitle"}]);var u={images:{logo:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAACB1BMVEUdHRscHBofHx0XFxUlJSPNzc3////9/f3+/v78/Pzf3944ODYYGBYeHhwhIR8MDApYWFaUlJMREQ8bGxkuLiwZGRYgIB7AwMDn5+dCQkETExFDQ0Lo6OiLi4oQEA4vLy0eHh0aGhe8vLz7+/vs7OxEREMSEhA/Pz2Hh4YxMS8aGhi0tLPx8fFMTEogIB84ODfi4uJ6enkfHxysrKz09PRSUlEPDw0UFBIzMzLc3NyPj44VFROlpaT29vZZWVfW1tadnZz5+flgYF8PDwwWFhQqKijQ0M+VlZRnZ2YODgwmJiTJycmOjo1vb24ZGRciIiDDw8Lj4+JKSkizs7N3d3Xp6elFRUQLCwkjIyENDQt+fnx+fn21tbXt7e3KysmGhoUYGBWwsK/9/fzy8vJRUU8QEA0nJyWoqKjQ0NCWlpWhoaD6+vpfX10pKSjV1dWZmZhmZmXNzcyRkZD8/PttbWwODgvGxsasrKuJiYh1dXTAwL8bGxiCgoF9fXy5ubi7u7uFhYSysrFzc3KNjYyqqqn39/eMjItra2qkpKN0dHOKiolkZGOcnJthYV+AgH9dXVz4+PhsbGsyMjBycnD19fWrq6qMjIxzc3GxsbC4uLeCgoC+vr6bm5rFxcWQkI8SEg/MzMsmJiVmZmSYmJfT09IrKyleXlygoJ/U1NRaWllAQD8WFhNNTUvAqG3jAAAAAWJLR0QGYWa4fQAAAAlwSFlzAAASdAAAEnQB3mYfeAAAAAd0SU1FB+YIHgI1LB8SQ2kAAAKaSURBVDjLPZPpW9NAEIc3qU422nC0GLBqqkQrFjxQTNUWpVLFIIKCSiuIF4r3BSioKB4o3veN4o3XH+nMbB77Kc/zzu7O+5upEOqn6aFp08GQYMKMmWFLaEXFJaURK1r2n8+yy8EkXjE7pmuaHZkzF+Y5Wjzg8xeISnCJL1zk2MgTiyvAhariJYpb0WQ1cQNqljrLkMeWr8D7TKhdGfDQKsXrVntFyFNr1uJlIKW7jrmWzihev96j8+n4BrwfuZQGcRFrYC6zGxvxfT23aTNxwzAACzRhRZoUd7f4NvqEm7cyhzoTK4SwnBbmhrGNeWvbduIm7GjvwA+he1XkLw3YyTxpVSq+a3dnvhxcUdjD3ISuRp18ot2K72138qF8D4guyhf5Po/5/gP03kE41HvYxnaO9AhXMm9xLPbtC3xLPPaJHxV03oVjEYt9jyt+4qTP/NRpEMwbEsIi3zPK1zzL/Yaaz2GTxDMpjbhzHvrJVw4Mch5tF0gT+cVcFLneOBT4Dhc4D/0Scilc6Gi9TNy/EviODOqUR/Qqz0PAtWhS14RdqA34qM++4evUD86iOx9mfgNoNibc5Dy03C3V75i47eGDduEO834o5TxEajzYn7sC7hX0osJ9E5vDfh8kLAt5Ipi/+VAIAx453uMnwHw8xnk4TdSPIeXTzmcCTz7vfaH4yxzloXuvAt/XvlUmcBT1NYq/CXMe3mjgUztoJ8twFpJ2C53fsq/ujwT8HfpigcQKSfw9Zoe+/nAw/yH0pYIJqkf+oY3z8Ad4V134SL5UMDmBRi58+hxi/sVVvl8niVOBlspAFr59z9Ef0v+RlZznFPtyAabaBz/jaVqQyK8x8jEgk9aY8w1Wqz71O2JjPn/+sq8J1eyrCv4BVZVzssZYsOsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDgtMzBUMDI6NTM6MjErMDA6MDBmmUewAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA4LTMwVDAyOjUzOjIxKzAwOjAwF8T/DAAAAABJRU5ErkJggg=="},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:e.title,style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",a.name],["Customer Tel No",":",a.phone],["Customer Address",":",a.siteAddress],["Job No",":",e.form.jobNumber]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(o.updatedAt,"DD MMM YYYY")],["Branch Code",":",s.code],["SC Name",":",o.name],["SC Tel No",":",o.mobile],["Installer",":",e.form.installer],["Date Installed",":",t(e.form.installedDate,"DD MMM YYYY")]]},layout:"noBorders",alignment:"right"}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:[20,25,30,70,70,30,30,30,40,35,"*","*","*","*","*"],body:l}}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0,fontSize:8},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"landscape"};ca["createPdf"](u).open()}}))()},reset(){}}},Xo=Wo,Zo=Object(b["a"])(Xo,Ho,Vo,!1,null,null,null),es=Zo.exports,ts=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"actionsServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Approve or Reject report\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select recepients:\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"flex justify-center q-gutter-md"},[a("q-checkbox",{staticClass:"row",attrs:{label:"Purchaser"},model:{value:e.selected.purchaser,callback:function(t){e.$set(e.selected,"purchaser",t)},expression:"selected.purchaser"}}),a("q-checkbox",{staticClass:"row",attrs:{label:"Factory"},model:{value:e.selected.factory,callback:function(t){e.$set(e.selected,"factory",t)},expression:"selected.factory"}}),a("q-checkbox",{staticClass:"row",attrs:{label:"Logistic"},model:{value:e.selected.logistic,callback:function(t){e.$set(e.selected,"logistic",t)},expression:"selected.logistic"}})],1),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-separator",{staticClass:"q-my-md"}),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",{staticClass:"q-mx-sm"},[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:!e.isReportStateDetailer},on:{click:e.onClickReject}}),e.isReportStateDetailer?e._e():a("q-tooltip",[e._v("\n            Report is not in Detailer state\n          ")])],1),a("div",[a("q-btn",{attrs:{label:"Approve",color:"positive",disable:e.isApproveBtnDisabled},on:{click:e.onClickApprove}}),e.isReportStateDetailer?e._e():a("q-tooltip",[e._v("\n            Report is not in Detailer state\n          ")]),e.isReportStateSequenceSelected?e._e():a("q-tooltip",[e._v("\n            Select at least one(1) recipient.\n          ")])],1)],1)],1)])],1)},as=[],os={components:{ModalDialog:v},mixins:[x["a"]],data(){return{report:{},remarks:"",selected:{purchaser:!1,logistic:!1,factory:!1}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{reportStateSequence(){const{purchaser:e,logistic:t,factory:a}=this.selected,o=[];return e&&o.push("Purchaser"),a&&o.push("Factory"),t&&o.push("Logistic"),o},reportState(){const e=this.reportStateSequence[0];return null!==e&&void 0!==e?e:null},isReportStateDetailer(){return"Detailer"===this.report.state},isReportStateSequenceSelected(){return!!this.reportState},isApproveBtnDisabled(){const{isReportStateDetailer:e,isReportStateSequenceSelected:t}=this;return!e||!t}}),watch:{reportState:function(e){console.log("reportState",e)},reportStateSequence:function(e){console.log("reportStateSequence",e)}},methods:{onShowDialog(){var e=this;return i()((function*(){const[t]=e.tableSelection;e.report=t}))()},onClickApprove(){var e=this;return i()((function*(){const{uuid:t}=e.report;try{e.$q.loading.show(),yield e.$store.dispatch("ServiceReportActions",{uuid:t,data:{state:e.reportState,stateSequence:e.reportStateSequence}}),e.$q.loading.hide(),e.$notify("success","State successfully updated"),e.$refs.dialog.$children[0].hide()}catch(a){e.$q.loading.hide(),e.$notify("error","State failed to be updated")}}))()},onClickReject(){var e=this;return i()((function*(){e.state="Rejected";try{e.$q.loading.show(),e.$store.dispatch("ServiceReportActions",{uuid:e.tableSelection[0].uuid,data:{state:e.state,remarks:e.remarks}}),e.reset(),e.$q.loading.hide(),e.$notify("success","State successfully updated"),e.$refs.dialog.$children[0].hide()}catch(t){e.$q.loading.hide(),e.$notify("error","State failed to be updated")}}))()},reset(){this.report={},this.remarks="",this.selected={purchaser:!1,logistic:!1,factory:!1}}}},ss=os,rs=Object(b["a"])(ss,ts,as,!1,null,null,null),is=rs.exports,ls=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"createServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Create Service Report\n        ")])]),a("q-card-section",[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"text-weight-bold text-center text-uppercase text-grey-7"},[a("p",{staticClass:"q-mt-md q-mb-none"},[e._v("\n              Report Information\n            ")])]),a("div",[a("q-toggle",{attrs:{label:"Manual Input"},model:{value:e.isManualInput,callback:function(t){e.isManualInput=t},expression:"isManualInput"}})],1)]),a("q-separator",{staticClass:"q-mb-lg q-mt-none"}),a("div",{staticClass:"q-gutter-sm justify"},[a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.leadOptions,label:"Selected Customer",outlined:"","use-input":"","input-debounce":"0","emit-value":"","map-options":""},on:{filter:e.leadsFilterFn},model:{value:e.form.leadId,callback:function(t){e.$set(e.form,"leadId",t)},expression:"form.leadId"}})],1),a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.jobNumberOptions,label:"Selected Job Number",outlined:"","use-input":"","input-debounce":"0"},on:{filter:e.jobNumberFilterFn},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}})],1),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Name",outlined:"","lazy-rules":""},model:{value:e.lead.name,callback:function(t){e.$set(e.lead,"name",t)},expression:"lead.name"}}):e._e(),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Job Number",outlined:"","lazy-rules":""},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}}):e._e(),a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Customer Email",type:"email","lazy-rules":""},model:{value:e.lead.email,callback:function(t){e.$set(e.lead,"email",t)},expression:"lead.email"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Address",outlined:"","lazy-rules":""},model:{value:e.lead.siteAddress,callback:function(t){e.$set(e.lead,"siteAddress",t)},expression:"lead.siteAddress"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{value:e.formatPhoneNo(e.lead.phone),label:"Customer Contact",outlined:"","lazy-rules":"",mask:"### - ############","unmasked-value":""},model:{value:e.lead.phone,callback:function(t){e.$set(e.lead,"phone",t)},expression:"lead.phone"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Installer",outlined:"","lazy-rules":""},model:{value:e.form.installer,callback:function(t){e.$set(e.form,"installer",t)},expression:"form.installer"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{value:e.convertedDate(e.form.installedDate),mask:"##/##/####",outlined:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{subtitle:"Installed",title:"Date"},model:{value:e.form.installedDate,callback:function(t){e.$set(e.form,"installedDate",t)},expression:"form.installedDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-uppercase text-grey-7"},[e._v("\n            Remarks\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-input",{attrs:{filled:"",type:"textarea"},model:{value:e.form.remarksSalesConsultant,callback:function(t){e.$set(e.form,"remarksSalesConsultant",t)},expression:"form.remarksSalesConsultant"}}),a("q-separator",{staticClass:"q-mb-md"}),a("div",{staticClass:"flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"Continue"},on:{click:e.onClickContinue}})],1)],1)],1)],1)])],1)},ns=[],ds={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isManualInput:!1,form:{installedDate:"",installer:"",jobNumber:"",leadId:"",remarksSalesConsultant:""},lead:{name:"",siteAddress:"",phone:"",email:""},jobNumbersByLeadId:{},leads:[],leadOptions:[],jobNumberOptions:[]}},computed:n()({},Object(q["b"])(["tableSelection","roles","userId"])),watch:{isManualInput(e){e?(this.form.leadId=void 0,this.form.jobNumber="",this.lead={name:"",siteAddress:"",phone:"",email:""}):(this.lead.name=void 0,this.lead.siteAddress="",this.lead.phone="",this.lead.email="")},"form.leadId"(e){var t=this;return i()((function*(){if(!e)return;t.jobNumberOptions=[],t.form.jobNumber="";const{data:a}=yield t.$repository.lead.getById(e);t.jobNumberOptions=t.jobNumbersByLeadId[e]||[],t.jobNumberOptions.length&&(t.form.jobNumber=t.jobNumberOptions[0]),console.log(t.jobNumberOptions,t.jobNumbersByLeadId),t.lead=a}))()}},methods:{onShowDialog(){var e=this;return i()((function*(){yield e.getLeadAndJobNumberOptions()}))()},getLeadAndJobNumberOptions(){var e=this;return i()((function*(){const[t]=e.roles,a="salesconsultant"===t,o={where:{userId:e.userId}},s=a?o:void 0;let{data:r}=yield e.$repository.fco.listing({where:{state:"FCO",status:"Production"},include:[{relation:"designs"},{relation:"lead",scope:s}]});r=r.filter(e=>e.lead);for(const i of r){const{lead:t}=i;if(e.leadExistsInOption(t.uuid)||e.leadOptions.push({label:t.name,value:t.uuid}),i.designs)for(const a of i.designs)e.jobNumbersByLeadId[t.uuid]||(e.jobNumbersByLeadId[t.uuid]=[]),e.jobNumbersByLeadId[t.uuid].push(`${i.jobId} ${a.jobPart}`)}e.leads=e.leadOptions,e.leadOptions.length&&(e.form.leadId=e.leadOptions[0].value)}))()},onClickContinue(){var e=this;return i()((function*(){try{const t={leadManualInput:e.isManualInput?e.lead:void 0,leadId:e.isManualInput?void 0:e.form.leadId,jobNumber:e.form.jobNumber,installer:e.form.installer,installedDate:new Date(e.form.installedDate),remarksSalesConsultant:e.form.remarksSalesConsultant,state:"New",type:"ServiceReport",LogNumber:""};yield e.$store.dispatch("CreateSR",t),yield e.$store.dispatch("GetAllSR",{}),e.$notify("success","Successfully created service report.")}catch(t){e.$notify("error","Failed creating service report.")}}))()},formatPhoneNo(e){return Object(j["b"])(e)},leadExistsInOption(e){return this.leadOptions.filter(t=>t.value===e).length>0},jobNumberFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId].filter(e=>e.toLowerCase().indexOf(t)>-1)}:()=>{this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId]})},leadsFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.leadOptions=this.leads.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.leadOptions=this.leads})},convertedDate(e){let t=e.split("/");return t=`${t[2]}/${t[1]}/${t[0]}`,t},reset(){this.form={installedDate:"",installer:"",jobNumber:"",leadId:""},this.isManualInput=!1,this.lead={siteAddress:"",phone:"",email:""},this.jobNumbersByLeadId={},this.leadOptions=[],this.jobNumberOptions=[]}}},cs=ds,us=Object(b["a"])(cs,ls,ns,!1,null,null,null),ms=us.exports,ps=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"createReportMaintenance"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Report Maintainence\n        ")])]),a("q-card-section",[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"text-weight-bold text-center text-uppercase text-grey-7"},[a("p",{staticClass:"q-mt-md q-mb-none"},[e._v("\n              Report Information\n            ")])]),a("div",[a("q-toggle",{attrs:{label:"Manual Input"},model:{value:e.isManualInput,callback:function(t){e.isManualInput=t},expression:"isManualInput"}})],1)]),a("q-separator",{staticClass:"q-mb-lg q-mt-none"}),a("div",{staticClass:"q-gutter-sm justify"},[a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.leadOptions,disable:!e.leadOptions.length,label:"Selected Customer",outlined:"","use-input":"","input-debounce":"0","emit-value":"","map-options":""},on:{filter:e.leadsFilterFn},model:{value:e.form.leadId,callback:function(t){e.$set(e.form,"leadId",t)},expression:"form.leadId"}})],1),a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.jobNumberOptions,disable:!e.jobNumberOptions.length,label:"Selected Job Number",outlined:"","use-input":"","input-debounce":"0"},on:{filter:e.jobNumberFilterFn},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}})],1),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Name",outlined:"","lazy-rules":""},model:{value:e.lead.name,callback:function(t){e.$set(e.lead,"name",t)},expression:"lead.name"}}):e._e(),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Job Number",outlined:"","lazy-rules":""},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}}):e._e(),a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Customer Email",type:"email","lazy-rules":""},model:{value:e.lead.email,callback:function(t){e.$set(e.lead,"email",t)},expression:"lead.email"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Address",outlined:"","lazy-rules":""},model:{value:e.lead.siteAddress,callback:function(t){e.$set(e.lead,"siteAddress",t)},expression:"lead.siteAddress"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Contact",outlined:"","lazy-rules":"",mask:"### - ############","unmasked-value":""},model:{value:e.lead.phone,callback:function(t){e.$set(e.lead,"phone",t)},expression:"lead.phone"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Installer",outlined:"","lazy-rules":""},model:{value:e.form.installer,callback:function(t){e.$set(e.form,"installer",t)},expression:"form.installer"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{rules:["date"],label:"Installed Date",mask:"date",outlined:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{subtitle:"Installed",title:"Date"},model:{value:e.form.installedDate,callback:function(t){e.$set(e.form,"installedDate",t)},expression:"form.installedDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.installedDate,callback:function(t){e.$set(e.form,"installedDate",t)},expression:"form.installedDate"}}),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-uppercase text-grey-7"},[e._v("\n            Remarks\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-input",{attrs:{filled:"",type:"textarea"},model:{value:e.form.remarksSalesConsultant,callback:function(t){e.$set(e.form,"remarksSalesConsultant",t)},expression:"form.remarksSalesConsultant"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"Continue"},on:{click:e.onClickContinue}})],1)],1)],1)],1)])],1)},hs=[],fs={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isManualInput:!1,form:{installedDate:"",installer:"",jobNumber:"",leadId:"",remarksSalesConsultant:""},lead:{name:"",siteAddress:"",phone:"",email:""},jobNumbersByLeadId:{},leads:[],leadOptions:[],jobNumberOptions:[]}},computed:n()({},Object(q["b"])(["tableSelection","roles","userId"])),watch:{isManualInput(e){e?(this.form.leadId=void 0,this.form.jobNumber="",this.lead={name:"",siteAddress:"",phone:""}):(this.lead.name=void 0,this.lead.siteAddress="",this.lead.phone="")},"form.leadId"(e){var t=this;return i()((function*(){if(!e)return;t.jobNumberOptions=[],t.form.jobNumber="";const{data:a}=yield t.$repository.lead.getById(e);t.jobNumberOptions=t.jobNumbersByLeadId[e]||[],t.jobNumberOptions.length&&(t.form.jobNumber=t.jobNumberOptions[0]),t.lead=a}))()}},methods:{onShowDialog(){var e=this;return i()((function*(){yield e.getLeadAndJobNumberOptions()}))()},getLeadAndJobNumberOptions(){var e=this;return i()((function*(){const[t]=e.roles,a="salesconsultant"===t,o={where:{userId:e.userId}},s=a?o:void 0;let{data:r}=yield e.$repository.fco.listing({where:{state:"FCO",status:"Production"},include:[{relation:"designs"},{relation:"lead",scope:s}]});r=r.filter(e=>e.lead);for(const i of r){const{lead:t}=i;if(e.leadExistsInOption(t.uuid)||e.leadOptions.push({label:t.name,value:t.uuid}),i.designs)for(const a of i.designs)e.jobNumbersByLeadId[t.uuid]||(e.jobNumbersByLeadId[t.uuid]=[]),e.jobNumbersByLeadId[t.uuid].push(`${i.jobId} ${a.jobPart}`)}e.leads=e.leadOptions,e.leadOptions.length&&(e.form.leadId=e.leadOptions[0].value)}))()},onClickContinue(){var e=this;return i()((function*(){try{const t={leadManualInput:e.isManualInput?e.lead:void 0,leadId:e.isManualInput?void 0:e.form.leadId,jobNumber:e.form.jobNumber,installer:e.form.installer,installedDate:new Date(e.form.installedDate),remarksSalesConsultant:e.form.remarksSalesConsultant,state:"New",type:"MaintenanceReport",LogNumber:""};e.$q.loading.show(),yield e.$store.dispatch("GetAllSR",{}),yield e.$store.dispatch("CreateMR",t),e.$q.loading.hide(),e.$notify("success","Successfully created report maintainence.")}catch(t){e.$q.loading.hide(),e.$notify("error","Failed creating report maintainence.")}}))()},formatPhoneNo(e){return Object(j["b"])(e)},leadExistsInOption(e){return this.leadOptions.filter(t=>t.value===e).length>0},jobNumberFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId].filter(e=>e.toLowerCase().indexOf(t)>-1)}:()=>{this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId]})},leadsFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.leadOptions=this.leads.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.leadOptions=this.leads})},reset(){this.form={installedDate:"",installer:"",jobNumber:"",leadId:""},this.isManualInput=!1,this.lead={siteAddress:"",phone:""},this.jobNumbersByLeadId={},this.leadOptions=[],this.jobNumberOptions=[]}}},gs=fs,bs=Object(b["a"])(gs,ps,hs,!1,null,null,null),ys=bs.exports,vs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewMaintenanceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Report Maintainence\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8"},[e._v("\n            Details\n          ")])])]),a("q-separator",{staticClass:"q-my-md"}),a("q-card-actions",{attrs:{align:"right"}},["detailer"===e.roles[0]||"sysadmin"===e.roles[0]?a("q-btn",{attrs:{color:"secondary",label:"Edit Report"},on:{click:e.onClickEditReport}}):e._e(),a("q-btn",{attrs:{color:"primary",label:"View Report"},on:{click:e.generatePdf}})],1)],1)])],1)},qs=[],xs={components:{ModalDialog:v},data(){return{selection:{},form:{},items:[]}},computed:n()({},Object(q["b"])(["tableSelection","roles"])),methods:{onShowDialog(){var e=this;return i()((function*(){e.selection=e.$store.getters.tableSelection[0],e.form=n()({},e.selection),console.log("aa",e.form)}))()},onClickEditReport(){const{uuid:e}=this.selection,t=this.$router.resolve({path:"report-maintainence/"+e});window.open(t.href,"_blank")},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===ca["vfs"]&&(ca["vfs"]=ua["pdfMake"].vfs);const{data:a}=yield e.$repository.lead.getById(e.form.leadId),{data:o}=yield e.$repository.user.getById(e.form.userId),{data:s}=yield e.$repository.branch.getById(o.branchId);console.log("bb",a),console.log("cc",o),console.log("dd",s);var r=[];if(e.roles&&"salesconsultant"===e.roles[0]||"purchaser"===e.roles[0]||"detailer"===e.roles[0]||"logistic"===e.roles[0]||"sysadmin"===e.roles[0]){r.push(["QTY","UOM","MODEL","DESCRIPTION","REMARKS","WIDTH","HEIGHT","DEPTH","MATERIAL","COLOUR","PROFILE","U/PRICE","AMOUNT"]);for(const t of e.form.items)r.push([t.quantity,t.item.uom,t.item.itemcode,t.item.name,t.remarks,t.width,t.height,t.depth,t.material.material,t.material.colour,t.material.profile,t.material.price,(t.material.price*t.quantity).toFixed(2)])}else if("factory"===e.roles[0]||"sysadmin"===e.roles[0]){r.push(["QTY","UOM","MODEL","DESCRIPTION","REMARKS","WIDTH","HEIGHT","DEPTH","MATERIAL","COLOUR","PROFILE"]);for(const t of e.form.items)r.push([t.quantity,t.item.uom,t.item.itemcode,t.item.name,t.remarksFactory,t.width,t.height,t.depth,t.material.material,t.material.colour,t.material.profile])}else if("hqAccountant"===e.roles[0]||"sysadmin"===e.roles[0]){r.push(["QTY","UOM","MODEL","DESCRIPTION","REMARKS","WIDTH","HEIGHT","DEPTH","MATERIAL","COLOUR","PROFILE","U/PRICE","AMOUNT","DEALER PRICE","SM PRICE"]);for(const t of e.form.items)r.push([t.quantity,t.item.uom,t.item.itemcode,t.item.name,t.remarks,t.width,t.height,t.depth,t.material.material,t.material.colour,t.material.profile,t.material.price,(t.material.price*t.quantity).toFixed(2),(t.material.price*t.item.dealerprice).toFixed(2),(t.material.price*t.item.SMPrice).toFixed(2)])}var i={content:[{columns:[[{text:"Signature Kitchen SDN BHD",style:"address"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,",style:"address"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor",style:"address_sub"}]]},{columns:[[{text:"Customer Name :   "+a.name,style:"sub_header"},{text:"Contact No          :   "+a.phone,style:"sub_header"},{text:"Job No                 :   "+e.form.jobNumber,style:"sub_header"}],[{text:"Date :                  "+t(o.updatedAt,"DD MMM YYYY"),style:"sc_header"},{text:"Branch :                               "+s.code,style:"sc_header"},{text:"SC Name :                                     "+o.name,style:"sc_header"},{text:"SC Tel No :                 "+o.mobile,style:"sc_header"},{text:"Installer :                      "+e.form.installer,style:"sc_header"},{text:"Date Installed :                 "+t(e.form.installedDate,"DD MMM YYYY"),style:"sc_header"}]]},{style:"tableExample",table:{body:r}}],styles:{header:{bold:!0,fontSize:15,alignment:"right"},address:{bold:!0,fontSize:7,alignment:"left"},address_sub:{bold:!0,fontSize:7,alignment:"left",margin:[0,0,5,10]},sub_header:{fontSize:10,alignment:"left"},sc_header:{fontSize:10,alignment:"right"},tableExample:{alignment:"center",fontSize:7,margin:[0,5,0,0]}}};ca["createPdf"](i).open()}))()},reset(){}}},Cs=xs,ws=Object(b["a"])(Cs,vs,qs,!1,null,null,null),ks=ws.exports,_s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"submitToDetailerServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n        Submit Report to Detailer\n      ")])]),a("q-card-section",{staticClass:"q-mx-md q-my-md"},[a("div",[e._v("\n        This action will notify Detailer(s) regarding the report.\n      ")]),a("q-separator",{staticClass:"q-my-md"})],1),a("q-card-section",[a("div",{staticClass:"q-gutter-sm flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Submit",color:"primary",disable:e.isSubmitBtnDisabled},on:{click:e.onSubmit}}),e.isSubmitBtnDisabled?a("q-tooltip",[e._v("\n            Report is not in New state.\n          ")]):e._e()],1)],1)])],1)],1)},Ss=[],As={components:{ModalDialog:v},data(){return{report:{uuid:"",state:""}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isSubmitBtnDisabled(){return"New"!==this.report.state&&"Rejected"!==this.report.state}}),watch:{},methods:{onShowDialog(){const[e]=this.$store.getters.tableSelection;this.report=e},onSubmit(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$repository.serviceReport.updateById(e.report.uuid,{state:"Detailer"}),"MaintenanceReport"===e.report.type?yield e.$store.dispatch("GetAllMR",{}):yield e.$store.dispatch("GetAllSR",{}),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Successfully submitted to Detailer(s).")}catch(t){e.$q.loading.hide(),e.$notify("error","Could not submit report to detailer. Please try again.")}}))()},reset(){this.reportId=""}}},Ms=As,Is=Object(b["a"])(Ms,_s,Ss,!1,null,null,null),$s=Is.exports,Ds=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"completeServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n        Complete Task\n      ")])]),a("q-card-section",{staticClass:"q-ma-lg q-py-none"},[a("div",{staticClass:"q-mb-lg"},[a("p",{staticClass:"text-weight-medium q-ma-none"},[e._v("\n          This action will:\n        ")]),a("ul",[a("li",[e._v("notify the next recipient if there's any, or")]),a("li",[e._v("set the report state to Closed.")])])]),e.isCurrentStateEq("")||e.isCurrentStateEq("Closed")?e._e():a("div",[a("p",[a("span",{staticClass:"text-weight-medium"},[e._v("Next state")]),e._v(": "+e._s(e.nextState)+"\n        ")])])]),a("q-separator",{staticClass:"q-my-md"}),a("q-card-section",[a("div",{staticClass:"q-gutter-sm flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Complete",color:"primary",disable:e.isCompleteBtnDisabled},on:{click:e.onClickComplete}}),e.isCurrentStateEq(e.userRoleCapitalized)?e._e():a("q-tooltip",[e._v("\n            User is not "+e._s(e.report.state)+".\n          ")]),e.isCurrentStateEq("Closed")?a("q-tooltip",[e._v("\n            This report is closed.\n          ")]):e._e()],1)],1)])],1)],1)},Ts=[],Os={components:{ModalDialog:v},data(){return{report:{uuid:"",state:""}}},computed:n()(n()({},Object(q["b"])(["tableSelection","roles"])),{},{userRoleCapitalized(){const e=this.roles[0];return e[0].toUpperCase()+e.substring(1)},nextState(){const{stateSequence:e,state:t}=this.report,a=e.findIndex(e=>e===t),o=a+1;return o===e.length?"Closed":e[o]},isCompleteBtnDisabled(){return"sysadmin"!==this.roles[0]&&(!this.isCurrentStateEq(this.userRoleCapitalized)||this.isCurrentStateEq("Closed"))}}),watch:{},methods:{isCurrentStateEq(e){return this.report.state===e},onShowDialog(){const[e]=this.$store.getters.tableSelection;this.report=e,console.log("nextState",this.nextState)},onClickComplete(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$repository.serviceReport.updateById(e.report.uuid,{state:e.nextState}),"MaintenanceReport"===e.report.type?yield e.$store.dispatch("GetAllMR",{}):yield e.$store.dispatch("GetAllSR",{}),e.$refs.dialog.$children[0].hide(),e.$q.loading.hide(),e.$notify("success","Successfully completed report.")}catch(t){e.$q.loading.hide(),e.$notify("error","Could not complete report. Please try again.")}}))()},reset(){this.reportId=""}}},Ns=Os,Rs=Object(b["a"])(Ns,Ds,Ts,!1,null,null,null),Fs=Rs.exports,js=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"campaignDefault"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Set Campaign to default\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-center text-grey-8"},[e._v("\n            Set Campaign to default\n          ")]),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"Yes",color:"primary"},on:{click:e.onSetLeadToLost}})],1)])])],1)])],1)},Ls=[],Es={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{}}},computed:n()({},Object(q["b"])(["tableSelection"])),watch:{},methods:{onShowDialog(){this.form=this.$store.getters.tableSelection[0],this.selectedLeadId=this.form.uuid},onSetLeadToLost(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("setToDefaultExhibition",{uuid:e.selectedLeadId,status:"default"});const t=yield e.$store.dispatch("GetAllExhibitions");t.forEach(function(){var t=i()((function*(t){t.uuid!==e.selectedLeadId&&(yield e.$store.dispatch("setToDefaultExhibition",{uuid:t.uuid,status:""}))}));return function(e){return t.apply(this,arguments)}}()),e.$q.loading.hide(),e.$notify("success","Successfully set campaign to default"),e.$refs.dialog.$children[0].hide()}catch(t){console.log(t),e.$q.loading.hide(),e.$notify("error","Error")}}))()},reset(){this.selectedLeadId="",this.form={}}}},Ps=Es,Us=Object(b["a"])(Ps,js,Ls,!1,null,null,null),Bs=Us.exports,zs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"finalConfirmationOrderCompleteTask"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Complete Task\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Set Task as Complete\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("p",[e._v("Send order to production and get automatically generated job number?")])],1)]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Submit",color:"positive",disable:!e.isOrderStatusDetailer||!e.isDetailerAttachmentExist},on:{click:e.onClickSubmit}}),e.isOrderStatusDetailer?e._e():a("q-tooltip",[e._v("\n            Order state is not 'Detailer'\n          ")]),e.isDetailerAttachmentExist?e._e():a("q-tooltip",[e._v("\n            No attachment uploaded by Detailer.\n          ")]),a("div")],1)],1)],1)])],1)},Gs=[],Qs={components:{ModalDialog:v},mixins:[x["a"]],data(){return{remarks:"",form:{}}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{isOrderStatusDetailer(){return this.form&&"Detailer"===this.form.status},isDetailerAttachmentExist(){return this.form&&this.form.paymentAttachments&&this.form.paymentAttachments.some(e=>"Detailer"===e.type)}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0]),console.log("FCO",e.form)}))()},reset(){this.form={}},onClickSubmit(){var e=this;return i()((function*(){try{e.$q.loading.show(),yield e.$store.dispatch("FinalOrderConfirmationApproveForProduction",{orderId:e.tableSelection[0].uuid}),e.reset(),e.$q.loading.hide(),e.$notify("success","Order successfully sent to production!")}catch(t){console.log(t),e.$q.loading.hide(),e.$notify("error","Order state failed to be updated")}}))()}}},Ys=Qs,Js=Object(b["a"])(Ys,zs,Gs,!1,null,null,null),Ks=Js.exports,Hs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importopitemlist"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h5"},[e._v("\n        Import Optional Item List\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx file which contain optional item data\n    ")]),a("q-card-section",[a("q-uploader",{ref:"opitemlistUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        File upload mode\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-radio",{attrs:{val:"update",label:"Update"},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Update mode only creates or updates existing optional item list records in the SFM database.\n        ")])],1),a("q-radio",{attrs:{val:"reset",label:"Reset",disable:""},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Reset mode will delete all optional item list records in the SFM database, and create new item list records using optional items in the attached spreadsheet.\n          Currently reset mode is disabled in order to perform further testing.\n        ")])],1)],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        Notes on file upload modes\n      ")]),a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"assessment",label:"Update Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Update mode only creates or updates existing optional item list records in the SFM database. Each optional item list record in the uploaded spreadsheet will be checked against the SFM database using the item `name` to find any existing items; used for updating. "),a("br"),a("br"),e._v("\n              This mode is useful if you would want to only create new items or update existing items. Fast upload processing if only a part of the entire optional item list needs to be updated. "),a("br")])],1)],1),a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"receipt",label:"Reset Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Reset mode will delete all optional item list records in the SFM database, and create new optional item list records using items in the attached spreadsheet."),a("br"),a("br"),e._v("\n              This mode is useful when you would want to reset the entire optional item list in SFM database to have only items in the attached spreadsheet. Upload processing is slower than update mode."),a("br")])],1)],1)],1)],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1)],1)],1)},Vs=[],Ws={components:{ModalDialog:v},data(){return{uploadMode:"update"}},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.opitemlistUploader,o=e[0];try{const e=yield t.$repository.opitemlist.upload(o,t.uploadMode);a.removeFile(o),console.log("Upload op item list res:",e);const{created:s,updated:r}=e.data;t.$notify("success",`Item successfully created: ${s}, updated: ${r}.`),t.$store.dispatch("GetAllItems")}catch(s){let e=s;console.log("Failed to upload op item list file:",JSON.stringify(s)),s["message"].includes("422")&&(e="Failed to upload item list due to unsupported file type. Only Excel spreadsheet is supported."),t.$notify("error",e)}}))()}}},Xs=Ws,Zs=Object(b["a"])(Xs,Hs,Vs,!1,null,null,null),er=Zs.exports,tr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"rejectionReasonLostDesignProposal"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Manage Rejection Reasons\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Add Rejection Reason\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-form",[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",name:"form.reasonTitle",rules:[e.onReasonCheck],error:e.errormessage5.length>0},model:{value:e.form.reasonTitle,callback:function(t){e.$set(e.form,"reasonTitle",t)},expression:"form.reasonTitle"}}),e.errormessage5.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage5)+"\n                ")])]):e._e(),a("div",{attrs:{align:"left"}},[a("q-btn",{attrs:{color:"primary",label:"Add"},on:{click:e.onClickAddReason}})],1),a("q-separator",{staticClass:"q-my-md"})],1)])],1),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5 row"},[a("span",{staticClass:"col text-left"},[e._v("\n            Rejection Reason List\n          ")]),a("span",{staticClass:"col text-right"},[a("q-btn",{attrs:{size:"10px",color:"primary",label:"Edit"},on:{click:function(t){return e.onClickEdit()}}})],1)]),a("br"),a("q-list",{staticClass:"rounded-borders",attrs:{dense:"",bordered:"",padding:""}},e._l(e.rejectlist,(function(t,o){return a("q-item",{key:o},[a("q-item-section",[e._v("\n              "+e._s(t.reasonTitle)+"\n            ")]),1==e.edit?a("q-item-section",{attrs:{clickable:"",avatar:""},on:{click:function(a){return e.onClickDelete(t.uuid,t.reasonTitle)}}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-trash"}})],1):e._e(),a("q-dialog",{attrs:{persistent:""},model:{value:e.confirm,callback:function(t){e.confirm=t},expression:"confirm"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("span",{staticClass:"q-ml-sm"},[e._v("Are you sure want to delete?")])]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Confirm",color:"negative"},on:{click:function(t){return e.confirmedDelete()}}})],1)],1)],1)],1)})),1)],1),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{outline:"",color:"primary","no-caps":"",label:"Cancel"}})],1)])])],1)])],1)},ar=[],or={components:{ModalDialog:v},data(){return{form:{reasonTitle:""},edit:!1,reasonTitle:"",rejectlist:[],errormessage5:"",confirm:!1,remove_uuid:"",remove_reasonTitle:""}},computed:n()({},Object(q["b"])(["activeMenu"])),validations:{form:{reasonTitle:{required:M["required"]}}},methods:{onShowDialog(){this.form=n()({},this.activeMenu[0]);const e=this.$store.getters.reasonsList;this.getAllRejectionReason(e[0])},onClickAddReason(){var e=this;return i()((function*(){const t=e.$store.getters.reasonsList;if(e.form.reasonTitle)try{const{reasonTitle:a,reasonCategory:o=t[0]}=e.form,s=yield e.$store.dispatch("StoreRejectionReason",{reasonTitle:a,reasonCategory:o});e.rejectlist.push(s),e.$notify("success","Rejection Reason successfully added.")}catch(a){e.$notify("error","Action failed. Please try again")}else e.$notify("error","Please fill in rejection reason field")}))()},getAllRejectionReason(e){var t=this;return i()((function*(){try{const a=yield t.$store.dispatch("GetAllRejectionReason");a.forEach(a=>{a.reasonCategory===e&&t.rejectlist.push(a)})}catch(a){}}))()},onClickDelete(e,t){this.confirm=!0,this.remove_uuid=e,this.remove_reasonTitle=t},confirmedDelete(){var e=this;return i()((function*(){try{e.$store.dispatch("RemoveRejectionReason",e.remove_uuid),e.$notify("success","Successfully remove rejection reason"),yield setTimeout(5e4),location.reload()}catch(t){e.$notify("error","Action failed. Please try again")}}))()},onReasonCheck(){this.$v.form.$touch(),this.form.reasonTitle.length<=0?this.errormessage5="Field cant blank":this.errormessage5=""},onClickEdit(){!0===this.edit?this.edit=!1:this.edit=!0},reset(){this.form={reasonTitle:""},this.rejectlist=[],this.errormessage5=""}}},sr=or,rr=Object(b["a"])(sr,tr,ar,!1,null,null,null),ir=rr.exports,lr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importlooseitemlist"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("\n        Import\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx file which contain loose item data\n    ")]),a("q-card-section",[a("q-uploader",{ref:"looseItemlistUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        File upload mode\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-radio",{attrs:{val:"update",label:"Update"},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Update mode only creates or updates existing loose item list records in the SFM database.\n        ")])],1),a("q-radio",{attrs:{val:"reset",label:"Reset",disable:""},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Reset mode will delete all loose item list records in the SFM database, and create new loose item list records using items in the attached spreadsheet.\n          Currently reset mode is disabled in order to perform further testing.\n        ")])],1)],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        Notes on file upload modes\n      ")]),a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"assessment",label:"Update Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Update mode only creates or updates existing loose item list records in the SFM database. Each loose item list record in the uploaded spreadsheet will be checked against the SFM database using the item `name` to find any existing items; used for updating. "),a("br"),a("br"),e._v("\n              This mode is useful if you would want to only create new loose items or update existing items. Fast upload processing if only a part of the entire item list needs to be updated. "),a("br")])],1)],1),a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"receipt",label:"Reset Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Reset mode will delete all loose item list records in the SFM database, and create new loose item list records using items in the attached spreadsheet."),a("br"),a("br"),e._v("\n              This mode is useful when you would want to reset the entire loose item list in SFM database to have only items in the attached spreadsheet. Upload processing is slower than update mode."),a("br")])],1)],1)],1)],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1)],1)],1)},nr=[],dr={components:{ModalDialog:v},data(){return{uploadMode:"update"}},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.looseItemlistUploader,o=e[0];try{const e=yield t.$repository.looseitem.upload(o,t.uploadMode);a.removeFile(o),console.log("Upload item list res:",e);const{created:s,updated:r}=e.data;t.$notify("success",`Item successfully created: ${s}, updated: ${r}.`),t.$store.dispatch("GetAllItems")}catch(s){let e=s;console.log("Failed to upload item list file:",JSON.stringify(s)),s["message"].includes("422")&&(e="Failed to upload item list due to unsupported file type. Only Excel spreadsheet is supported."),t.$notify("error",e)}}))()}}},cr=dr,ur=Object(b["a"])(cr,lr,nr,!1,null,null,null),mr=ur.exports,pr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importmateriallist"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("\n        Import\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx file which contain material item data\n    ")]),a("q-card-section",[a("q-uploader",{ref:"materialListUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        File upload mode\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("q-radio",{attrs:{val:"update",label:"Update"},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Update mode only creates or updates existing material item list records in the SFM database.\n        ")])],1),a("q-radio",{attrs:{val:"reset",label:"Reset",disable:""},model:{value:e.uploadMode,callback:function(t){e.uploadMode=t},expression:"uploadMode"}},[a("q-tooltip",[e._v("\n          Reset mode will delete all material item list records in the SFM database, and create new material item list records using items in the attached spreadsheet.\n          Currently reset mode is disabled in order to perform further testing.\n        ")])],1)],1),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"text-h6"},[e._v("\n        Notes on file upload modes\n      ")]),a("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"assessment",label:"Update Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Update mode only creates or updates existing material item list records in the SFM database. Each material item list record in the uploaded spreadsheet will be checked against the SFM database using the item `name` to find any existing items; used for updating. "),a("br"),a("br"),e._v("\n              This mode is useful if you would want to only create new material items or update existing items. Fast upload processing if only a part of the entire item list needs to be updated. "),a("br")])],1)],1),a("q-expansion-item",{attrs:{"switch-toggle-side":"","expand-separator":"",icon:"receipt",label:"Reset Mode"}},[a("q-card",[a("q-card-section",[e._v("\n              Reset mode will delete all material item list records in the SFM database, and create new material item list records using items in the attached spreadsheet."),a("br"),a("br"),e._v("\n              This mode is useful when you would want to reset the entire material item list in SFM database to have only items in the attached spreadsheet. Upload processing is slower than update mode."),a("br")])],1)],1)],1)],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1)],1)],1)},hr=[],fr={components:{ModalDialog:v},data(){return{uploadMode:"update"}},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.materialListUploader,o=e[0];try{const e=yield t.$repository.material.upload(o,t.uploadMode);a.removeFile(o),console.log("Upload material list res:",e);const{created:s,updated:r}=e.data;t.$notify("success",`Material items successfully created: ${s}, updated: ${r}.`),t.$store.dispatch("GetAllItems")}catch(s){let e=s;console.log("Failed to upload material list file:",JSON.stringify(s)),s["message"].includes("422")&&(e="Failed to upload material list due to unsupported file type. Only Excel spreadsheet is supported."),t.$notify("error",e)}}))()}}},gr=fr,br=Object(b["a"])(gr,pr,hr,!1,null,null,null),yr=br.exports,vr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"changecampaignQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Request For Campaign Change\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onChangeCampaign}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Select a lead\n            ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.exhibitions,label:"Campaign","lazy-rules":"","map-options":"","emit-value":"",rules:[e.onExhibitionCheck],error:e.errormessage1.length>0},model:{value:e.form.exhibition,callback:function(t){e.$set(e.form,"exhibition",t)},expression:"form.exhibition"}},[e.errormessage1.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage1)+"\n                ")])]):e._e()],1),a("q-separator",{staticClass:"q-my-md"}),e.selectedLeadId?[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","lazy-rules":"",label:"Reason",rules:[e.onReasonCheck,e.textRules],error:e.errormessage2.length>0},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}},[e.errormessage2.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage2)+"\n                  ")])]):e._e()],1),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errormessage1.length>0||e.errormessage2.length>0},on:{click:e.onChangeCampaign}})],1)]:e._e()],2)])],1)],1)])],1)},qr=[];const{formatDate:xr}=G["e"];var Cr={components:{ModalDialog:v},data(){return{textRules:[e=>e&&e.length>0&&e.length<100],options:{roles:[],branches:[]},dialog:{show:!1,userId:"",roleArr:[]},opts:{exhibitions:[]},errormessage1:"",errormessage2:"",form:{exhibition:"",reason:"",campaign:""},selectedLeadId:"",selections:[],user:[]}},computed:n()({},Object(q["b"])(["tableSelection"])),validations:{form:{exhibition:{required:M["required"]},reason:{required:M["required"]}}},watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.user=n()({},a)}},mounted(){this.form={}},methods:{onShowDialog(){var e=this;return i()((function*(){if(!e.$store.getters.tableSelection.length)return;e.selections=e.$store.getters.tableSelection,e.selections=e.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value,console.log("selection",e.selections.value);const t=parseInt(xr(Date.now(),"YYYYMMDD"));e.opts.exhibitions=(yield e.$store.dispatch("GetAllExhibitions")).filter(e=>{const a=parseInt(e.hideDate.replace(/\//g,""));return t<a}).map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t.status=e.status,t}),e.opts.exhibitions.filter(t=>{if(console.log("here",t.value),console.log("EXHIBITION HERE:   "+JSON.stringify(t)),"default"===t.status){const a=t.value;console.log("val here",a),e.form.exhibition=a,e.form.campaign=t.label}}),console.log("ex",e.form.campaign),console.log("log",e.opts.exhibitions)}))()},reset(){this.selectedLeadId="",this.form={exhibition:"",reason:"",campaign:""},this.user=""},onChangeCampaign(){var e=this;return i()((function*(){if(e.errormessage1.length>0||e.errormessage2.length>0){const t=n()({},e.form),a=e.user;e.$refs.myForm.validate().then(function(){var o=i()((function*(o){o?(e.$q.loading.show(),yield e.$store.dispatch("CampaignChangeRequest",{data:t,user:a}),e.$q.loading.hide(),e.$notify("success",`Lead (${a.name}) change campaign requested!`),e.reset(),e.$refs.dialog.$children[0].hide()):e.$notify("error","All field is required")}));return function(e){return o.apply(this,arguments)}}())}else e.$refs.myForm.validate()}))()},onExhibitionCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),console.log(e.user.exhibition),void 0!==e.form.exhibition)if(e.form.exhibition.length<=0)e.errormessage1="Field cant blank";else if(e.form.exhibition===e.user.exhibition)e.errormessage1="Field must be different from current campaign";else{e.errormessage1="";const t=e.opts.exhibitions.filter(t=>t.value===e.form.exhibition)[0];console.log("campaign",t),e.form.campaign=t.label}else e.errormessage1="Field cant blank";console.log("exhibition",e.form.exhibition)}))()},onReasonCheck(){this.$v.form.$touch(),void 0!==this.form.reason?this.form.reason.length<=0?this.errormessage2="Field cant blank":this.errormessage2="":this.errormessage2="Field cant blank"}}},wr=Cr,kr=Object(b["a"])(wr,vr,qr,!1,null,null,null),_r=kr.exports,Sr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"editWalkingLead"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Edit Walk In Leads\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onUpdateQualifiedLead}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Select a lead\n            ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Edit data for walk in user only\n            ")]),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Name","lazy-rules":"",rules:[e.onNameCheck,e.textRules],error:e.errorMessageName.length>0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errorMessageName.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageName)+"\n                ")])]):e._e()],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Email",type:"email",debounce:"1000",rules:[e.onEmailCheck,e.emailRules],error:e.errorMessageEmail.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errorMessageEmail.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageEmail)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",type:"tel",label:"Telephone No.","lazy-rules":"",rules:[e.onMobileCheck],error:e.errorMessagePhone.length>0,mask:"### - ############","unmasked-value":""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}},[e.errorMessagePhone.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessagePhone)+"\n                  ")])]):e._e()],1)],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","lazy-rules":"",label:"Property Name",rules:[e.onLocationCheck,e.textRules],error:e.errorMessageProperty.length>0},model:{value:e.form.property_type,callback:function(t){e.$set(e.form,"property_type",t)},expression:"form.property_type"}},[e.errorMessageProperty.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageProperty)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","lazy-rules":"",label:"Billing Address Line 1",rules:[e.onAddressCheck,e.textRules],error:e.errorMessageAddress.length>0},model:{value:e.form.address1,callback:function(t){e.$set(e.form,"address1",t)},expression:"form.address1"}},[e.errorMessageAddress.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageAddress)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Billing Address Line 2"},model:{value:e.form.address2,callback:function(t){e.$set(e.form,"address2",t)},expression:"form.address2"}}),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Postcode",min:"0",max:"99999","on-key-up":"if(this.value>99999) {this.value='99999';} else if (this.value<0) {this.value='0';}",type:"number"},model:{value:e.form.postcode,callback:function(t){e.$set(e.form,"postcode",t)},expression:"form.postcode"}}),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"City"},model:{value:e.form.city,callback:function(t){e.$set(e.form,"city",t)},expression:"form.city"}}),"Malaysia"===e.form.country?a("div",[a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"State","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errorMessageLocationState.length>0,rules:[e.onStateCheck,e.textRules],options:e.locationStatesOptions},on:{filter:e.filterState},model:{value:e.form.locationState,callback:function(t){e.$set(e.form,"locationState",t)},expression:"form.locationState"}},[e.errorMessageLocationState.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageLocationState)+"\n                  ")])]):e._e()],1)],1):a("div",[a("q-select",{staticClass:"col q-pb-none",attrs:{value:"",outlined:"",label:"State","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",disable:""}},[e.errorMessageLocationState.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errorMessageLocationState)+"\n                  ")])]):e._e()],1)],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Country","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errorMessageCountry.length>0,rules:[e.onCountryCheck,e.textRules],options:e.countryOptions},on:{filter:e.filterFn},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},[e.errorMessageCountry.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageCountry)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.exhibitions,label:"Campaign","lazy-rules":"","map-options":"","emit-value":"",rules:[e.onExhibitionCheck],error:e.errorMessageCampaign.length>0},model:{value:e.form.campaign,callback:function(t){e.$set(e.form,"campaign",t)},expression:"form.campaign"}},[e.errorMessageCampaign.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageCampaign)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.leads,label:"Source of Lead","lazy-rules":"",rules:[e.onSourceCheck,e.textRules],error:e.errorMessageSourceLead.length>0},model:{value:e.form.source_lead,callback:function(t){e.$set(e.form,"source_lead",t)},expression:"form.source_lead"}},[e.errorMessageSourceLead.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageSourceLead)+"\n                ")])]):e._e()],1),e.useOtherSourceLead?a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"(Others) Source of Lead","lazy-rules":"",rules:[e.onOtherSourceCheck,e.textRules],error:e.errorMessageOtherSourceLead.length>0},model:{value:e.form.others_source_lead,callback:function(t){e.$set(e.form,"others_source_lead",t)},expression:"form.others_source_lead"}},[e.errorMessageOtherSourceLead.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageOtherSourceLead)+"\n                ")])]):e._e()],1):e._e(),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Customer Sales Type\n            ")]),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.type,label:"Lead Type","emit-value":"","map-options":"","lazy-rules":"",rules:[e.onTypeCheck,e.textRules],error:e.errorMessageLeadType.length>0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e.errorMessageLeadType.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errorMessageLeadType)+"\n                ")])]):e._e()],1),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errorMessageName.length>0||e.errorMessageEmail.length>0||e.errorMessagePhone.length>0||e.errorMessageProperty.length>0||e.errorMessageSourceLead.length>0||e.errorMessageOtherSourceLead.length>0||e.errorMessageLeadType.length>0||e.errorMessageAddress.length>0||e.errorMessageLocationState.length>0||e.errorMessageCountry.length>0},on:{click:e.onUpdateQualifiedLead}})],1)],1)])],1)],1)])],1)},Ar=[];const{formatDate:Mr}=G["e"];var Ir={components:{ModalDialog:v},mixins:[x["a"]],data(){return{options:{roles:[],branches:[]},dialog:{show:!1,userId:"",roleArr:[]},opts:{exhibitions:[],propType:["Bungalow","Semi-D","Terrace","Townhouse","Apartment","ShopLot"],leads:["Events/Exhibitions","Social Media (Facebook, Instagram, Youtube, etc)","Signature Website","Google Search","Billboard","Shop Front Banner","Developer Voucher","Referred by Friends/Family","Others: Please State"],type:[{label:"Corporate",value:"corporate"},{label:"Retail",value:"retail"}],country:[]},errorMessageName:"",errorMessageEmail:"",errorMessagePhone:"",errorMessageProperty:"",errorMessageSourceLead:"",errorMessageOtherSourceLead:"",errorMessageLeadType:"",errorMessageCampaign:"",errorMessageAddress:"",errorMessageLocationState:"",errorMessageCountry:"",form:{name:"",email:"",phone:"",property_type:"",address1:"",address2:"",postcode:"",city:"",state:"",country:"",locationState:"",location:"",source_lead:"",others_source_lead:"",campaign:"",exhibition:"",type:"",siteAddress:"",age:"",property_value:"",time_contact:"",channel_contact:"",rejectReason:"",noteToBranch:"",birthday:0,race:""},selectedLeadId:"",lead:{},countryOptions:[],locationStatesOptions:[]}},computed:n()(n()({},Object(q["b"])(["tableSelection"])),{},{countries(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.name,t.flag=e.flag,t});return t},locationStates(){const e=["Johor","Kedah","Kelantan","Melaka","Negeri Sembilan","Pahang","Penang","Perak","Perlis","Sabah","Sarawak","Selangor","Terengganu"];return e},useOtherSourceLead(){return this.form.source_lead.toLowerCase().includes("other")}}),validations:{form:{name:{required:M["required"]},email:{required:M["required"],email:M["email"]},phone:{required:M["required"],minLength:Object(M["minLength"])(10)},property_type:{required:M["required"]},location:{required:M["required"]},source_lead:{required:M["required"]},type:{required:M["required"]},campaign:{required:M["required"]},exhibition:{required:M["required"]}}},watch:{selectedLeadId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.opts.leads.includes(t.source_lead)||(t.others_source_lead=t.source_lead,t.source_lead=a.opts.leads.find(e=>e.toLowerCase().includes("other"))),a.form=n()({},t),a.lead=n()({},t)}))()},"form.country"(e){"Malaysia"!==this.form.country&&(this.form.locationState="")}},mounted(){this.getExhibition()},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllCountries")}))()},methods:{onShowDialog(){var e=this;return i()((function*(){e.$store.getters.tableSelection.length&&(e.selections=e.$store.getters.tableSelection,e.selections=e.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value)}))()},getExhibition(){var e=this;return i()((function*(){const t=parseInt(Mr(Date.now(),"YYYYMMDD"));console.log(t),e.opts.exhibitions=(yield e.$store.dispatch("GetAllExhibitions")).filter(e=>{const a=parseInt(e.hideDate.replace(/\//g,""));return t<a}).map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t.status=e.status,t}),e.opts.exhibitions.filter(t=>{if(console.log("here",t.value),console.log("EXHIBITION HERE:   "+JSON.stringify(t)),"default"===t.status){const a=t.value;console.log("val here",a),e.form.exhibition=a,e.form.campaign=t.label}})}))()},reset(){this.form={name:"",email:"",phone:"",property_type:"",location:"",address1:"",address2:"",country:"",locationState:"",source_lead:"",others_source_lead:"",type:"",state:"QL",status:"active",campaign:"",exhibition:""},this.selectedLeadId="",this.lead={}},onUpdateQualifiedLead(){var e=this;return i()((function*(){const t=n()({},e.form);e.useOtherSourceLead&&(t.source_lead=t.others_source_lead,delete t.others_source_lead);try{e.$q.loading.show(),yield e.$store.dispatch("UpdateLead",t),e.$notify("success",`Lead with name ${t.name} updated!`),e.reset(),e.$q.loading.hide(),e.$refs.dialog.$children[0].hide()}catch(s){var a,o;console.log(s);const t=null===(a=s.response)||void 0===a||null===(o=a.message)||void 0===o?void 0:o.error;e.$q.loading.hide(),e.$notify("error",t)}}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errorMessageName="Field cant blank":this.errorMessageName=""},onEmailCheck(){var e=this;return i()((function*(){if(e.errorMessageEmail="",e.form.email===e.lead.email)return!0;e.$v.form.$touch(),e.form.email.length<=0?e.errorMessageEmail="Field cant be blank":yield e.$store.dispatch("LeadCheckEmailExist",e.form.email).then(t=>{e.errorMessageEmail=t?"Email already exist":""})}))()},onMobileCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),e.errorMessagePhone="",e.form.phone===e.lead.phone)return!0;e.form.phone.length<=0?e.errorMessagePhone="Field cant be blank":(yield e.$store.dispatch("LeadCheckMobileExist",e.form.phone).then(t=>{e.errorMessagePhone=t?"Mobile already exist":""}),e.form.phone.length>=10&&e.form.phone.length<=15||(e.errorMessagePhone="Telephone No. must be between 10-15 digits"))}))()},onLocationCheck(){this.$v.form.$touch(),this.form.property_type.length<=0?this.errorMessageProperty="Field cant blank":this.errorMessageProperty=""},onExhibitionCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.errorMessageCampaign="",e.form.campaign.length<=0&&(e.errorMessageCampaign="Field cant blank")}))()},onSourceCheck(){this.$v.form.$touch(),this.form.source_lead.length<=0?this.errorMessageSourceLead="Field cant blank":this.errorMessageSourceLead="",this.useOtherSourceLead||(this.errorMessageOtherSourceLead="")},onOtherSourceCheck(){this.$v.form.$touch(),this.useOtherSourceLead&&this.form.others_source_lead.length<=0?this.errorMessageOtherSourceLead="Field cant blank":this.errorMessageOtherSourceLead=""},onTypeCheck(){this.$v.form.$touch(),this.form.type.length<=0?this.errorMessageLeadType="Field cant blank":this.errorMessageLeadType=""},onAddressCheck(){this.$v.form.$touch(),this.form.address1.length<=0?this.errorMessageAddress="Field cant blank":this.errorMessageAddress=""},onStateCheck(){this.$v.form.$touch(),this.form.locationState.length<=0?this.errorMessageLocationState="Field cant blank":this.errorMessageLocationState=""},onCountryCheck(){this.$v.form.$touch(),this.form.country.length<=0?this.errorMessageCountry="Field cant blank":this.errorMessageCountry=""},filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.countryOptions=this.countries.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.countryOptions=this.countries})},filterState(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.locationStatesOptions=this.locationStates.filter(e=>e.toLowerCase().indexOf(t)>-1)}:()=>{this.locationStatesOptions=this.locationStates})}}},$r=Ir,Dr=Object(b["a"])($r,Sr,Ar,!1,null,null,null),Tr=Dr.exports,Or=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"editItemListRoute"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          "+e._s(e.currentTabName)+"\n        ")])]),a("q-card-section",["Loose Item List"===e.currentTabName?a("SkEditLooseItem"):e._e(),"Item list"===e.currentTabName?a("SkEditItem"):e._e(),"SR Item List"===e.currentTabName?a("SkEditServiceReportItem"):e._e(),"OP Item List"===e.currentTabName?a("SkEditOptionalItem"):e._e(),"Material List"===e.currentTabName?a("SkEditMaterial"):e._e()],1)],1)])],1)},Nr=[],Rr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"myForm",on:{submit:e.onUpdateItem}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Category",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[e.form.category?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Subcategory",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.subcategory,callback:function(t){e.$set(e.form,"subcategory",t)},expression:"form.subcategory"}},[e.form.subcategory?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Name",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.form.name?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Item Code","lazy-rules":""},model:{value:e.form.itemcode,callback:function(t){e.$set(e.form,"itemcode",t)},expression:"form.itemcode"}},[e.form.itemcode?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Virture",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.virture},model:{value:e.form.virture,callback:function(t){e.$set(e.form,"virture",t)},expression:"form.virture"}},[e.form.virture?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Brand","lazy-rules":""},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},[e.form.brand?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Material","lazy-rules":""},model:{value:e.form.material,callback:function(t){e.$set(e.form,"material",t)},expression:"form.material"}},[e.form.material?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Colour","lazy-rules":""},model:{value:e.form.colour,callback:function(t){e.$set(e.form,"colour",t)},expression:"form.colour"}},[e.form.colour?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Profile","lazy-rules":""},model:{value:e.form.profile,callback:function(t){e.$set(e.form,"profile",t)},expression:"form.profile"}},[e.form.profile?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{options:e.options.puom,outlined:"",label:"Puom",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.puom,callback:function(t){e.$set(e.form,"puom",t)},expression:"form.puom"}},[e.form.puom?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{options:e.options.suom,outlined:"",label:"Suom",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.suom,callback:function(t){e.$set(e.form,"suom",t)},expression:"form.suom"}},[e.form.suom?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Fraction","lazy-rules":""},model:{value:e.form.fraction,callback:function(t){e.$set(e.form,"fraction",e._n(t))},expression:"form.fraction"}},[e.form.fraction?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Standard Cost",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.stdcost,callback:function(t){e.$set(e.form,"stdcost",e._n(t))},expression:"form.stdcost"}},[e.form.stdcost?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Markup Rates","lazy-rules":""},model:{value:e.form.markuprate,callback:function(t){e.$set(e.form,"markuprate",e._n(t))},expression:"form.markuprate"}},[e.form.markuprate?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Part","lazy-rules":""},model:{value:e.form.part,callback:function(t){e.$set(e.form,"part",t)},expression:"form.part"}},[e.form.part?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Non Standard Rate",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.nonstdrate,callback:function(t){e.$set(e.form,"nonstdrate",e._n(t))},expression:"form.nonstdrate"}},[e.form.nonstdrate?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Installation Charge",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.installationcharges,callback:function(t){e.$set(e.form,"installationcharges",e._n(t))},expression:"form.installationcharges"}},[e.form.installationcharges?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Dealer Price","lazy-rules":""},model:{value:e.form.dealerprice,callback:function(t){e.$set(e.form,"dealerprice",e._n(t))},expression:"form.dealerprice"}},[e.form.dealerprice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Active",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.active},model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}},[e.form.active?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.oversea},model:{value:e.form.oversea,callback:function(t){e.$set(e.form,"oversea",t)},expression:"form.oversea"}},[e.form.oversea?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea Dealer Price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.overseadealerprice,callback:function(t){e.$set(e.form,"overseadealerprice",e._n(t))},expression:"form.overseadealerprice"}},[e.form.overseadealerprice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",type:"submit"}})],1)],1)])],1)},Fr=[],jr=a("4082"),Lr=a.n(jr),Er={components:{},mixins:[x["a"]],data(){return{options:{virture:["Y","N"],puom:["Pair","Pcs","Set","SM","Unit","MR"],suom:["Pair","Pcs","Set","SM","Unit","MR"],active:["Active","Inactive"],oversea:["Y","N"]},dialog:{show:!1,userId:""},selectedItemId:"",item:{},errorMessage:"Field can't be blank",form:{uuid:"",category:"",subcategory:"",name:"",itemcode:"",virture:"",brand:"",material:"",colour:"",profile:"",puom:"",suom:"",fraction:"",stdcost:"",markuprate:"",part:"",nonstdrate:"",installationcharges:"",dealerprice:"",active:"",oversea:"",overseadealerprice:""}}},computed:n()({},Object(q["b"])(["tableSelection"])),validations:{form:{name:{required:M["required"]}}},watch:{selectedItemId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.form=n()({},t),a.item=n()({},t)}))()}},mounted(){if(!this.$store.getters.tableSelection.length)return;this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedItemId=this.selections[0].value;const e=this.$store.getters.tableSelection.find(e=>e.uuid===this.selectedItemId);this.form=n()({},e),this.item=n()({},e)},created(){return i()((function*(){}))()},methods:{reset(){this.form={uuid:"",category:"",subcategory:"",name:"",itemcode:"",virture:"",brand:"",material:"",colour:"",profile:"",puom:"",suom:"",fraction:"",stdcost:"",markuprate:"",part:"",nonstdrate:"",installationcharges:"",dealerprice:"",active:"",oversea:"",overseadealerprice:""},this.selectedItemId="",this.item={}},onUpdateItem(){var e=this;return i()((function*(){const t=e.form,{$id:a,index:o}=t,s=Lr()(t,["$id","index"]);console.log({$id:a}),console.log({index:o});try{e.$q.loading.show(),yield e.$store.dispatch("UpdateItem",s),e.$notify("success",`Item ${s.name} updated!`),e.$q.loading.hide()}catch(l){var r,i;e.$q.loading.hide();const t=null===(r=l.response)||void 0===r||null===(i=r.message)||void 0===i?void 0:i.error;e.$notify("error",t)}}))()}}},Pr=Er,Ur=Object(b["a"])(Pr,Rr,Fr,!1,null,null,null),Br=Ur.exports,zr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"myForm",on:{submit:e.onUpdateItem}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Category",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.category},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[e.form.category?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Subcategory",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.subcategory,callback:function(t){e.$set(e.form,"subcategory",t)},expression:"form.subcategory"}},[e.form.subcategory?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Name",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.form.name?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Item Code",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.itemcode,callback:function(t){e.$set(e.form,"itemcode",t)},expression:"form.itemcode"}},[e.form.itemcode?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Virture",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.virture},model:{value:e.form.virture,callback:function(t){e.$set(e.form,"virture",t)},expression:"form.virture"}},[e.form.virture?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Brand",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},[e.form.brand?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Material","lazy-rules":""},model:{value:e.form.material,callback:function(t){e.$set(e.form,"material",t)},expression:"form.material"}},[e.form.material?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Colour","lazy-rules":""},model:{value:e.form.colour,callback:function(t){e.$set(e.form,"colour",t)},expression:"form.colour"}},[e.form.colour?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Profile","lazy-rules":""},model:{value:e.form.profile,callback:function(t){e.$set(e.form,"profile",t)},expression:"form.profile"}},[e.form.profile?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"PUoM",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.puom},model:{value:e.form.puom,callback:function(t){e.$set(e.form,"puom",t)},expression:"form.puom"}},[e.form.puom?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"SUoM",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.suom},model:{value:e.form.suom,callback:function(t){e.$set(e.form,"suom",t)},expression:"form.suom"}},[e.form.suom?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Fraction",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.fraction,callback:function(t){e.$set(e.form,"fraction",e._n(t))},expression:"form.fraction"}},[e.form.fraction?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Standard Cost",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.stdcost,callback:function(t){e.$set(e.form,"stdcost",e._n(t))},expression:"form.stdcost"}},[e.form.stdcost?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Markup rate",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.markuprate,callback:function(t){e.$set(e.form,"markuprate",e._n(t))},expression:"form.markuprate"}},[e.form.markuprate?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Part","lazy-rules":""},model:{value:e.form.part,callback:function(t){e.$set(e.form,"part",t)},expression:"form.part"}},[e.form.part?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Non Standard Rate",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.nonstdrate,callback:function(t){e.$set(e.form,"nonstdrate",e._n(t))},expression:"form.nonstdrate"}},[e.form.nonstdrate?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Installation charges",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.installationcharges,callback:function(t){e.$set(e.form,"installationcharges",e._n(t))},expression:"form.installationcharges"}},[e.form.installationcharges?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Dealer price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.dealerprice,callback:function(t){e.$set(e.form,"dealerprice",e._n(t))},expression:"form.dealerprice"}},[e.form.dealerprice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Active",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.active},model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}},[e.form.color_code?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.oversea},model:{value:e.form.oversea,callback:function(t){e.$set(e.form,"oversea",t)},expression:"form.oversea"}},[e.form.oversea?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea dealer price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.overseadealerprice,callback:function(t){e.$set(e.form,"overseadealerprice",e._n(t))},expression:"form.overseadealerprice"}},[e.form.overseadealerprice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",type:"submit"}})],1)],1)])],1)},Gr=[],Qr={mixins:[x["a"]],data(){return{options:{category:["Kitchen Appliances","Home Appliances","Loose Furniture","Sanitary Wares","Bed & Mattress","Soft Furnishing"],virture:["Y","N"],puom:["Pcs","Unit"],suom:["Pcs","Unit"],active:["Active","Inactive"],oversea:["Y","N"]},dialog:{show:!1,userId:""},selectedItemId:"",item:{},errorMessage:"Field can't be blank",form:{uuid:"",category:"",subcategory:"",name:"",itemcode:"",virture:"",brand:"",material:"",colour:"",profile:"",puom:"",suom:"",fraction:"",stdcost:"",markuprate:"",part:"",nonstdrate:"",installationcharges:"",dealerprice:"",active:"",oversea:"",overseadealerprice:""}}},computed:n()({},Object(q["b"])(["tableSelection"])),validations:{form:{name:{required:M["required"]}}},watch:{selectedItemId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.form=n()({},t),a.item=n()({},t)}))()}},mounted(){if(!this.$store.getters.tableSelection.length)return;this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedItemId=this.selections[0].value;const e=this.$store.getters.tableSelection.find(e=>e.uuid===this.selectedItemId);this.form=n()({},e),this.item=n()({},e)},methods:{reset(){this.form={uuid:"",category:"",subcategory:"",name:"",itemcode:"",virture:"",brand:"",material:"",colour:"",profile:"",puom:"",suom:"",fraction:"",stdcost:"",markuprate:"",part:"",nonstdrate:"",installationcharges:"",dealerprice:"",active:"",oversea:"",overseadealerprice:""},this.selectedItemId="",this.item={}},onUpdateItem(){var e=this;return i()((function*(){const t=e.form,{$id:a,index:o}=t,s=Lr()(t,["$id","index"]);console.log({$id:a}),console.log({index:o});try{e.$q.loading.show(),yield e.$store.dispatch("UpdateLooseItem",s),e.$notify("success",`Item ${s.name} updated!`),e.$q.loading.hide()}catch(l){var r,i;e.$q.loading.hide();const t=null===(r=l.response)||void 0===r||null===(i=r.message)||void 0===i?void 0:i.error;e.$notify("error",t)}}))()}}},Yr=Qr,Jr=Object(b["a"])(Yr,zr,Gr,!1,null,null,null),Kr=Jr.exports,Hr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"myForm",on:{submit:e.onUpdateItem}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Category",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[e.form.category?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Subcategory",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.subcategory,callback:function(t){e.$set(e.form,"subcategory",t)},expression:"form.subcategory"}},[e.form.color_code?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Name",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.form.name?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Item code",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.itemcode,callback:function(t){e.$set(e.form,"itemcode",t)},expression:"form.itemcode"}},[e.form.itemcode?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Virture",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.virture},model:{value:e.form.virture,callback:function(t){e.$set(e.form,"virture",t)},expression:"form.virture"}},[e.form.virture?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Brand","lazy-rules":""},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},[e.form.brand?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Material","lazy-rules":""},model:{value:e.form.material,callback:function(t){e.$set(e.form,"material",t)},expression:"form.material"}},[e.form.material?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Colour","lazy-rules":""},model:{value:e.form.colour,callback:function(t){e.$set(e.form,"colour",t)},expression:"form.colour"}},[e.form.colour?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Profile","lazy-rules":""},model:{value:e.form.profile,callback:function(t){e.$set(e.form,"profile",t)},expression:"form.profile"}},[e.form.profile?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"UoM",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.puom},model:{value:e.form.uom,callback:function(t){e.$set(e.form,"uom",t)},expression:"form.uom"}},[e.form.uom?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Fraction",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.fraction,callback:function(t){e.$set(e.form,"fraction",e._n(t))},expression:"form.fraction"}},[e.form.fraction?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Standard cost",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.stdcost,callback:function(t){e.$set(e.form,"stdcost",e._n(t))},expression:"form.stdcost"}},[e.form.stdcost?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Markup rate",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.markuprate,callback:function(t){e.$set(e.form,"markuprate",e._n(t))},expression:"form.markuprate"}},[e.form.markuprate?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Part",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.part,callback:function(t){e.$set(e.form,"part",t)},expression:"form.part"}},[e.form.part?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Non standard rate","lazy-rules":""},model:{value:e.form.nonstdrate,callback:function(t){e.$set(e.form,"nonstdrate",e._n(t))},expression:"form.nonstdrate"}},[e.form.nonstdrate?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Installation charges",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.installationCharges,callback:function(t){e.$set(e.form,"installationCharges",e._n(t))},expression:"form.installationCharges"}},[e.form.installationCharges?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Dealer Price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.dealerPrice,callback:function(t){e.$set(e.form,"dealerPrice",e._n(t))},expression:"form.dealerPrice"}},[e.form.dealerPrice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Active",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.active},model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}},[e.form.active?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.oversea},model:{value:e.form.oversea,callback:function(t){e.$set(e.form,"oversea",t)},expression:"form.oversea"}},[e.form.oversea?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea Dealer Price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.overseaDealerPrice,callback:function(t){e.$set(e.form,"overseaDealerPrice",e._n(t))},expression:"form.overseaDealerPrice"}},[e.form.overseaDealerPrice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",type:"submit"}})],1)],1)])],1)},Vr=[],Wr={mixins:[x["a"]],data(){return{options:{virture:["Y","N"],puom:["Box","Btl","FR","Hole","Inch","MR","Nos","Pack","Pcs","Set","SF","SHT","SM","Trip","Tube","Unit"],suom:["Box","Btl","FR","Hole","Inch","MR","Nos","Pack","Pcs","Set","SF","SHT","SM","Trip","Tube","Unit"],active:["Active","Inactive"],oversea:["Y","N"]},dialog:{show:!1,userId:""},selectedItemId:"",item:{},errorMessage:"Field can't be blank",form:{uuid:"",category:"",subcategory:"",name:"",itemcode:"",virture:"",brand:"",material:"",colour:"",profile:"",uom:"",fraction:"",stdcost:"",markuprate:"",part:"",nonstdrate:"",installationCharges:"",dealerPrice:"",active:"",oversea:"",overseaDealerPrice:""}}},computed:n()({},Object(q["b"])(["tableSelection"])),validations:{form:{name:{required:M["required"]}}},watch:{selectedItemId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.form=n()({},t),a.item=n()({},t)}))()}},mounted(){if(!this.$store.getters.tableSelection.length)return;this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedItemId=this.selections[0].value;const e=this.$store.getters.tableSelection.find(e=>e.uuid===this.selectedItemId);this.form=n()({},e),this.item=n()({},e)},methods:{reset(){this.form={uuid:"",category:"",subcategory:"",name:"",itemcode:"",virture:"",brand:"",material:"",colour:"",profile:"",uom:"",fraction:"",stdcost:"",markuprate:"",part:"",nonstdrate:"",installationCharges:"",dealerPrice:"",active:"",oversea:"",overseaDealerPrice:""},this.selectedItemId="",this.item={}},onUpdateItem(){var e=this;return i()((function*(){const t=e.form,{$id:a,index:o}=t,s=Lr()(t,["$id","index"]);console.log({$id:a}),console.log({index:o});try{e.$q.loading.show(),yield e.$store.dispatch("UpdateOptionalItem",s),e.$notify("success",`Item ${s.name} updated!`),e.$q.loading.hide()}catch(l){var r,i;e.$q.loading.hide();const t=null===(r=l.response)||void 0===r||null===(i=r.message)||void 0===i?void 0:i.error;e.$notify("error",t)}}))()}}},Xr=Wr,Zr=Object(b["a"])(Xr,Hr,Vr,!1,null,null,null),ei=Zr.exports,ti=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"myForm",on:{submit:e.onUpdateItem}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Color code",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.color_code,callback:function(t){e.$set(e.form,"color_code",t)},expression:"form.color_code"}},[e.form.color_code?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Brand","lazy-rules":""},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},[e.form.brand?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Show in Sfm",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.showInCrm},model:{value:e.form.showInCrm,callback:function(t){e.$set(e.form,"showInCrm",t)},expression:"form.showInCrm"}},[e.form.showInCrm?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Profile",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.profile,callback:function(t){e.$set(e.form,"profile",t)},expression:"form.profile"}},[e.form.profile?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",e._n(t))},expression:"form.price"}},[e.form.price?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",type:"submit"}})],1)],1)])],1)},ai=[],oi={mixins:[x["a"]],data(){return{options:{showInCrm:["Y","N"]},dialog:{show:!1,userId:""},opts:{},selectedItemId:"",item:{},errorMessage:"Field can't be blank",form:{uuid:"",color_code:"",brand:"",showInCrm:"",profile:"",price:""}}},computed:n()({},Object(q["b"])(["tableSelection"])),validations:{form:{name:{required:M["required"]}}},watch:{selectedItemId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.form=n()({},t),a.item=n()({},t)}))()}},mounted(){if(!this.$store.getters.tableSelection.length)return;this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedItemId=this.selections[0].value;const e=this.$store.getters.tableSelection.find(e=>e.uuid===this.selectedItemId);this.form=n()({},e),this.item=n()({},e)},methods:{reset(){this.form={uuid:"",color_code:"",brand:"",showInCrm:"",profile:"",price:""},this.selectedItemId="",this.item={}},onUpdateItem(){var e=this;return i()((function*(){const t=e.form,{$id:a,index:o}=t,s=Lr()(t,["$id","index"]);console.log({$id:a}),console.log({index:o});try{e.$q.loading.show(),yield e.$store.dispatch("UpdateMaterialItem",s),e.$notify("success","Item updated!"),e.$q.loading.hide()}catch(l){var r,i;e.$q.loading.hide();const t=null===(r=l.response)||void 0===r||null===(i=r.message)||void 0===i?void 0:i.error;e.$notify("error",t)}}))()}}},si=oi,ri=Object(b["a"])(si,ti,ai,!1,null,null,null),ii=ri.exports,li=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-form",{ref:"myForm",on:{submit:e.onUpdateItem}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Category",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},[e.form.category?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Subcategory",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.subcategory,callback:function(t){e.$set(e.form,"subcategory",t)},expression:"form.subcategory"}},[e.form.subcategory?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Name",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.form.name?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Item code",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.itemcode,callback:function(t){e.$set(e.form,"itemcode",t)},expression:"form.itemcode"}},[e.form.itemcode?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Brand",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}},[e.form.brand?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Material",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.material,callback:function(t){e.$set(e.form,"material",t)},expression:"form.material"}},[e.form.material?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Colour",rules:[function(e){return e.length>0}],"lazy-rules":""},model:{value:e.form.colour,callback:function(t){e.$set(e.form,"colour",t)},expression:"form.colour"}},[e.form.colour?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"UoM",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.puom},model:{value:e.form.uom,callback:function(t){e.$set(e.form,"uom",t)},expression:"form.uom"}},[e.form.uom?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Standard cost",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.stdcost,callback:function(t){e.$set(e.form,"stdcost",e._n(t))},expression:"form.stdcost"}},[e.form.costdcostlor_code?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"SM Price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.SMPrice,callback:function(t){e.$set(e.form,"SMPrice",e._n(t))},expression:"form.SMPrice"}},[e.form.SMPrice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Markup rate",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.markuprate,callback:function(t){e.$set(e.form,"markuprate",e._n(t))},expression:"form.markuprate"}},[e.form.markuprate?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Dealer price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.dealerprice,callback:function(t){e.$set(e.form,"dealerprice",e._n(t))},expression:"form.dealerprice"}},[e.form.dealerprice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Active",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.active},model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}},[e.form.active?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea",rules:[function(e){return e.length>0}],"lazy-rules":"",options:e.options.oversea},model:{value:e.form.oversea,callback:function(t){e.$set(e.form,"oversea",t)},expression:"form.oversea"}},[e.form.oversea?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Oversea Dealer Price",rules:[function(e){return e>=0}],"lazy-rules":""},model:{value:e.form.overseaDealerPrice,callback:function(t){e.$set(e.form,"overseaDealerPrice",e._n(t))},expression:"form.overseaDealerPrice"}},[e.form.overseaDealerPrice?e._e():a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n            "+e._s(e.errorMessage)+"\n          ")])])],1),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",type:"submit"}})],1)],1)])],1)},ni=[],di={mixins:[x["a"]],data(){return{options:{puom:["Pcs","Unit"],suom:["Pcs","Unit"],active:["Active","Inactive"],oversea:["Y","N"]},dialog:{show:!1,userId:""},selectedItemId:"",item:{},errorMessage:"Field can't be blank",form:{uuid:"",category:"",subcategory:"",name:"",itemcode:"",brand:"",material:"",colour:"",uom:"",stdcost:"",SMPrice:"",markuprate:"",dealerprice:"",active:"",oversea:"",overseaDealerprice:"",createdAt:"",updatedAt:""}}},computed:n()({},Object(q["b"])(["tableSelection"])),validations:{form:{name:{required:M["required"]}}},watch:{selectedItemId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.form=n()({},t),a.item=n()({},t)}))()}},mounted(){if(!this.$store.getters.tableSelection.length)return;this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedItemId=this.selections[0].value;const e=this.$store.getters.tableSelection.find(e=>e.uuid===this.selectedItemId);this.form=n()({},e),this.item=n()({},e)},methods:{reset(){this.form={uuid:"",category:"",subcategory:"",name:"",itemcode:"",brand:"",material:"",colour:"",uom:"",stdcost:"",SMPrice:"",markuprate:"",dealerprice:"",active:"",oversea:"",overseaDealerprice:"",createdAt:"",updatedAt:""},this.selectedItemId="",this.item={}},onUpdateItem(){var e=this;return i()((function*(){const t=e.form,{$id:a,index:o}=t,s=Lr()(t,["$id","index"]);console.log({$id:a}),console.log({index:o});try{e.$q.loading.show(),yield e.$store.dispatch("UpdateServiceReportItem",s),e.$notify("success","Item updated!"),e.$q.loading.hide()}catch(l){var r,i;e.$q.loading.hide();const t=null===(r=l.response)||void 0===r||null===(i=r.message)||void 0===i?void 0:i.error;e.$notify("error",t)}}))()}}},ci=di,ui=Object(b["a"])(ci,li,ni,!1,null,null,null),mi=ui.exports,pi={components:{ModalDialog:v,SkEditItem:Br,SkEditLooseItem:Kr,SkEditOptionalItem:ei,SkEditMaterial:ii,SkEditServiceReportItem:mi},data(){return{dialog:{show:!1,userId:""},currentTabName:""}},computed:n()({},Object(q["b"])(["tableSelection"])),methods:{onShowDialog(){var e=this;return i()((function*(){const t=e.$store.getters.activeDataTab;e.currentTabName=e.$store.getters.datatabs[t].name}))()},reset(){}}},hi=pi,fi=Object(b["a"])(hi,Or,Nr,!1,null,null,null),gi=fi.exports,bi={components:{skActionsFinalOrderConfirmation:Ja,skActionsOrderConfirmation:_,skAddBranchDialog:N,skAddDrawingNumberDialog:U,skAddLeadDialog:H,skEditLeadDialog:Tr,skAddUserDialog:de,skAssignLeadToDesign:ge,skAssignLeadToScDialog:Ce,skAssignLeadsToBranchDialog:Me,skAssignScope:Re,skAssignToFco:Aa,skAssignUserRole:Ue,skBranchRRDialog:Je,skDeleteDialog:Ze,skDetailedQuotation:rt,skDisqualifiedOLDialog:ut,skDisqualifiedQLDialog:bt,skEditBranchDialog:wt,skEditUserDialog:It,skImportItemlistDialog:Rt,skImportOnlineLeadsDialog:Ut,skOpenKujialeDialog:Jt,skRequalifyQLDialog:Zt,skSubmitOrderConfirmationToAccount:ra,skSubmitToManager:Oa,skSummaryQuotation:fa,skViewFinalConfirmationOrder:Ua,skViewOrderConfirmation:xa,skFinalOrderConfirmationApproveForProduction:Za,skAddExhibition:ro,skDeleteExhibition:mo,skDownloadMissingItemsCsv:yo,skDownloadCalculationLogsCsv:ko,skEditItemListRoute:gi,skPendingVisit:$o,skSetLeadToLost:Fo,skCancelOrderConfirmation:Bo,skViewCampaign:Ko,skViewServiceReport:es,skActionsServiceReport:is,skCreateServiceReport:ms,skCreateReportMaintenance:ys,skViewReportMaintenance:ks,skSubmitToDetailerServiceReport:$s,skCompleteServiceReport:Fs,skSetDefaultCampaign:Bs,skCompleteTaskFinalOrderConfirmation:Ks,skImportOpItemlistDialog:er,skRejectionReasonLostDesignProposal:ir,skImportLooseItemlistDialog:mr,skImportMaterialListDialog:yr,SkReqCampaignChangesQLDialog:_r},data(){return{}}},yi=bi,vi=Object(b["a"])(yi,d,c,!1,null,null,null),qi=vi.exports,xi=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"text-center text-bold full-width"},[e._v("\n  Grand Total: RM "+e._s(e.grandTotal)+"\n")])},Ci=[],wi={data(){return{}},computed:n()(n()({},Object(q["b"])(["datatabs","activeDataTab"])),{},{grandTotal(){const{data:e}=this.datatabs[this.activeDataTab];return e.length?Object(j["g"])(e[0].calculateGrandTotal.toFixed(2)):0}})},ki=wi,_i=Object(b["a"])(ki,xi,Ci,!1,null,null,null),Si=_i.exports,Ai=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-menu",{model:{value:e.isMenuOpen,callback:function(t){e.isMenuOpen=t},expression:"isMenuOpen"}},[a("q-card",{staticStyle:{width:"300px"}},[e._l(Object.keys(e.options),(function(t){return a("q-card-section",{key:t},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n        "+e._s(t)+"\n      ")]),a("div",{staticClass:"fit row wrap justify-start items-start content-start"},[a("q-option-group",{attrs:{options:e.options[t].options,size:"sm",type:"checkbox"},model:{value:e.filter[e.options[t].field],callback:function(a){e.$set(e.filter,e.options[t].field,a)},expression:"filter[options[category].field]"}})],1)])})),a("q-separator"),a("q-card-actions",[a("q-btn",{attrs:{label:"Clear",size:"sm",color:"grey"},on:{click:e.onClickClearFilter}}),a("q-btn",{attrs:{label:"Set to Default",size:"sm",color:"grey"},on:{click:e.setDefaultFilter}}),a("q-space"),a("q-btn",{attrs:{label:"Filter",size:"sm",color:"primary"},on:{click:e.emitFilter}})],1)],2)],1)},Mi=[],Ii={props:{options:{type:Object,default:()=>({})}},data(){return{isMenuOpen:!1,filter:{}}},computed:{categories:function(){return Object.keys(this.options)}},created(){var e=this;return i()((function*(){console.log("TableSelectionFilter::created"),e.filter={},e.setDefaultFilter(),e.options&&e.emitFilter()}))()},methods:{setDefaultFilter(){console.log("TableSelectionFilter::category",this.categories.join(", "));for(const e of this.categories){let t=this.options[e].options.filter(e=>e.default);t.length&&(t=t.map(e=>e.value)),this.$set(this.filter,this.options[e].field,t)}console.log("TableSelectionFilter::defaults",JSON.stringify(this.filter))},onClickClearFilter(){for(const e of this.categories)this.$set(this.filter,this.options[e].field,[])},emitFilter(){this.filter.fromSelection=!0,this.$emit("filter",this.filter)}}},$i=Ii,Di=Object(b["a"])($i,Ai,Mi,!1,null,null,null),Ti=Di.exports,Oi=a("2b0e"),Ni=a("4360");const{getters:Ri}=Ni["a"],Fi=Ri.roles,ji=Oi["a"].prototype.$repository,Li=()=>({Hidden:{field:"isHidden",options:[{label:"Hidden",value:!1},{label:"Not Hidden",value:!0,default:!0}]}}),Ei=()=>({Type:{field:"displayType",options:[{label:"Home Branch",value:"Home Branch"},{label:"Dealer Branch",value:"Dealer Branch"}]}}),Pi=function(){var e=i()((function*(){const e=(yield ji.role.listing()).data.map(e=>({label:e.displayName,value:e.displayName}));return{Role:{field:"role",options:e}}}));return function(){return e.apply(this,arguments)}}(),Ui=function(){var e=i()((function*(){const e=(yield ji.branch.listing()).data.map(e=>({label:e.name,value:e.name}));return{Branch:{field:"branch_name",options:e}}}));return function(){return e.apply(this,arguments)}}(),Bi=function(){var e=i()((function*(){if(Object(j["c"])(Fi,["branchManager","salesconsultant"]))return;const e=Oi["a"].prototype.$repository,t=(yield e.branch.listing()).data.map(e=>({label:e.code,value:e.code}));return{"Branch Code":{field:"getBranchCode",options:t}}}));return function(){return e.apply(this,arguments)}}(),zi=()=>{const e=[{label:"New",value:"New",default:!0},{label:"Assigned",value:"Assigned",default:!0},{label:"Follow Up",value:"Pending Visit",default:!0},{label:"Disqualified",value:"disqualified"}];return{status:{field:"status",options:e}}},Gi=()=>{const e=[{label:"New",value:"raw",default:!0},{label:"Disqualified",value:"disqualified"}];return{status:{field:"status",options:e}}},Qi=()=>{const e=[{label:"New",value:"New",default:!0},{label:"Upload Payment / Document",value:"Upload Payment / Document",default:!0},{label:"Pending for Account or Manager approval",value:"Pending for Account or Manager approval",default:!0},{label:"Cancelled",value:"Cancelled",default:!0},{label:"Acknowledged",value:"Acknowledged",default:!0},{label:"Rejected",value:"Rejected",default:!0},{label:"FCO Submission",value:"FCO Submission"}];return{status:{field:"displayStatusForOC",options:e}}},Yi=()=>{const e=[{label:"New",value:"New"},{label:"Upload Payment / Document",value:"Upload Payment / Document"},{label:"Pending BM Approval",value:"Pending BM Approval"},{label:"Rejected - BM level 1",value:"Rejected - BM level 1"},{label:"Pending HQAC approval",value:"Pending HQAC approval"},{label:"Rejected - HQAC level 2",value:"Rejected - HQAC level 2"},{label:"Pending Detailer",value:"Pending Detailer"},{label:"Production",value:"Production"}];return{status:{field:"displayStatusForFCO",options:e}}},Ji=()=>{const e=[{label:"Proposal In Progress",value:"Proposal In Progress",default:!0},{label:"Pending Decision",value:"Pending Decision",default:!0},{label:"Won",value:"Won"},{label:"Lost",value:"Lost"}];return{status:{field:"status",options:e}}},Ki=()=>{const e=[{label:"New",value:"New"},{label:"Detailer",value:"Detailer"},{label:"Purchaser",value:"Purchaser"},{label:"Logistic",value:"Logistic"},{label:"Production",value:"Production"},{label:"Rejected",value:"Rejected"},{label:"Closed",value:"Closed"}];return{state:{field:"state",options:e}}},Hi=function(){var e=i()((function*(){return[{name:"usermanagement",filter:n()(n()({},yield Ui()),yield Pi())},{name:"branch",filter:n()({},Ei())},{name:"item",filter:{}},{name:"campaign",filter:n()({},Li())},{name:"onlineleads",filter:n()({},Gi())},{name:"qualifiedleads",filter:n()(n()({},zi()),yield Bi())},{name:"designproposal",filter:n()({},Ji())},{name:"orderconfirmation",filter:n()({},Qi())},{name:"finalconfirmation",filter:n()({},Yi())},{name:"servicereport",filter:n()({},Ki())},{name:"maintenancereport",filter:n()({},Ki())}]}));return function(){return e.apply(this,arguments)}}();var Vi={components:{DialogPlugins:qi,SkFooterOc:Si,TableSelectionFilter:Ti},data(){return{isTableFullscreen:!1,pagination:{rowsPerPage:0},tableData:[],selectionFilterOptions:null,filter:""}},computed:n()(n()(n()({},Object(q["b"])(["datatabs","activeDataTab","activeMenu"])),Object(q["c"])({activeMenu:e=>e.app.activeMenu,tableSelection:e=>e.app.tableSelection})),{},{selectionFilter:{set(e){this.filter=n()({},e)},get(e){return"string"===(this.filter,!1)?this.filter:{}}},textFilter:{set(e){this.filter=e},get(){return"string"===typeof this.filter?this.filter:""}},currentTab:{set(e){const t=this.datatabs.findIndex(t=>t.name===e);t>=0&&this.$store.dispatch("SetActiveDataTab",t)},get(){const e=this.datatabs[this.activeDataTab];return e?e.name:""}},selection:{set(e){this.$store.dispatch("OnTableSelection",e)},get(){return this.tableSelection}},computedTableHeight:function(){return this.isTableFullscreen?"300vh":"1000px"}}),watch:{activeMenu:function(){var e=i()((function*(){this.selectionFilterOptions=null,yield this.setSelectionFilterOptions(),this.filter={}}));return function(){return e.apply(this,arguments)}}()},created(){var e=this;return i()((function*(){yield e.setSelectionFilterOptions()}))()},methods:{filterTableData(e){const t=this.datatabs[this.activeDataTab].columns.map(e=>e.field);if("string"===typeof this.filter)return e.filter(e=>this.filterTableDataText(e,t));if(!this.filter.fromSelection)return e;const a=[];for(const o of Object.keys(this.filter))a.push(!this.filter[o].length);return a.every(e=>e)?e:e.filter(e=>this.filterTableDataSelection(e,t))},filterTableDataSelection(e,t){const a=[];for(const o of Object.keys(this.filter))"fromSelection"!==o&&(this.filter[o].length?a.push(this.filter[o].includes(e[o])):a.push(!0));return a.every(e=>!!e)},filterTableDataText(e,t){const a=this.filter.toLowerCase();for(const o of t)if("function"!==typeof o){if("string"===typeof e[o]&&null!==e[o]&&-1!==e[o].toLowerCase().indexOf(a))return!0}else{const t=o(e);if(!t)continue;if(-1!==t.toLowerCase().indexOf(a))return!0}},setSelectionFilterOptions(){var e=this;return i()((function*(){let t=yield Hi();t=t.find(t=>t.name===e.activeMenu).filter,e.selectionFilterOptions=n()({},t)}))()},onSelectionFilter(e){console.log("Main::onSelectionFilter",JSON.stringify(e)),this.selectionFilter=e},onClickCloseDataTab(e){this.$store.dispatch("CloseDataTab",e)}}},Wi=Vi,Xi=(a("1481"),Object(b["a"])(Wi,o,s,!1,null,null,null));t["default"]=Xi.exports}}]);