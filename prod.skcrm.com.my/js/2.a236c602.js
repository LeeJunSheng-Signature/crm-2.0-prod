(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"007d":function(e,t,a){"use strict";var s=a("ed08");const o={data(){return{textRules:e=>!!e.toString()&&e.toString().length,emailRules:e=>!e||Object(s["d"])(e),phoneNoRules:e=>!!e&&Object(s["e"])(e),floatRules:e=>!Number.isNaN(parseFloat(e))}}};t["a"]=o},1481:function(e,t,a){"use strict";var s=a("d617"),o=a.n(s);o.a},d617:function(e,t,a){},e5ee:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"q-pa-none q-gutter-y-sm"},[a("q-tabs",{attrs:{"inline-label":"",shrink:"",stretch:"",dense:"",align:"left"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},e._l(e.datatabs,(function(e){return a("q-tab",{key:e.name,attrs:{name:e.name,label:e.name}})})),1),e.datatabs[e.activeDataTab]?a("q-table",{staticClass:"sticky-table",style:{height:e.computedTableHeight},attrs:{selection:"single","virtual-scroll":"",columns:e.datatabs[e.activeDataTab].columns,data:e.datatabs[e.activeDataTab].data,"row-key":e.datatabs[e.activeDataTab].key,selected:e.selection,pagination:e.pagination,filter:e.filter,"filter-method":e.filterTableData},on:{"update:selected":function(t){e.selection=t},"update:pagination":function(t){e.pagination=t},"update:fullscreen":function(t){return e.isTableFullscreen=t}},scopedSlots:e._u([{key:"top",fn:function(t){return[a("q-btn",{attrs:{flat:"",dense:"",icon:"filter_alt",color:"primary"}},[null!==e.selectionFilterOptions?a("table-selection-filter",{attrs:{options:e.selectionFilterOptions},on:{filter:e.onSelectionFilter}}):e._e()],1),a("q-space"),a("q-input",{staticClass:"q-mr-md",attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.textFilter,callback:function(t){e.textFilter=t},expression:"textFilter"}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}}),["orderconfirmation","finalconfirmation"].includes(e.activeMenu)?a("sk-footer-oc"):e._e()]}}],null,!1,1182513194)}):e._e(),a("dialog-plugins")],1)},o=[],r=(a("c975"),a("ddb0"),a("c973")),i=a.n(r),l=a("ded3"),n=a.n(l),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("sk-add-user-dialog"),a("sk-edit-user-dialog"),a("sk-assign-scope"),a("sk-assign-user-role"),a("sk-add-branch-dialog"),a("sk-branch-RR-dialog"),a("sk-edit-branch-dialog"),a("sk-add-lead-dialog"),a("sk-import-online-leads-dialog"),a("sk-assign-lead-to-design"),a("sk-assign-lead-to-sc-dialog"),a("sk-assign-leads-to-branch-dialog"),a("sk-disqualified-o-l-dialog"),a("sk-disqualified-q-l-dialog"),a("sk-requalify-q-l-dialog"),a("sk-set-lead-to-lost"),a("sk-view-order-confirmation"),a("sk-actions-order-confirmation"),a("sk-submit-order-confirmation-to-account"),a("sk-cancel-order-confirmation"),a("sk-view-final-confirmation-order"),a("sk-actions-final-order-confirmation"),a("sk-complete-task-final-order-confirmation"),a("sk-final-order-confirmation-approve-for-production"),a("sk-detailed-quotation"),a("sk-summary-quotation"),a("sk-add-drawing-number-dialog"),a("sk-delete-dialog"),a("sk-import-itemlist-dialog"),a("sk-download-missing-items-csv"),a("sk-import-op-itemlist-dialog"),a("sk-open-kujiale-dialog"),a("sk-assign-to-fco"),a("sk-submit-to-manager"),a("sk-add-exhibition"),a("sk-delete-exhibition"),a("sk-view-campaign"),a("sk-set-default-campaign"),a("sk-pending-visit"),a("sk-view-service-report"),a("sk-actions-service-report"),a("sk-create-service-report"),a("sk-submit-to-detailer-service-report"),a("sk-complete-service-report"),a("sk-view-report-maintenance"),a("sk-create-report-maintenance")],1)},d=[],m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"actionsOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Order Confirmation Actions\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Acknowledge or Reject\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-card-actions",{staticClass:"bg-white text-dark q-gutter-sm",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:e.isDisabledReject},on:{click:e.onClickReject}}),e.isDisabledReject?a("q-tooltip",[e._v("\n            Remarks is required\n          ")]):e._e()],1),a("div",[a("q-btn",{attrs:{label:"Acknowledge",color:"positive"},on:{click:e.onClickAcknowledge}})],1)],1)],1)])],1)},u=[],p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{ref:"dialog",staticStyle:{width:"700px","max-width":"80vw"},attrs:{position:"right","full-height":""},on:{hide:e.onClose,show:e.onShow}},[e._t("default")],2)},h=[],f={props:{name:{type:String,required:!0}},data(){return{}},computed:{isActive(){return this.$store.getters.activeModal===this.name},isOpen(){return this.$store.getters.allOpen.includes(this.name)}},watch:{isActive(e,t){e?this.$refs.dialog.show():this.$refs.dialog.hide()}},beforeDestroy(){this.isOpen&&this.onClose()},methods:{onClose(){this.$store.dispatch("ModalClose",this.name),this.$emit("close-dialog")},onShow(){this.$emit("show-dialog")}}},g=f,b=a("2877"),y=Object(b["a"])(g,p,h,!1,null,null,null),v=y.exports,C=a("2f62"),x=a("007d"),q={components:{ModalDialog:v},mixins:[x["a"]],data(){return{remarks:""}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isDisabledReject(){return!this.remarks.length},isDisabledAcknowledge(){return!(!this.tableSelection[0]||"FCO"!==this.tableSelection[0].state)||"New"===this.tableSelection[0].status}}),methods:{onShowDialog(){var e=this;return i()((function*(){console.log(e.tableSelection)}))()},reset(){this.remarks=""},onClickAcknowledge(){var e=this;return i()((function*(){try{yield e.$store.dispatch("OrderConfirmationAcknowledged",{orderId:e.tableSelection[0].uuid}),e.$notify("success","Order state successfully updated")}catch(t){e.$notify("error","Order state failed to be updated")}}))()},onClickReject(){var e=this;return i()((function*(){try{e.$store.dispatch("OrderConfirmationRejected",{orderId:e.tableSelection[0].uuid,remarks:e.remarks}),e.$notify("success","Order state successfully updated")}catch(t){e.$notify("error","Order state failed to be updated")}}))()}}},w=q,k=Object(b["a"])(w,m,u,!1,null,null,null),_=k.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"addbranch"},on:{"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          New branch\n        ")])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Branch detail\n        ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-form",{ref:"myForm",on:{submit:e.onAddBranch}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Branch Name","bottom-slots":!1,"hide-hint":!0,rules:[e.onNameCheck],error:e.errormessage5.length>0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errormessage5.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage5)+"\n                ")])]):e._e()],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Branch Code","lazy-rules":"",debounce:"500",rules:[e.onBranchCodeCheck],error:e.errormessage.length>0},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}},[e.errormessage.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",options:e.opts.types,label:"Branch Type","emit-value":"","map-options":"","stack-label":"",rules:[e.onCheckType,e.textRules],error:e.errormessage12.length>0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e.errormessage12.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage12)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",placeholder:"07-2345678",label:"Telephone No.",mask:"## - ########","lazy-rules":"","unmasked-value":"",rules:[e.onMobileCheck],error:e.errormessage3.length>0},model:{value:e.form.telno,callback:function(t){e.$set(e.form,"telno",t)},expression:"form.telno"}},[e.errormessage3.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage3)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",placeholder:"07-23456789",label:"Fax No.",mask:"## - ########","unmasked-value":""},model:{value:e.form.faxno,callback:function(t){e.$set(e.form,"faxno",t)},expression:"form.faxno"}})],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Email",debounce:"500",rules:[e.onEmailCheck,e.emailRules],error:e.errormessage4.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errormessage4.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage4)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Address 1","aria-rowcount":"2",rules:[e.onAddressCheck,e.textRules],error:e.errormessage6.length>0},model:{value:e.form.address1,callback:function(t){e.$set(e.form,"address1",t)},expression:"form.address1"}},[e.errormessage6.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage6)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Address 2"},model:{value:e.form.address2,callback:function(t){e.$set(e.form,"address2",t)},expression:"form.address2"}}),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"State","lazy-rules":"",error:e.errormessage7.length>0,rules:[e.onStateCheck,e.textRules]},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[e.errormessage7.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage7)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Country","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errormessage8.length>0,rules:[e.onCountryCheck,e.textRules],options:e.countryOptions},on:{filter:e.filterFn},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},[e.errormessage8.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage8)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"SSM No.","lazy-rules":"",error:e.errormessage9.length>0,rules:[e.onSSMCheck,e.textRules]},model:{value:e.form.SSMNo,callback:function(t){e.$set(e.form,"SSMNo",t)},expression:"form.SSMNo"}},[e.errormessage9.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage9)+"\n                ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"GST No","lazy-rules":"",error:e.errormessage10.length>0,rules:[e.onGSTCheck,e.textRules]},model:{value:e.form.GSTNo,callback:function(t){e.$set(e.form,"GSTNo",t)},expression:"form.GSTNo"}},[e.errormessage10.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage10)+"\n                ")])]):e._e()],1),a("q-file",{ref:"fileupload",staticClass:"col q-pb-none",attrs:{accept:".png, .jpg, .jpeg",label:"Choose Logo",outlined:""},model:{value:e.fileUpload,callback:function(t){e.fileUpload=t},expression:"fileUpload"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errormessage.length>0||e.errormessage2.length>0||e.errormessage3.length>0||e.errormessage4.length>0||e.errormessage5.length>0||e.errormessage6.length>0||e.errormessage7.length>0||e.errormessage8.length>0},on:{click:e.onAddBranch}})],1)],1)])],1)],1)])],1)},D=[],I=(a("fb6a"),a("b5ae")),$=a("764d"),O=a("7f47"),T={components:{ModalDialog:v},mixins:[x["a"]],data(){return{fileUpload:null,countryOptions:[],form:{name:"",type:"",code:"",telno:"",faxno:"",email:"",address1:"",address2:"",state:"",country:"",SSMNo:"",logo:"",GSTNo:"",branchId:""},branchName:"",selections:[],errormessage:"",errormessage2:"",errormessage3:"",errormessage4:"",errormessage5:"",errormessage6:"",errormessage7:"",errormessage8:"",errormessage9:"",errormessage10:"",errormessage12:"",opts:{types:[{label:"Home Branch",value:"home"},{label:"Dealer Branch",value:"dealer"}]}}},computed:{branches(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},countries(){const e=O["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.name,t.flag=e.flag,t});return t}},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllCountries");const t=O["a"].all();e.form.country=t[135].name}))()},validations:{form:{password:{required:I["required"],minLength:Object(I["minLength"])(4)},mobile:{required:I["required"],minLength:Object(I["minLength"])(10)},username:{required:I["required"]},branchId:{required:I["required"]},role:{required:I["required"]},name:{required:I["required"]},code:{required:I["required"]},type:{required:I["required"]},telno:{required:I["required"]},email:{required:I["required"],email:I["email"]},address1:{required:I["required"]},state:{required:I["required"]},country:{required:I["required"]},SSMNo:{required:I["required"]}}},methods:{filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.countryOptions=this.countries.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.countryOptions=this.countries})},onShowDialog(){var e=this;return i()((function*(){e.$store.dispatch("GetAllCountries");const t=$["a"].query().where("name","HQ").first();e.form.branchId=t.uuid,e.branchName=t.name,e.countryOptions=e.countries;const a=O["a"].all();e.form.country=a[135].name}))()},reset(){const e=O["a"].all();this.errormessage="",this.errormessage2="",this.errormessage3="",this.errormessage4="",this.errormessage5="",this.errormessage6="",this.errormessage7="",this.errormessage8="",this.errormessage9="",this.errormessage10="",this.form={name:"",code:"",telno:"",faxno:"",email:"",address1:"",address2:"",state:"",country:e[135].name,SSMNo:"",GSTNo:"",logo:"",branchId:""}},onAddBranch(){var e=this;return i()((function*(){if(e.onBranchCodeCheck(),e.fileUpload){const t=yield e.$store.dispatch("UploadFile",e.fileUpload);e.form.logo=t.name}e.$v.form.$touch();const t=n()(n()({},e.form),{},{SSMNo:e.form.SSMNo.toString(),GSTNo:e.form.GSTNo.toString()});e.$refs.myForm.validate().then(function(){var a=i()((function*(a){a?(yield e.$store.dispatch("RegisterBranch",t),e.$refs.dialog.$children[0].hide(),e.$notify("success",`Branch with name ${t.name} created!`),e.reset()):e.$notify("error","All field is required")}));return function(e){return a.apply(this,arguments)}}())}))()},onEmailCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.email.length<=0?e.errormessage4="Field cant be blank":yield e.$store.dispatch("CheckEmailExist",e.form.email).then(t=>{e.errormessage4=t?"Email already exist":""})}))()},onBranchCodeCheck(){var e=this;return i()((function*(){e.form.code.length<=0?e.errormessage="Field cant be blank":yield e.$store.dispatch("CheckBranchCodeExist",e.form.code).then(t=>{e.errormessage=t?"Branch Code already exist":""})}))()},onAddressCheck(){this.$v.form.$touch(),this.form.address1.length<=0?this.errormessage6="Field cant blank":(console.log("dsad"),this.errormessage6="")},onStateCheck(){this.$v.form.$touch(),this.form.state.length<=0?this.errormessage7="Field cant blank":(console.log("dsad"),this.errormessage7="")},onCountryCheck(){this.$v.form.$touch(),this.form.country.length<=0?this.errormessage8="Field cant blank":this.errormessage8=""},onSSMCheck(){this.$v.form.$touch(),this.form.SSMNo.length<=0?this.errormessage9="Field cant blank":this.errormessage9=""},onGSTCheck(){this.$v.form.$touch(),this.form.GSTNo.length<=0?this.errormessage10="Field cant blank":this.errormessage10=""},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errormessage5="Field cant blank":this.errormessage5=""},onCheckType(){this.$v.form.$touch(),this.form.type.length<=0?this.errormessage12="Field cant blank":this.errormessage12=""},onFaxCheck(){var e=this;return i()((function*(){e.form.faxno<=0?e.errormessage2="Field cant be blank":(yield e.$store.dispatch("CheckFaxExist",e.form.faxno).then(t=>{e.errormessage2=t?"Fax number already exist":""}),e.form.faxno.length<=7&&(e.errormessage2="Fax No. must between 8-10 digits"))}))()},onMobileCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.telno.length<=0?e.errormessage3="Field cant be blank":(yield e.$store.dispatch("CheckMobileBranchExist",e.form.telno).then(t=>{e.errormessage3=t?"Mobile already exist":""}),e.form.telno.length<=7&&(e.errormessage3="Telephone No. must between 8-10 digits"))}))()}}},A=T,R=Object(b["a"])(A,S,D,!1,null,null,null),j=R.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"insertDrawingNumber"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Drawing Number\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            To generate quotation\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-form",{ref:"myForm",on:{submit:e.onClickSubmit}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Drawing Number",rules:[e.textRules]},model:{value:e.drawingId,callback:function(t){e.drawingId=t},expression:"drawingId"}}),a("div",{attrs:{align:"left"}},[a("q-btn",{attrs:{color:"primary",label:"Calculate"},on:{click:e.onClickSubmit}})],1),null!==e.totalPrice?a("q-separator",{staticClass:"q-my-md"}):e._e(),null!==e.totalPrice?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Total quotation price\n              ")]):e._e(),null!==e.totalPrice?a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Total Price (RM)",disable:""},model:{value:e.totalPrice,callback:function(t){e.totalPrice=t},expression:"totalPrice"}}):e._e(),a("div",{attrs:{align:"left"}},[null!==e.totalPrice&&"sysadmin"===e.roles[0]?a("q-btn",{attrs:{color:"primary",label:"Download Log"},on:{click:e.onClickDownloadLog}}):e._e()],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Drawing Reference\n              ")]),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.productReferences,label:"Product","emit-value":"","map-options":"","stack-label":""},model:{value:e.productName,callback:function(t){e.productName=t},expression:"productName"}}),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.areaReferences,label:"Area","emit-value":"","map-options":"","stack-label":""},model:{value:e.areaName,callback:function(t){e.areaName=t},expression:"areaName"}}),a("q-separator",{staticClass:"q-my-md"})],1)]),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Continue to Detailed Quotation"},on:{click:e.onClickDetailed}})],1)],1)])],1)])],1)},M=[],E=(a("2b3d"),a("ed08")),P={components:{ModalDialog:v},mixins:[x["a"]],data(){return{productReferences:["Kitchen Cabinet","Wardrobe","Walk-In Wardrobe","Bedroom Set","TV Console","Vanity Cabinet","Home Office Cabinet","Headboard & Side Table","Study Table & Book Cabinet","Chess of Drawer","Headboard","Bedside Table","Divan","Study Table","Book Cabinet","Laundry Cabinet","Show Cabinet","General Cabinet"],areaReferences:["Dry Kitchen","Wet Kitchen","Master Bedroom","Bedroom 1","Bedroom 2","Bedroom 3","Bedroom 4","Guest Room","Maid Room","Boys Room","Girls Room","Study Room","Prayers Room","Store Room","Master Bedroom","Bathroom 1","Bathroom 2","Bathroom 3","Bathroom 4","Powder Room","Living Hall","Family Hall","Dining Hall","Laundry Area","Pantry Area","Yard Area","Foyer"],selectedLeadId:"",selections:[],form:{},drawingId:"",totalPrice:null,lead:{},drawingReferenceName:null,productName:null,areaName:null}},computed:n()({},Object(C["b"])(["tableSelection","roles"])),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},methods:{onClickDownloadLog(){var e=this;return i()((function*(){const{data:t}=yield e.$repository.calculationLog.listing({where:{drawingNumber:e.drawingId},fields:{drawingNumber:!0,itemId:!0,parentItemId:!0,name:!0,brandGoodName:!0,brandGoodCode:!0,material:!0,colour:!0,profile:!0,width:!0,height:!0,depth:!0,totalItemProcessCost:!0,ccost:!0,stdCost:!0,markupRate:!0,nonStdRate:!0,totalCost:!0,rrp:!0,quantity:!0},order:["itemId ASC"]});for(const e of t)e.brandGoodCode||(e.brandGoodCode=""),e.brandGoodCode=e.brandGoodCode.replaceAll(",","|");const a=Object(E["f"])(t);let s=Object.keys(t[0]).join(",");s+="\r\n";var o=e.drawingId+"_calculation_log.csv",r=new Blob([s,a],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(void 0!==i.download){var l=URL.createObjectURL(r);i.setAttribute("href",l),i.setAttribute("download",o),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}))()},onShowDialog(){var e=this;return i()((function*(){e.selections=e.$store.getters.tableSelection,e.selections.length&&(e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value)}))()},onClickSubmit(){var e=this;return i()((function*(){e.lead=n()({},e.form),e.lead.drawingId=e.drawingId;try{const{totalDrawingPrice:t,message:a}=yield e.$store.dispatch("CalculateDrawing",e.lead);if(e.totalPrice=t,e.totalPrice=e.totalPrice.toFixed(2),a.length)throw new Error(a);e.$notify("success","Successfully calculate drawing")}catch(t){const a=t.response?t.response.data.error.message:t.message;e.$notify("error",a)}}))()},onClickDetailed(){var e=this;return i()((function*(){try{let t="";t=e.drawingId?yield e.$store.dispatch("GetDetailedQuotation",{uuid:e.lead.uuid,drawingId:e.lead.drawingId,drawingReferenceName:e.productName+", "+e.areaName}):yield e.$store.dispatch("CreateDetailedQuotation",{leadId:e.selectedLeadId,state:"DetailedQuotation",referenceName:e.productName+", "+e.areaName});const a=t.uuid;console.log(a);const s=e.$router.resolve({path:"/detailed-quotation/"+a});window.open(s.href,"_blank")}catch(t){const a=t.response.data.error.message;e.$notify("error",a)}}))()},reset(){this.calculate={leadId:"",drawingId:""}}}},L=P,F=Object(b["a"])(L,N,M,!1,null,null,null),U=F.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"walkinlead"},on:{"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Walk In Leads\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onAddLead}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Key in data for walk in user only\n            ")]),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Name","lazy-rules":"",rules:[e.onNameCheck,e.textRules],error:e.errormessage1.length>0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errormessage1.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage1)+"\n                ")])]):e._e()],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Email",type:"email",debounce:"1000",rules:[e.onEmailCheck,e.emailRules],error:e.errormessage2.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errormessage2.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage2)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",type:"tel",label:"Telephone No.","lazy-rules":"",rules:[e.onMobileCheck],error:e.errormessage3.length>0,mask:"### - #########","unmasked-value":""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}},[e.errormessage3.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage3)+"\n                  ")])]):e._e()],1)],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","lazy-rules":"",label:"Property Name",rules:[e.onLocationCheck,e.textRules],error:e.errormessage5.length>0},model:{value:e.form.property_type,callback:function(t){e.$set(e.form,"property_type",t)},expression:"form.property_type"}},[e.errormessage5.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage5)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.exhibitions,label:"Campaign","lazy-rules":"","map-options":"","emit-value":"",rules:[e.onExhibitionCheck],error:e.errormessage10.length>0},model:{value:e.form.exhibition,callback:function(t){e.$set(e.form,"exhibition",t)},expression:"form.exhibition"}},[e.errormessage10.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage10)+"\n                ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.leads,label:"Source of Lead","lazy-rules":"",rules:[e.onSourceCheck,e.textRules],error:e.errormessage6.length>0},model:{value:e.form.source_lead,callback:function(t){e.$set(e.form,"source_lead",t)},expression:"form.source_lead"}},[e.errormessage6.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage6)+"\n                ")])]):e._e()],1),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Customer Sales Type\n            ")]),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.type,label:"Lead Type","emit-value":"","map-options":"","lazy-rules":"",rules:[e.onTypeCheck,e.textRules],error:e.errormessage7.length>0},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e.errormessage7.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                  "+e._s(e.errormessage7)+"\n                ")])]):e._e()],1),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errormessage1.length>0||e.errormessage2.length>0||e.errormessage3.length>0||e.errormessage4.length>0||e.errormessage5.length>0||e.errormessage6.length>0||e.errormessage7.length>0},on:{click:e.onAddLead}})],1)],1)])],1)],1)])],1)},z=[],G=(a("5319"),a("b178"));const{formatDate:H}=G["e"];var Q={components:{ModalDialog:v},mixins:[x["a"]],data(){return{options:{roles:[],branches:[]},dialog:{show:!1,userId:"",roleArr:[]},opts:{exhibitions:[],propType:["Bungalow","Semi-D","Terrace","Townhouse","Apartment","ShopLot"],leads:["Social Media","Print Media","Referral","Exhibition"],type:[{label:"Corporate",value:"corporate"},{label:"Retail",value:"retail"}]},errormessage1:"",errormessage2:"",errormessage3:"",errormessage4:"",errormessage5:"",errormessage6:"",errormessage7:"",errormessage8:"",errormessage9:"",errormessage10:"",form:{name:"",email:"",phone:"",property_type:"",location:"",source_lead:"",campaign:"",exhibition:"",type:""}}},validations:{form:{name:{required:I["required"]},email:{required:I["required"],email:I["email"]},phone:{required:I["required"],minLength:Object(I["minLength"])(10)},property_type:{required:I["required"]},location:{required:I["required"]},source_lead:{required:I["required"]},type:{required:I["required"]},campaign:{required:I["required"]},exhibition:{required:I["required"]}}},watch:{"form.exhibition"(e){console.log(e)},"form.source_lead"(e){console.log(e)}},created(){},methods:{onShowDialog(){var e=this;return i()((function*(){const t=parseInt(H(Date.now(),"YYYYMMDD"));e.opts.exhibitions=(yield e.$store.dispatch("GetAllExhibitions")).filter(e=>{const a=parseInt(e.hideDate.replace(/\//g,""));return t<a}).map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t.status=e.status,t}),e.opts.exhibitions.filter(t=>{if(console.log("here",t.value),console.log("EXHIBITION HERE:   "+JSON.stringify(t)),"default"===t.status){const a=t.value;console.log("val here",a),e.form.exhibition=a,e.form.campaign=t.label}}),console.log("ex",e.form.campaign),console.log("log",e.opts.exhibitions)}))()},reset(){this.form={name:"",email:"",phone:"",property_type:"",location:"",source_lead:"",type:"",state:"QL",status:"active",campaign:"",exhibition:""}},onAddLead(){var e=this;return i()((function*(){const t=n()({},e.form);e.$refs.myForm.validate().then(function(){var a=i()((function*(a){a?(yield e.$store.dispatch("AddQualifiedLead",t),e.$notify("success",`Lead with name ${t.name} created!`),e.reset(),e.$refs.dialog.$children[0].hide()):e.$notify("error","All field is required")}));return function(e){return a.apply(this,arguments)}}())}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errormessage1="Field cant blank":this.errormessage1=""},onEmailCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.email.length<=0?e.errormessage2="Field cant be blank":yield e.$store.dispatch("LeadCheckEmailExist",e.form.email).then(t=>{e.errormessage2=t?"Email already exist":""})}))()},onMobileCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.phone.length<=0?e.errormessage3="Field cant be blank":(yield e.$store.dispatch("LeadCheckMobileExist",e.form.phone).then(t=>{e.errormessage3=t?"Mobile already exist":""}),e.form.phone.length<=9&&(e.errormessage3="Telephone No. must between 8-10 digits"))}))()},onPropertyCheck(){this.$v.form.$touch(),this.form.property_type.length<=0?this.errormessage4="Field cant blank":this.errormessage4=""},onLocationCheck(){this.$v.form.$touch(),this.form.property_type.length<=0?this.errormessage5="Field cant blank":this.errormessage5=""},onExhibitionCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.exhibition.length<=0?e.errormessage10="Field cant blank":e.errormessage10="";const t=e.opts.exhibitions.filter(t=>t.value===e.form.exhibition)[0];e.form.campaign=t.label}))()},onSourceCheck(){this.$v.form.$touch(),this.form.source_lead.length<=0?this.errormessage6="Field cant blank":this.errormessage6=""},onTypeCheck(){this.$v.form.$touch(),this.form.type.length<=0?this.errormessage7="Field cant blank":this.errormessage7=""}}},J=Q,Y=Object(b["a"])(J,B,z,!1,null,null,null),K=Y.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"adduser"}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          New User\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            User detail\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-form",{ref:"myForm",on:{submit:e.onAddUser}},[a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Login ID","lazy-rules":"",error:e.errormessage9.length>0,rules:[e.textRules,e.onLoginIdCheck]},model:{value:e.form.loginId,callback:function(t){e.$set(e.form,"loginId",t)},expression:"form.loginId"}},[e.errormessage9.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage9)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Full Name","lazy-rules":"",error:e.errormessage8.length>0,rules:[e.textRules,e.onNameCheck]},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errormessage8.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage8)+"\n                  ")])]):e._e()],1),a("q-input",{ref:"password",staticClass:"col q-pb-none",attrs:{outlined:"",type:e.type,rules:[e.textRules,e.onPasswordCheck],error:e.errormessage5.length>0,label:"Password"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-btn",{attrs:{round:"",flat:"",icon:"remove_red_eye"},on:{click:e.onClickShowPasswords}})]},proxy:!0}]),model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[e.errormessage5.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage5)+"\n                  ")])]):e._e()],1),a("div",{staticClass:"row "},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"User Code","lazy-rules":"",debounce:"1000",rules:[e.textRules,e.onSCCodeCheck],error:e.errormessage.length>0},model:{value:e.form.sccode,callback:function(t){e.$set(e.form,"sccode",t)},expression:"form.sccode"}},[e.errormessage.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errormessage)+"\n                    ")])]):e._e()],1),a("q-input",{ref:"mobile",staticClass:"col q-pl-xs q-pb-none",attrs:{outlined:"",label:"User Contact","lazy-rules":"",rules:[e.onMobileCheck],error:e.errormessage3.length>0,mask:"### - ########","unmasked-value":""},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}},[e.errormessage3.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errormessage3)+"\n                    ")])]):e._e()],1)],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"User Email","lazy-rules":"",debounce:"1000",rules:[e.onEmailCheck,e.emailRules],error:e.errormessage2.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errormessage2.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage2)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.branches,label:"Branch Name","emit-value":"","map-options":"","stack-label":"",rules:[e.textRules,e.onBranchCheck],error:e.errormessage7.length>0},model:{value:e.form.branchId,callback:function(t){e.$set(e.form,"branchId",t)},expression:"form.branchId"}},[e.errormessage7.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage7)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.roles,label:"User Role","emit-value":"","map-options":"","stack-label":"",rules:[e.textRules,e.onRoleCheck],error:e.errormessage6.length>0},on:{input:e.onInputFormRole},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}},[e.errormessage6.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage6)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Design Cad 4.0 AppUID","lazy-rules":"",debounce:"1000",rules:[e.onAppUIDCheck],error:e.errormessage11.length>0},model:{value:e.form.appUID,callback:function(t){e.$set(e.form,"appUID",t)},expression:"form.appUID"}},[e.errormessage11.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage11)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Design Cad 4.0 Email","lazy-rules":"",debounce:"1000",rules:[e.onKujialeEmailCheck,e.emailRules],error:e.errormessage10.length>0},model:{value:e.form.kujialeEmail,callback:function(t){e.$set(e.form,"kujialeEmail",t)},expression:"form.kujialeEmail"}},[e.errormessage10.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage10)+"\n                  ")])]):e._e()],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Scope Access\n              ")]),a("q-checkbox",{staticClass:"text-uppercase",attrs:{label:"Select All"},on:{input:e.onClickAllPermissions},model:{value:e.allPermission.selected,callback:function(t){e.$set(e.allPermission,"selected",t)},expression:"allPermission.selected"}}),a("q-separator",{staticClass:"q-my-md"}),e._l(e.permissionOptions.filter((function(e){return e.name.toLowerCase().includes("module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                Buttons Access\n              ")]),e._l(e.permissionOptions.filter((function(e){return!e.name.includes("Module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errormessage.length>0||e.errormessage2.length>0||e.errormessage3.length>0||e.errormessage4.length>0||e.errormessage5.length>0||e.errormessage6.length>0||e.errormessage7.length>0||e.errormessage8.length>0},on:{click:e.onAddUser}})],1)],2)])],1)])],1)])],1)},W=[],X=(a("4e82"),a("ebd1")),Z=a("4794"),ee=a("0006"),te=(a("07ac"),a("d600"));const ae=[te["a"].MODULE_QUALIFIED_LEADS,te["a"].MODULE_DESIGN_PROPOSAL,te["a"].MODULE_ORDER_CONFIRMATION,te["a"].MODULE_SERVICE_REPORT],se=[te["a"].MODULE_SERVICE_REPORT,te["a"].MODULE_MAINTENANCE_REPORT],oe=Object.values(te["a"]).filter(e=>e.includes("Module"));var re=Object.freeze({sysadmin:[...oe],callcenter:[...oe],marketing:[...oe],hQManager:[...oe],hQsalessupport:[...oe],hQAccountant:[...oe],salesconsultant:[...ae],branchManager:[...ae],detailer:[...se],purchaser:[...se],logistic:[...se],factory:[...se]}),ie={components:{ModalDialog:v},mixins:[x["a"]],data(){return{textRules:[e=>e&&e.length>0&&e.length<13],selectedUserId:"",sccode:"",form:{username:"",password:"",name:"",loginId:"",sccode:"",mobile:"",appUID:"",email:"",kujialeEmail:"",status:!0,module_access:"",designCAD_access:"",branchId:"",role:""},errormessage:"",errormessage2:"",errormessage3:"",errormessage4:"",errormessage5:"",errormessage6:"",errormessage7:"",errormessage8:"",errormessage9:"",errormessage10:"",errormessage11:"",type:"password",permissionOptions:[],allPermission:{selected:!1}}},validations:{form:{email:{required:I["required"],email:I["email"]},kujialeEmail:{email:I["email"]},password:{required:I["required"],minLength:Object(I["minLength"])(3)},mobile:{required:I["required"],minLength:Object(I["minLength"])(8)},name:{required:I["required"]},loginId:{required:I["required"]},branchId:{required:I["required"]},role:{required:I["required"]}}},computed:{branches(){const e=$["a"].all();console.log("pp",e),e.sort(this.dynamicSort("name"));const t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},roles(){const e=ee["a"].all();e.sort(this.dynamicSort("name"));const t=e.map(e=>{const t=[];return t.name=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.label=e.displayName,t.value=e.uuid,t});return t},users(){return X["a"].query().withAll().get()}},watch:{"allPermission.selected":function(e){e&&this.permissionOptions.forEach(e=>{e.selected=!0})},permissionOptions:{deep:!0,handler(e){const t=e.every(e=>e.selected);this.allPermission.selected=t}}},created(){var e=this;return i()((function*(){e.loadPermissionOptions()}))()},methods:{dynamicSort(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(a,s){return-1===t?s[e].localeCompare(a[e]):a[e].localeCompare(s[e])}},loadPermissionOptions(){var e=this;return i()((function*(){try{yield e.$store.dispatch("GetAllPermissions");const t=Z["a"].all().filter(e=>e.name.includes("Module")||"SKOpenExternalDesignCad"===e.name),a=["SKModuleUserManagement","SKModuleBranchManagement","SKModuleItemList","SKModuleCampaign","SKModuleOnlineLeads","SKModuleQualifiedLeads","SKModuleDesignProposal","SKModuleOrderConfirmation","SKModuleServiceReport","SKModuleMaintenanceReport","SKOpenExternalDesignCad"],s=a.map(e=>t.find(t=>t.name===e));e.permissionOptions=s,console.log("sorted",s)}catch(t){console.log(t)}}))()},reset(){this.errormessage="",this.errormessage2="",this.errormessage3="",this.errormessage4="",this.errormessage5="",this.errormessage6="",this.errormessage7="",this.errormessage8="",this.errormessage9="",this.errormessage10="",this.errormessage11="",this.form={username:"",password:"",name:"",sccode:"",appUID:"",mobile:"",email:"",kujialeEmail:"",status:!0,module_access:"",designCAD_access:"",branchId:"",role:""}},onAddUser(){var e=this;return i()((function*(){const t=n()({},e.form),a=[],s=e.permissionOptions.filter(e=>e.selected);s.forEach(e=>{a.push(e.getBodyRequest.uuid)}),e.$refs.myForm.validate().then(function(){var s=i()((function*(s){if(s){const s=yield e.$store.dispatch("RegisterUser",t);e.$refs.dialog.$children[0].hide();for(const t of a)yield e.$store.dispatch("AssignPermissionToUser",{userUuid:s.uuid,permissionUuid:t});console.log(t),e.$notify("success",`User with name ${t.name} created!`),e.reset()}else e.$notify("error","All field is required");e.permissionOptions.forEach(e=>{e.selected=!1})}));return function(e){return s.apply(this,arguments)}}())}))()},onClickShowPasswords(){"password"===this.type?this.type="text":this.type="password"},onInputFormRole(){let e=this.roles.find(e=>e.value===this.form.role).name;e=e.charAt(0).toLowerCase()+e.slice(1);const t=re[e];this.permissionOptions.forEach(e=>{e.selected=!!t.includes(e.name)})},onSCCodeCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.sccode.length<=0?e.errormessage="Field cannot be blank":yield e.$store.dispatch("CheckSCCodeExist",e.form.sccode).then(t=>{e.errormessage=t?"SC Code already exist":""})}))()},onEmailCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.email.length<=0?e.errormessage2="Field cant be blank":yield e.$store.dispatch("CheckEmailExist",e.form.email).then(t=>{e.errormessage2=t?"Email already exist":""})}))()},onKujialeEmailCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),0===e.form.kujialeEmail.length)return!0;yield e.$store.dispatch("CheckKujialeEmailExist",e.form.kujialeEmail).then(t=>{e.errormessage10=t?"Design Cad 4.0 Email already exist":""})}))()},onAppUIDCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),0===e.form.appUID.length)return!0;yield e.$store.dispatch("CheckAppUIDExist",e.form.appUID).then(t=>{e.errormessage11=t?"Design Cad 4.0 AppUID already exist":""})}))()},onMobileCheck(){var e=this;return i()((function*(){e.$v.form.$touch(),e.form.mobile.length<=0?e.errormessage3="Field cant be blank":(yield e.$store.dispatch("CheckMobileExist",e.form.mobile).then(t=>{e.errormessage3=t?"Mobile already exist":""}),e.form.mobile.length<=9&&(e.errormessage3="Telephone No. must between 10-11 digits"))}))()},onPasswordCheck(){this.$v.form.$touch(),this.form.password.length<4||this.form.password.length>12?this.errormessage5="Password length must be from 4 to 12 characters":this.errormessage5=""},onRoleCheck(){this.$v.form.$touch(),this.form.role.length<=0?this.errormessage6="Field cant blank":this.errormessage6=""},onLoginIdCheck(){this.$v.form.$touch(),this.form.loginId.length<=0?this.errormessage9="Field cant blank":this.errormessage9=""},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errormessage8="Field cant blank":this.errormessage8=""},onBranchCheck(){this.$v.form.$touch(),this.form.branchId.length<=0?this.errormessage7="Field cant blank":this.errormessage7=""},onMobileForm(){var e=this;return i()((function*(){e.$v.form.$touch(),Object(E["e"])(e.form.mobile)?e.errormessage3="":e.errormessage3="Fill mobile with the following format (012-3456789)"}))()},onClickAllPermissions(e){e?this.permissionOptions.forEach(e=>{e.selected=!0}):this.form.role?this.onInputFormRole():this.permissionOptions.forEach(e=>{e.selected=!1})}}},le=ie,ne=Object(b["a"])(le,V,W,!1,null,null,null),ce=ne.exports,de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"assigntodesign"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign Leads to Design Proposal\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Lead Details\n          ")]),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Email",disable:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Mobile",disable:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Site Address"},model:{value:e.form.siteAddress,callback:function(t){e.$set(e.form,"siteAddress",t)},expression:"form.siteAddress"}})],1),a("q-select",{attrs:{outlined:"",options:e.options.race,label:"Race","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.race,callback:function(t){e.$set(e.form,"race",t)},expression:"form.race"}}),a("q-select",{attrs:{outlined:"",options:e.options.age,label:"Age group","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.age,callback:function(t){e.$set(e.form,"age",t)},expression:"form.age"}}),a("q-separator"),a("div",{staticClass:"row justify-end"},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1),a("div",[a("q-btn",{attrs:{label:"submit",color:"primary",disabled:e.isBtnDisabled},on:{click:e.onAssignLeads}}),e.isBtnDisabled?a("q-tooltip",[e._v("\n                Lead is not assigned to a Sales Consultant\n              ")]):e._e()],1)])],1)])],1)])],1)},me=[],ue=a("a193"),pe={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{branchId:"",siteAddress:"",race:"",age:""},suggestedBranchId:"",options:{race:["Malay","Indian","Chinese","Others"],age:["13-20","21-30","31-40"]}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isBtnDisabled(){return"Assigned"!==this.form.status},selections(){const e=this.$store.getters.tableSelection;if(!e.length)return[];if(!e[0]instanceof ue["a"])return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},selections(e,t){e.length&&(this.selectedLeadId=this.selections[0].value)}},methods:{reset(){this.selectedLeadId="",this.form={}},onAssignLeads(){var e=this;return i()((function*(){const t=n()({},e.form);try{ue["a"].update({where:t.$id,data:t}),yield e.$store.dispatch("AssignLeadToDesign",t),e.$refs.dialog.$children[0].hide(),e.$notify("success","Successfully assigned lead to Design Proposal")}catch(a){console.log(a);const t=a.response.message.error;e.$notify("error",t)}}))()}}},he=pe,fe=Object(b["a"])(he,de,me,!1,null,null,null),ge=fe.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"qualifyQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign Leads to Sales Consultant\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Assign leads to Sales Consultant\n          ")]),"sysadmin"!==e.roles[0]?a("div",[a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.salesConsultantsOptions,label:"Selected sales consultant",disable:!e.salesConsultantsOptions.length,"emit-value":"","map-options":"","stack-label":""},model:{value:e.form.userId,callback:function(t){e.$set(e.form,"userId",t)},expression:"form.userId"}}),e.salesConsultantsOptions.length?e._e():a("q-tooltip",[e._v("\n              There are no Sales Consultant in your branch.\n            ")])],1):e._e(),"sysadmin"===e.roles[0]&&e.isSalesConsultantLoaded?a("div",e._l(Object.keys(e.branchesUsersMap),(function(t){return a("div",{key:t.value},[a("q-select",{staticClass:"col q-mt-sm",attrs:{outlined:"",options:e.branchesUsersMap[t],label:t,disable:!e.branchesUsersMap[t].length,"emit-value":"","map-options":"",clickable:"","stack-label":"","options-selected-class":"text-deep-orange"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"close"},on:{click:function(a){a.stopPropagation(),e.assignModel[t]=""}}})]},proxy:!0}],null,!0),model:{value:e.assignModel[t],callback:function(a){e.$set(e.assignModel,t,a)},expression:"assignModel[branch]"}}),e.branchesUsersMap[t].length?e._e():a("q-tooltip",[e._v("\n                There are no Sales Consultant in this branch.\n              ")])],1)})),0):e._e(),a("q-separator"),a("div",{staticClass:"row justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mr-md",attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"assign",color:"primary",disable:e.isAssignBtnDisabled},on:{click:e.onAssignLeads}}),e.isAssignBtnDisabled?a("q-tooltip",[e._v("\n                Lead is already assigned\n              ")]):e._e()],1)],1)],1)])],1)])],1)},ye=[],ve={components:{ModalDialog:v},data(){return{selectedLeadId:"",salesConsultants:[],form:{},selections:[],branchesUsersMap:{},assignModel:{},isSalesConsultantLoaded:!1}},computed:n()(n()({},Object(C["b"])(["tableSelection","roles"])),{},{isAssignBtnDisabled(){return"Assigned"===this.form.status||"Pending Visit"===this.form.status},salesConsultantsOptions(){if(!this.salesConsultants.length)return[];const e=this.salesConsultants.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t});return e},selectedSCName(){return this.form.userId?this.salesConsultantsOptions.find(e=>e.value===this.form.userId).label:""}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},assignModel:{deep:!0,handler(e){for(const t in e)if(e[t])return this.form.userId=e[t],void console.log(t,this.form.userId)}}},methods:{onShowDialog(){var e=this;return i()((function*(){if(e.selections=e.$store.getters.tableSelection,!e.selections.length)return;e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value,yield e.$store.dispatch("GetAllRoles");const t=ee["a"].query().where("name","salesconsultant").first().$id,a={where:{branchId:e.$store.state.user.branchId}};if(e.roles[0].includes("sysadmin")){yield e.$store.dispatch("GetAllBranches",{});const a=$["a"].all().filter(e=>"HQ"!==e.name);for(const t of a)e.branchesUsersMap[t.name]=[],e.$set(e.assignModel,t.name,"");e.salesConsultants=(yield e.$store.dispatch("GetRoleUsers",{id:t})).data.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t.branchId=e.branchId,t});for(const t of e.salesConsultants){const[a]=yield $["a"].query().withAll().whereId(t.branchId).get();"HQ"!==a.name&&(e.branchesUsersMap[a.name]||(e.branchesUsersMap[a.name]=[]),e.branchesUsersMap[a.name].push(t),e.branchesUsersMap[a.name].map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}))}}else e.salesConsultants=(yield e.$store.dispatch("GetRoleUsers",{id:t,filter:a})).data;e.isSalesConsultantLoaded=!0}))()},reset(){this.selectedLeadId="",this.form={}},onAssignLeads(){var e=this;return i()((function*(){const t=n()({},e.form);console.log("lead",t);try{yield e.$store.dispatch("AssignLeadToSC",t),e.$refs.dialog.$children[0].hide(),e.$notify("success","Successfully assigned lead"),console.log("entering ere")}catch(a){console.log("error cb here",a)}}))()}}},Ce=ve,xe=Object(b["a"])(Ce,be,ye,!1,null,null,null),qe=xe.exports,we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"qualifyOL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign Leads to Branch\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Assign branch to qualified lead\n          ")]),a("q-select",{staticClass:"col",attrs:{outlined:"",options:e.branches,label:"Assign to Branch","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.branchId,callback:function(t){e.$set(e.form,"branchId",t)},expression:"form.branchId"}}),a("q-input",{staticClass:"col",attrs:{type:"textarea",outlined:"",label:"Remark"},model:{value:e.form.noteToBranch,callback:function(t){e.$set(e.form,"noteToBranch",t)},expression:"form.noteToBranch"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"assign",color:"primary",disabled:e.isAssignBtnDisabled},on:{click:e.onAssignLeads}})],1)],1)])],1)])],1)},ke=[],_e={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{branchId:""},suggestedBranchId:""}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isAssignBtnDisabled(){return""===this.selectedLeadId||!this.form.branchId},branches(){const e=$["a"].all(),t=e.filter(e=>"HQ"!==e.name).map(e=>{const t={};return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection;if(!e.length)return[];if(!e[0]instanceof ue["a"])return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t},selectedBranchName(){return this.selectedBranchId?this.branches.find(e=>e.value===this.selectedBranchId).label:""}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},selections(e,t){e.length&&(this.selectedLeadId=this.selections[0].value)}},methods:{onShowDialog(){this.getBranchRecommendation()},getBranchRecommendation(){var e=this;return i()((function*(){e.selectedBranchId="";try{yield e.$store.dispatch("getRecommendedBranch").then(t=>{e.form.branchId=t.branch,e.suggestedBranchId=t.branch})}catch(t){e.$notify("error","Failed to get branch recommendation")}}))()},onAssignLeads(){var e=this;return i()((function*(){const t=n()({},e.form);try{console.log(t),yield e.$store.dispatch("AssignLeadToBranch",t),e.$refs.dialog.$children[0].hide(),e.$notify("success","Successfully assigned lead to branch "+e.selectedBranchName)}catch(a){console.log(a),e.$notify("error","Failed to assign lead to branch. Please try again")}}))()},reset(){this.selectedLeadId="",this.suggestedBranchId="",this.form={}}}},Se=_e,De=Object(b["a"])(Se,we,ke,!1,null,null,null),Ie=De.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"assignScope"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Assign scope access to modules\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a user\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected user","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedUserId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Roles\n            ")]),a("q-form",{ref:"myForm",on:{submit:e.onAssignUser}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"col"},[a("q-select",{attrs:{outlined:"",options:e.roles,"stack-label":"",label:"Roles",error:e.$v.form.role.$error},on:{input:e.onInputFormRole},model:{value:e.form.role,callback:function(t){e.$set(e.form,"role",t)},expression:"form.role"}})],1),a("div",{staticClass:"text-negative"},[e._v("\n                  "+e._s(e.errormessage)+"\n                ")]),a("div",{staticClass:"text-negative"},[e._v("\n                  "+e._s(e.errormessage2)+"\n                ")]),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                  Scope Access for User\n                ")]),a("q-checkbox",{staticClass:"text-uppercase",attrs:{label:"Select All"},on:{input:e.onClickAllPermissions},model:{value:e.allPermission.selected,callback:function(t){e.$set(e.allPermission,"selected",t)},expression:"allPermission.selected"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                  Modules Access\n                ")]),e._l(e.permissionOptions.filter((function(e){return e.name.includes("Module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n                  Buttons Access\n                ")]),e._l(e.permissionOptions.filter((function(e){return!e.name.includes("Module")})),(function(t){return a("div",{key:t.$id,staticClass:"text-uppercase"},[a("q-checkbox",{attrs:{label:t.nameDisplay},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"permission.selected"}})],1)})),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.errormessage.length>0||e.errormessage2.length>0},on:{click:e.onAssignUser}})],1)],2)])]:e._e()],2)])],1)])],1)},Oe=[],Te=a("0f30"),Ae={components:{ModalDialog:v},data(){return{textRules:[e=>e&&e.length>0],options:{roles:[]},selectedUserId:"",form:{role:{}},errormessage:"",errormessage2:"",type:"password",permissionOptions:[],allPermission:{selected:!1}}},validations:{form:{role:{required:I["required"]}}},computed:n()(n()({profile(){const e=Te["a"].query().where("userId",this.selectedUserId).first();return this.reassignProfile(e),e}},Object(C["b"])(["tableSelection"])),{},{users(){return X["a"].query().withAll().get()},roles(){const e=ee["a"].all(),t=e.map(e=>{const t=[];return t.name=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.label=e.displayName,t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection;if(!e.length)return[];if(!(e[0]instanceof X["a"]))return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{"allPermission.selected":function(e){e&&this.permissionOptions.forEach(e=>{e.selected=!0})},permissionOptions:{deep:!0,handler(e){this.allPermission.selected=e.every(e=>e.selected)}},selectedUserId(e,t){var a=this;return i()((function*(){if(a.selectedUserId){const e=yield a.$store.dispatch("GetUserPermissions",a.selectedUserId);a.permissionOptions.map(t=>{t.selected=!1;for(const a of e.data)t.uuid===a.uuid&&(t.selected=!0)}),yield a.$store.dispatch("GetUserRoles",a.selectedUserId);const t=X["a"].query().withAll().where("uuid",a.selectedUserId).first();if(t.roles.length){const e=a.options.roles.find(e=>e.value===t.roles[0].$id);a.form.role=e}}a.errormessage=""}))()},selections(e,t){e.length&&(this.selectedUserId=e[0].value)}},created(){var e=this;return i()((function*(){e.loadRoleOptions(),e.loadPermissionOptions()}))()},methods:{reset(){this.selectedUserId="",this.errormessage="",this.errormessage2="",this.form={role:""}},onAssignUser(){var e=this;return i()((function*(){const t=e.permissionOptions.filter(e=>e.selected),a=[];for(const e of t)a.push(e.uuid);try{yield e.$store.dispatch("UpdateUserPermission",{userId:e.selectedUserId,permissionIds:a,rolesIds:[e.form.role.value]}),e.$refs.dialog.$children[0].hide(),e.$notify("success","User roles & permissions have been updated.")}catch(s){console.log(s),e.$notify("error","Error updating user roles & permissions. Try again.")}}))()},loadRoleOptions(){var e=this;return i()((function*(){const t=yield e.$store.dispatch("GetAllRoles");t.forEach(t=>{e.options.roles.push({value:t.uuid,label:t.name.charAt(0).toUpperCase()+t.name.slice(1)})})}))()},loadPermissionOptions(){var e=this;return i()((function*(){try{yield e.$store.dispatch("GetAllPermissions"),e.permissionOptions=Z["a"].all().filter(e=>e.name.includes("Module")||"SKOpenExternalDesignCad"===e.name)}catch(t){console.log(t)}}))()},onInputFormRole(){if(!this.form.role.value)return;let e=this.options.roles.find(e=>e.value===this.form.role.value).label;e=e.charAt(0).toLowerCase()+e.slice(1);const t=re[e];this.permissionOptions.forEach(e=>{e.selected=!!t.includes(e.name)})},onClickAllPermissions(e){e?this.permissionOptions.forEach(e=>{e.selected=!0}):this.form.role?this.onInputFormRole():this.permissionOptions.forEach(e=>{e.selected=!1})}}},Re=Ae,je=Object(b["a"])(Re,$e,Oe,!1,null,null,null),Ne=je.exports,Me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"userassignrole"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          User Role Edit\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a user\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected user","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedUserId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Select user roles\n            ")]),a("q-option-group",{attrs:{options:e.rolesOpt,label:"Roles",type:"checkbox"},model:{value:e.form.roles,callback:function(t){e.$set(e.form,"roles",t)},expression:"form.roles"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Update"},on:{click:e.onUpdateUser}})],1)]:e._e()],2)])],1)])],1)},Ee=[],Pe={components:{ModalDialog:v},data(){return{selectedUserId:"",form:{roles:[]}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{rolesOpt(){const e=ee["a"].all(),t=e.map(e=>{const t={};return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection,t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,this.loadUserRole(e.uuid),t});return t}}),watch:{selectedUserId(e,t){const a=X["a"].query().where("uuid",this.selectedUserId).withAll().first();if(this.form.roles=[],a.roles)for(const s of a.roles)this.form.roles.push(s.uuid)}},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllRoles")}))()},methods:{reset(){this.selectedUserId="",this.form={}},loadUserRole(e){var t=this;return i()((function*(){try{yield t.$store.dispatch("GetUserRoles",e)}catch(a){const e=a.response.message.error;t.$notify("error",e)}}))()},onUpdateUser(){var e=this;return i()((function*(){try{for(const t of e.form.roles)yield e.$store.dispatch("AssignUserRole",{userId:e.selectedUserId,roleId:t});e.$refs.dialog.$children[0].hide(),e.$notify("success",`User with name ${e.form.name} updated!`)}catch(t){console.log(t);const a=t.response.message.error;e.$notify("error",a)}}))()}}},Le=Pe,Fe=Object(b["a"])(Le,Me,Ee,!1,null,null,null),Ue=Fe.exports,Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"rrbranch"},on:{"show-dialog":e.setupBranchesList,"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n        Arrange Branches\n      ")])]),a("div",{staticClass:"q-pa-md"},[e.form.length>0?a("q-list",[a("q-item",{staticClass:"row"},[a("q-item-section",{staticClass:"col-2"},[e._v("\n            Priority\n          ")]),a("q-item-section",{staticClass:"col"},[e._v("\n            Branch Name\n          ")]),a("q-item-section",{staticClass:"col-2"},[e._v("\n            Sales Consultant Available\n          ")]),a("q-item-section",{staticClass:"col-2"},[e._v("\n            Multiplier\n          ")]),a("q-item-section",{staticClass:"col-2"},[e._v("\n            Capacity\n          ")])],1),e._l(e.branches,(function(t,s){return a("q-item",{key:t.uuid,staticClass:"row"},[e.form[s]?a("q-item-section",{staticClass:"col-2"},[a("q-input",{attrs:{filled:"",dense:"",min:1,type:"number",error:e.hasSamePriorities(e.form[s].priority,s)||e.isValidPriorityValue(e.form[s].priority,s)},scopedSlots:e._u([{key:"error",fn:function(){return[e._v("\n                "+e._s(e.errors[s].priority)+"\n              ")]},proxy:!0}],null,!0),model:{value:e.form[s].priority,callback:function(t){e.$set(e.form[s],"priority",e._n(t))},expression:"form[index].priority"}})],1):e._e(),a("q-item-section",{staticClass:"col q-mb-md"},[e._v("\n            "+e._s(t.name)+" ("+e._s(t.code)+")\n          ")]),e.form[s]?a("q-item-section",{staticClass:"col-2 q-mb-md"},[a("q-input",{attrs:{filled:"",dense:"",disable:""},model:{value:e.form[s].scCount,callback:function(t){e.$set(e.form[s],"scCount",e._n(t))},expression:"form[index].scCount"}})],1):e._e(),e.form[s]?a("q-item-section",{staticClass:"col-2"},[a("q-input",{attrs:{filled:"",dense:"",min:0,step:"0.5",type:"number",error:e.isValidMultiplierValue(e.form[s].multiplier,s)},scopedSlots:e._u([{key:"error",fn:function(){return[e._v("\n                "+e._s(e.errors[s].multiplier)+"\n              ")]},proxy:!0}],null,!0),model:{value:e.form[s].multiplier,callback:function(t){e.$set(e.form[s],"multiplier",e._n(t))},expression:"form[index].multiplier"}})],1):e._e(),e.form[s]?a("q-item-section",{staticClass:"col-2 q-mb-md"},[a("q-input",{attrs:{filled:"",dense:""},model:{value:e.form[s].leadcapacity,callback:function(t){e.$set(e.form[s],"leadcapacity",e._n(t))},expression:"form[index].leadcapacity"}})],1):e._e()],1)}))],2):e._e(),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"row justify-between"},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Close"}}),a("q-btn",{attrs:{color:"primary",label:"Save",disabled:e.isSaveButtonDisabled},on:{click:e.onClickSave}})],1)])],1)],1)],1)},ze=[],Ge=(a("a434"),{components:{ModalDialog:v},data(){return{form:[],branches:[],errors:[]}},computed:{fakeForm(){return JSON.parse(JSON.stringify(this.form))},isSaveButtonDisabled(){return this.form.some((e,t)=>this.hasSamePriorities(e.priority,t)||this.isValidPriorityValue(e.priority,t)||this.isValidMultiplierValue(e.multiplier,t))}},watch:{fakeForm:{deep:!0,handler(e,t){if(e.length!==t.length)return;const[a]=e.filter((e,a)=>e.multiplier!==t[a].multiplier);if(!a)return;const s=this.form.findIndex(e=>e.uuid===a.uuid);this.form[s].leadcapacity=parseInt(this.form[s].scCount*this.form[s].multiplier)}}},methods:{setupBranchesList(){var e=this;return i()((function*(){e.branches=yield $["a"].query().where("code",e=>"HQ"!==e).orderBy("priority","ASC").get();const{data:t}=yield e.$repository.role.listing({where:{name:"salesconsultant"}}),[a]=t;for(const s of e.branches){const{data:t}=yield e.$repository.role.users(a.uuid,{where:{branchId:s.uuid}}),{length:o}=t;e.form.push({isInRR:!!s.isInRR&&s.isInRR,multiplier:s.multiplier,priority:s.priority,scCount:o,leadcapacity:s.leadcapacity?s.leadcapacity:0,type:s.type,uuid:s.uuid})}}))()},onClickSave(){var e=this;return i()((function*(){try{for(const t of e.form)yield e.$store.dispatch("UpdateBranchRotation",t);e.$refs.dialog.$children[0].hide(),e.$notify("success","Branch round robin configuration successfully updated!")}catch(t){console.log(t),e.$notify("error","Branch round robin configuration faile to be updated!")}}))()},hasSamePriorities(e,t){this.errors[t]||(this.errors[t]={}),e=parseInt(e);const a=this.form.map(e=>e.priority);return a.splice(t,1),!!a.some(t=>t===e)&&(this.errors[t].priority="No similar priorities.",!0)},isValidMultiplierValue(e,t){this.errors[t]||(this.errors[t]={}),e=parseFloat(e);const a=(e,t,a)=>e>t&&e<a;return e<0||a(e,0,.5)?(this.errors[t].multiplier="multiplier must be 0 or more than 0.5.",!0):!!Number.isNaN(e)&&(this.errors[t].multiplier="multiplier required.",!0)},isValidPriorityValue(e,t){return this.errors[t]||(this.errors[t]={}),e=parseInt(e),e<1?(this.errors[t].priority="Priority must be more than 1.",!0):!!Number.isNaN(e)&&(this.errors[t].priority="Priority required.",!0)},reset(){this.form=[]}}}),He=Ge,Qe=Object(b["a"])(He,Be,ze,!1,null,null,null),Je=Qe.exports,Ye=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"delete"}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Are you sure?\n      ")])]),a("q-card-section",{staticClass:"row items-center"},[e._v("\n      Do you really want to delete this\n      "),a("span",{staticClass:"text-weight-bold"},[e._v(e._s(e.tableSelection.length)+" record(s)")]),e._v(" ?\n    ")]),a("q-card-section",{staticClass:"row items-center text-negative text-weight-bold"},[e._v("\n      This process cannot be undone\n    ")]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Delete",color:"negative"},on:{click:e.onClickDelete}})],1)],1)],1)},Ke=[],Ve={components:{ModalDialog:v},computed:n()({},Object(C["b"])(["datatabs","activeDataTab","tableSelection"])),methods:{onClickDelete(){var e=this;this.tableSelection.forEach(function(){var t=i()((function*(t){try{yield e.$store.dispatch("DeleteData",t.uuid),e.$refs.dialog.$children[0].hide(),e.$notify("success","Delete item successful!")}catch(a){const t=a.response.data.error.message;console.log(t),e.$notify("error","Error: "+t)}}));return function(e){return t.apply(this,arguments)}}()),this.$store.dispatch("OnTableSelection",[])}}},We=Ve,Xe=Object(b["a"])(We,Ye,Ke,!1,null,null,null),Ze=Xe.exports,et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"detailedQuotation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Detailed Quotation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Drawings\n          ")]),a("q-separator",{staticClass:"q-my-md"}),e._l(e.drawings,(function(t){return a("q-list",{key:t.uuid,staticClass:"row"},[a("q-chip",{staticClass:"row q-ml-lg",attrs:{color:"primary","text-color":"white"}},[e._v("\n              "+e._s(t.referenceName)+"\n            ")]),a("div",{staticClass:"row justify-center"},[a("q-checkbox",{attrs:{val:t.uuid},model:{value:e.drawingSelections,callback:function(t){e.drawingSelections=t},expression:"drawingSelections"}}),a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Drawing Number",disable:""},model:{value:t.drawingNumber,callback:function(a){e.$set(t,"drawingNumber",a)},expression:"drawing.drawingNumber"}}),a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Total Price (RM)",disable:""},model:{value:t.discountedTotalPrice,callback:function(a){e.$set(t,"discountedTotalPrice",a)},expression:"drawing.discountedTotalPrice"}}),a("q-btn",{attrs:{outline:"",color:"primary",label:"Edit","no-caps":""},on:{click:function(a){return e.onClickDetailed(t.uuid)}}})],1)],1)}))],2)]),e.drawings.length?a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Additional Charges\n        ")]),a("q-separator",{staticClass:"q-mb-md"}),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Lump Sum Discount")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{label:"Lump Sum",value:e.lumpsum,prefix:"RM",outlined:"",dense:""},model:{value:e.lumpsum,callback:function(t){e.lumpsum=e._n(t)},expression:"lumpsum"}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Worktop Outstation Charges")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{value:e.drawings[0].installerOutstationCharge,prefix:"RM",outlined:"",dense:"",disable:""}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Include"},model:{value:e.drawings[0].isIncludedWorktopOutstationCharge,callback:function(t){e.$set(e.drawings[0],"isIncludedWorktopOutstationCharge",t)},expression:"drawings[0].isIncludedWorktopOutstationCharge"}})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Installation Charges")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{prefix:"RM",value:e.totalInstallationCharges,outlined:"",dense:"",disable:""}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Include"},model:{value:e.drawings[0].isIncludedInstallationCharge,callback:function(t){e.$set(e.drawings[0],"isIncludedInstallationCharge",t)},expression:"drawings[0].isIncludedInstallationCharge"}})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Installer Outstation Charges")])]),a("q-input",{staticClass:"col",attrs:{label:"Distance",suffix:"KM",outlined:"",dense:""},model:{value:e.drawings[0].installerOutstationDistance,callback:function(t){e.$set(e.drawings[0],"installerOutstationDistance",e._n(t))},expression:"drawings[0].installerOutstationDistance"}}),a("q-input",{staticClass:"col",attrs:{value:e.drawings[0].installerOutstationCharge,prefix:"RM",outlined:"",dense:"",disable:""}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Include"},model:{value:e.drawings[0].isIncludedInstallerOutstationCharge,callback:function(t){e.$set(e.drawings[0],"isIncludedInstallerOutstationCharge",t)},expression:"drawings[0].isIncludedInstallerOutstationCharge"}})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Transportation Charges")])]),a("q-input",{staticClass:"col",attrs:{label:"Distance",suffix:"KM",outlined:"",dense:""},model:{value:e.drawings[0].transportationDistance,callback:function(t){e.$set(e.drawings[0],"transportationDistance",e._n(t))},expression:"drawings[0].transportationDistance"}}),a("q-input",{staticClass:"col",attrs:{value:e.drawings[0].transportationCharge,prefix:"RM",outlined:"",dense:"",disable:""}}),a("q-checkbox",{staticClass:"col",attrs:{label:"Include"},model:{value:e.drawings[0].isIncludedTransportationCharge,callback:function(t){e.$set(e.drawings[0],"isIncludedTransportationCharge",t)},expression:"drawings[0].isIncludedTransportationCharge"}})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"}),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{value:e.totalAdditionalCharge,prefix:"RM",label:"Total Charges",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1),a("div",{staticClass:"row q-gutter-sm"},[a("div",{staticClass:"col"},[a("p",[e._v("Grand Total")])]),a("div",{staticClass:"col"}),a("q-input",{staticClass:"col",attrs:{value:e.grandTotal,prefix:"RM",label:"Grand Total",outlined:"",dense:"",disable:""}}),a("div",{staticClass:"col"})],1)],1):e._e(),a("q-card-actions",{attrs:{align:"right"}},[a("div",{staticClass:"q-mt-lg",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Calculate Additional Charges","no-caps":""},on:{click:e.onClickCalculateAdditionalCharges}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{color:"primary",label:"To Summary","no-caps":""},on:{click:function(t){return e.onClickSubmit()}}})],1)])],1)])],1)},tt=[],at={components:{ModalDialog:v},mixins:[x["a"]],data(){return{selectedLeadId:"",selections:[],drawingSelections:[],form:{},drawings:{},isSummary:null,lumpsum:0}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{totalInstallationCharges(){let e=0;return this.drawings.forEach(t=>{this.drawingSelections.includes(t.uuid)&&(e+=t.totalInstallationCharges)}),Math.ceil(e)},totalAdditionalCharge(){const[e]=this.drawings,{transportationCharge:t,installerOutstationCharge:a,isIncludedInstallationCharge:s,isIncludedTransportationCharge:o,isIncludedInstallerOutstationCharge:r}=e;let i=0;return i+=s?this.totalInstallationCharges:0,i+=o?t:0,i+=r?a:0,Math.ceil(i.toFixed(2))},grandTotal(){const[e]=this.drawings,{transportationCharge:t,installerOutstationCharge:a,isIncludedInstallationCharge:s,isIncludedTransportationCharge:o,isIncludedInstallerOutstationCharge:r}=e;let i=0;i+=s?this.totalInstallationCharges:0,i+=o?t:0,i+=r?a:0;let l=0,n=0;return console.log("aa",this.drawings),this.drawings.forEach(e=>{console.log("d",e.isToSummary),this.drawingSelections.includes(e.uuid)&&(n+=e.discountedTotalPrice)}),l+=n+i,l-=this.lumpsum,Math.ceil(l.toFixed(2))}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},methods:{onShowDialog(){var e=this;return i()((function*(){if(e.selections=e.$store.getters.tableSelection,!e.selections.length)return;e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value;const t=yield e.$store.dispatch("GetDetailedQuotations",e.selectedLeadId);e.drawings=t;for(let a=0;a<e.drawings.length;a++)e.drawings[a].totalPrice=Math.ceil(e.drawings[a].totalPrice),e.drawings[a].discountedTotalPrice=Math.ceil(e.drawings[a].discountedTotalPrice),e.drawings[a].discountedTotalPriceDrawingItems=Math.ceil(e.drawings[a].discountedTotalPriceDrawingItems),e.drawings[a].transportationCharge=Math.ceil(e.drawings[a].transportationCharge),e.drawings[a].totalInstallationCharges=Math.ceil(e.drawings[a].totalInstallationCharges),e.drawings[a].totalPriceTradingItems=Math.ceil(e.drawings[a].totalPriceTradingItems);e.lumpsum=e.drawings[0].lumpsum,console.log("res: "+JSON.stringify(e.drawings))}))()},onClickDetailed(e){var t=this;return i()((function*(){try{const a=t.$router.resolve({path:"/detailed-quotation/"+e});window.open(a.href,"_blank")}catch(a){console.log(a.response)}}))()},onClickSubmit(){var e=this;return i()((function*(){console.log("dasdsa",JSON.stringify(e.drawingSelections));try{yield e.$store.dispatch("UpdateDesignState",{leadId:e.selectedLeadId,designIds:e.drawingSelections}),e.$notify("success","Successfully moved to summary quotation");const t=yield e.$store.dispatch("GetDetailedQuotations",e.selectedLeadId);e.drawings=t;for(let a=0;a<e.drawings.length;a++)e.drawings[a].totalPrice=Math.ceil(e.drawings[a].totalPrice),e.drawings[a].discountedTotalPrice=Math.ceil(e.drawings[a].discountedTotalPrice),e.drawings[a].discountedTotalPriceDrawingItems=Math.ceil(e.drawings[a].discountedTotalPriceDrawingItems),e.drawings[a].transportationCharge=Math.ceil(e.drawings[a].transportationCharge),e.drawings[a].totalInstallationCharges=Math.ceil(e.drawings[a].totalInstallationCharges),e.drawings[a].totalPriceTradingItems=Math.ceil(e.drawings[a].totalPriceTradingItems)}catch(t){console.log(t)}}))()},onClickCalculateAdditionalCharges(){var e=this;return i()((function*(){const[t]=e.drawings,{isIncludedInstallationCharge:a,isIncludedInstallerOutstationCharge:s,isIncludedTransportationCharge:o,isIncludedWorktopOutstationCharge:r,isToSummary:i}=t;let{transportationDistance:l,installerOutstationDistance:n}=t;l=parseFloat(l),n=parseFloat(n);for(const d of e.drawings)yield e.$repository.lead.updateDesignById(d.uuid,{isIncludedInstallationCharge:a,isIncludedInstallerOutstationCharge:s,isIncludedTransportationCharge:o,isIncludedWorktopOutstationCharge:r,transportationDistance:l,installerOutstationDistance:n,isToSummary:!!i,lumpsum:e.lumpsum?e.lumpsum:0});const c=yield e.$store.dispatch("GetDetailedQuotations",e.selectedLeadId);e.drawings=c;for(let d=0;d<e.drawings.length;d++)e.drawings[d].totalPrice=Math.ceil(e.drawings[d].totalPrice),e.drawings[d].discountedTotalPrice=Math.ceil(e.drawings[d].discountedTotalPrice),e.drawings[d].discountedTotalPriceDrawingItems=Math.ceil(e.drawings[d].discountedTotalPriceDrawingItems),e.drawings[d].transportationCharge=Math.ceil(e.drawings[d].transportationCharge)}))()},reset(){this.drawings=[],this.drawingSelections=[],this.form={}}}},st=at,ot=Object(b["a"])(st,et,tt,!1,null,null,null),rt=ot.exports,it=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"disqualifyOL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Disqualify Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedLeadId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Lead detail\n            ")]),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Name",disable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Email",disable:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Mobile",disable:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reasons\n            ")]),a("q-select",{attrs:{outlined:"",options:e.options.rejects,label:"Selected reject reason","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.rejectReason,callback:function(t){e.$set(e.form,"rejectReason",t)},expression:"form.rejectReason"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"negative",label:"Disqualify",disable:e.isDisqualifyBtnDisabled},on:{click:e.onDisqualifiedLead}})],1)]:e._e()],2)])],1)])],1)},lt=[],nt={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{},options:{rejects:["Unreachable","Lost Interest","Non Purchase Query"]}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isDisqualifyBtnDisabled(){return"disqualified"===this.form.status},branches(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t},selections(){const e=this.$store.getters.tableSelection,t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},mounted(){this.form={}},methods:{onShowDialog(){this.tableSelection.length&&(this.selections=this.tableSelection.map(e=>({label:e.name,value:e.uuid})),this.selectedLeadId=this.selections[0].value)},onDisqualifiedLead(){var e=this;return i()((function*(){const t=n()({},e.form);try{yield e.$store.dispatch("DisqualifyOnlineLead",t),e.$refs.dialog.$children[0].hide(),e.$notify("success",t.name+" have been disqualified")}catch(a){console.log(a),e.$notify("error","Failed to disqualify lead. Please try again")}}))()},reset(){this.selectedLeadId="",this.form={}}}},ct=nt,dt=Object(b["a"])(ct,it,lt,!1,null,null,null),mt=dt.exports,ut=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"disqualifyQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Disqualify Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedLeadId?[a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reasons\n            ")]),a("q-select",{attrs:{outlined:"",options:e.options.rejects,label:"Selected reject reason","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.rejectReason,callback:function(t){e.$set(e.form,"rejectReason",t)},expression:"form.rejectReason"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"negative",label:"Disqualify"},on:{click:e.onDisqualifiedLead}})],1)]:e._e()],2)])],1)])],1)},pt=[],ht={components:{ModalDialog:v},data(){return{selectedLeadId:"",selections:[],form:{},options:{rejects:["Unreachable","Lost Interest","Non Purchase Query"]}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{branches(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)}},mounted(){this.form={}},methods:{onShowDialog(){this.$store.getters.tableSelection.length&&(this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedLeadId=this.selections[0].value)},reset(){this.selectedLeadId="",this.form={}},onDisqualifiedLead(){var e=this;return i()((function*(){const t=n()({},e.form);try{yield e.$store.dispatch("DisqualifiedQualifiedLead",t),e.$refs.dialog.$children[0].hide(),e.$notify("success",t.name+" have been disqualified")}catch(a){console.log(a);const t=a.response.message.error;e.$notify("error",t)}}))()}}},ft=ht,gt=Object(b["a"])(ft,ut,pt,!1,null,null,null),bt=gt.exports,yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"editbranch"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          View/Edit Branch\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a branch\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected branch","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedBranchId,callback:function(t){e.selectedBranchId=t},expression:"selectedBranchId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedBranchId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Company Logo\n            ")]),a("div",{staticClass:"col q-py-md q-gutter-y-md"},[a("q-img",{staticStyle:{height:"140px"},attrs:{"placeholder-src":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWBAMAAADOL2zRAAAAG1BMVEXMzMyWlpaqqqq3t7fFxcW+vr6xsbGjo6OcnJyLKnDGAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABAElEQVRoge3SMW+DMBiE4YsxJqMJtHOTITPeOsLQnaodGImEUMZEkZhRUqn92f0MaTubtfeMh/QGHANEREREREREREREtIJJ0xbH299kp8l8FaGtLdTQ19HjofxZlJ0m1+eBKZcikd9PWtXC5DoDotRO04B9YOvFIXmXLy2jEbiqE6Df7DTleA5socLqvEFVxtJyrpZFWz/pHM2CVte0lS8g2eDe6prOyqPglhzROL+Xye4tmT4WvRcQ2/m81p+/rdguOi8Hc5L/8Qk4vhZzy08DduGt9eVQyP2qoTM1zi0/uf4hvBWf5c77e69Gf798y08L7j0RERERERERERH9P99ZpSVRivB/rgAAAABJRU5ErkJggg==",src:e.logo,ratio:16/9,contain:""}}),a("q-file",{ref:"fileupload",attrs:{accept:".png, .jpg, .jpeg",label:"Change Logo",outlined:""},model:{value:e.fileUpload,callback:function(t){e.fileUpload=t},expression:"fileUpload"}})],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Branch detail\n            ")]),a("div",{staticClass:"col "},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Branch Name","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errormessage1.length>0,rules:[e.onNameCheck,e.textRules]},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errormessage1.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage1)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"Branch Code","lazy-rules":"",error:e.errormessage2.length>0,rules:[e.onBranchCodeCheck,e.textRules]},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}},[e.errormessage2.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage2)+"\n                  ")])]):e._e()],1),a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",options:e.opts.types,label:"Branch Type","bottom-slots":!1,"hide-hint":!0,"emit-value":"","map-options":"","stack-label":"","lazy-rules":"",error:e.errormessage3.length>0,rules:[e.textRules]},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e.errormessage3.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage3)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"Telephone No.",mask:"## - ########","unmasked-value":"",rules:[e.onMobileCheck],error:!!e.errormessage4},model:{value:e.form.telno,callback:function(t){e.$set(e.form,"telno",t)},expression:"form.telno"}},[e.errormessage4?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage4)+"\n                  ")])]):e._e()],1),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",placeholder:"07-23456789",label:"Fax No.",mask:"## - #########","unmasked-value":"","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errormessage5.length>0,rules:[e.onFaxCheck,e.textRules]},model:{value:e.form.faxno,callback:function(t){e.$set(e.form,"faxno",t)},expression:"form.faxno"}},[e.errormessage5.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage5)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Email","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errormessage6.length>0,rules:[e.onEmailCheck,e.textRules]},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errormessage6.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage6)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Address","bottom-slots":!1,"hide-hint":!0,"aria-rowcount":"2","lazy-rules":"",error:e.errormessage7.length>0,rules:[e.onAddressCheck,e.textRules]},model:{value:e.form.address1,callback:function(t){e.$set(e.form,"address1",t)},expression:"form.address1"}},[e.errormessage7.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage7)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"Address 2"},model:{value:e.form.address2,callback:function(t){e.$set(e.form,"address2",t)},expression:"form.address2"}})],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"State","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errormessage8.length>0,rules:[e.onStateCheck,e.textRules]},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[e.errormessage8.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage8)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-select",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Country","emit-value":"","map-options":"","stack-label":"","lazy-rules":"",options:e.countryOptions},on:{filter:e.filterFn},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}},[e.errormessage8.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage8)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"SSM No.","bottom-slots":!1,"hide-hint":!0,"lazy-rules":"",error:e.errormessage10.length>0,rules:[e.onSSMCheck,e.textRules]},model:{value:e.form.SSMNo,callback:function(t){e.$set(e.form,"SSMNo",e._n(t))},expression:"form.SSMNo"}},[e.errormessage10.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage10)+"\n                  ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"","bottom-slots":!1,"hide-hint":!0,label:"GST No","lazy-rules":"",error:e.errormessage11.length>0,rules:[e.onGSTCheck,e.textRules]},model:{value:e.form.GSTNo,callback:function(t){e.$set(e.form,"GSTNo",e._n(t))},expression:"form.GSTNo"}},[e.errormessage11.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                    "+e._s(e.errormessage11)+"\n                  ")])]):e._e()],1)],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{staticClass:"q-mx-sm",attrs:{color:"grey",label:"Reset Form"},on:{click:e.resetToUser}},[a("q-tooltip",[e._v("\n                  Reset form to original attributes.\n                ")])],1),a("q-btn",{attrs:{color:"primary",label:"Update"},on:{click:e.onEditBranch}})],1)]:e._e()],2)])],1)])],1)},vt=[],Ct={components:{ModalDialog:v},data(){return{countryOptions:[],selectedResetId:"",textRules:[e=>e&&e.length>0&&e.length<13],selectedBranchId:"",form:{},fileUpload:null,logo:"",branchName:"",selections:[],errormessage1:"",errormessage2:"",errormessage3:"",errormessage4:"",errormessage5:"",errormessage6:"",errormessage7:"",errormessage8:"",errormessage9:"",errormessage10:"",errormessage11:"",opts:{types:[{label:"Home Branch",value:"home"},{label:"Dealer Branch",value:"dealer"}]}}},validations:{form:{email:{required:I["required"],email:I["email"]},password:{required:I["required"],minLength:Object(I["minLength"])(3)},mobile:{required:I["required"],minLength:Object(I["minLength"])(8)},name:{required:I["required"]},branchId:{required:I["required"]},role:{required:I["required"]}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{countries(){const e=O["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.name,t.flag=e.flag,t});return t}}),watch:{selectedBranchId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.selectedResetId=this.tableSelection.find(t=>t.uuid===e),this.form=n()({},a),this.form.branch=this.getBranchName,this.logo="https://api-prod.skcrm.com.my/containers/download/"+this.form.logo}},created(){this.$store.dispatch("GetAllCountries")},methods:{filterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.countryOptions=this.countries.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.countryOptions=this.countries})},resetToUser(){this.form=n()({},this.selectedResetId),this.form.branch=this.getBranchName,this.logo="https://api-prod.skcrm.com.my/containers/download/"+this.form.logo},onShowDialog(){var e=this;return i()((function*(){if(!e.$store.getters.tableSelection.length)return;e.selections=e.$store.getters.tableSelection,e.selections=e.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),e.selectedBranchId=e.selections[0].value;const t=$["a"].query().where("name","HQ").first();e.branchName=t.name,e.countryOptions=e.countries}))()},reset(){this.selectedBranchId="",this.form={}},loadImage(e){var t=this;return i()((function*(){e&&(yield t.$store.dispatch("GetImage",e))}))()},onEditBranch(){var e=this;return i()((function*(){if(e.fileUpload){const t=yield e.$store.dispatch("UploadFile",e.fileUpload);e.form.logo=t.name}try{yield e.$store.dispatch("UpdateBranch",e.form),e.$refs.dialog.$children[0].hide(),e.$notify("success",`Branch with name ${e.form.name} updated!`)}catch(t){const a=t.response.message.error;e.$notify("error",a)}}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?this.errormessage1="Field cant blank":this.errormessage1=""},onEmailCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),e.form.email===e.selectedResetId.email)return!0;e.form.email.length<=0?e.errormessage6="Field cant be blank":yield e.$store.dispatch("CheckEmailBranchExist",e.form.email).then(t=>{e.errormessage6=t?"Email already exist":""})}))()},onBranchCodeCheck(){var e=this;return i()((function*(){if(e.form.code===e.selectedResetId.code)return!0;e.form.code.length<=0?e.errormessage2="Field cant be blank":yield e.$store.dispatch("CheckBranchCodeExist",e.form.code).then(t=>{e.errormessage2=t?"Branch Code already exist":""})}))()},onAddressCheck(){this.$v.form.$touch(),this.form.address1.length<=0?this.errormessage7="Field cant blank":this.errormessage7=""},onStateCheck(){this.$v.form.$touch(),this.form.state.length<=0?this.errormessage8="Field cant blank":this.errormessage8=""},onCountryCheck(){this.$v.form.$touch(),this.form.country.length<=0?this.errormessage9="Field cant blank":this.errormessage9=""},onSSMCheck(){this.$v.form.$touch(),this.form.SSMNo.length<=0?this.errormessage10="Field cant blank":this.errormessage10=""},onGSTCheck(){this.$v.form.$touch(),this.form.GSTNo.length<=0?this.errormessage11="Field cant blank":this.errormessage11=""},onFaxCheck(){var e=this;return i()((function*(){if(e.form.faxno===e.selectedResetId.faxno)return!0;e.form.faxno<=0?e.errormessage5="Field cant be blank":(yield e.$store.dispatch("CheckFaxExist",e.form.faxno).then(t=>{e.errormessage5=t?"Fax number already exist":""}),e.form.faxno.length<=7&&(e.errormessage5="Fax No. must between 8-10 digits"))}))()},onMobileCheck(){var e=this;return i()((function*(){return e.errormessage4="",e.form.telno===e.selectedResetId.telno||(e.form.telno.length<=0?void(e.errormessage4="Field cant be blank"):(yield e.$store.dispatch("CheckMobileBranchExist",e.form.telno).then(t=>{e.errormessage4=t?"Mobile already exist":""}),e.form.telno.length<=7&&(e.errormessage4="Telephone No. must between 8-10 digits"),!e.errormessage4))}))()}}},xt=Ct,qt=Object(b["a"])(xt,yt,vt,!1,null,null,null),wt=qt.exports,kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"edituser"},on:{"close-dialog":e.onHideDialog,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          View/Edit User\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a user\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected user","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedUserId,callback:function(t){e.selectedUserId=t},expression:"selectedUserId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedUserId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              User detail\n            ")]),a("q-form",{ref:"myForm",on:{submit:e.onUpdateUser}},[a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Login ID","lazy-rules":"",error:e.errormessage8.length>0,rules:[e.onNameCheck,e.textRules]},model:{value:e.form.loginId,callback:function(t){e.$set(e.form,"loginId",t)},expression:"form.loginId"}},[e.errormessage8.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errormessage8)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Fullname","lazy-rules":"",error:e.errormessage8.length>0,rules:[e.onNameCheck,e.textRules]},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e.errormessage8.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errormessage8)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{debounce:"500",outlined:"",label:"SC Code",rules:[e.onSCCodeCheck,e.textRules],error:!!e.error.sccode},model:{value:e.form.sccode,callback:function(t){e.$set(e.form,"sccode",t)},expression:"form.sccode"}},[e.error.sccode?a("q-tooltip",[e._v("\n                    "+e._s(e.error.sccode)+"\n                  ")]):e._e()],1),a("q-input",{staticClass:"col q-pb-xs",attrs:{mask:"### - ########",outlined:"","unmasked-value":"",label:"Telephone No.",rules:[e.onMobileCheck],error:!!e.error.mobile},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}},[e.error.mobile?a("q-tooltip",[e._v("\n                    "+e._s(e.error.mobile)+"\n                  ")]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Email","lazy-rules":"",rules:[e.onEmailCheck,e.emailRules],error:e.errormessage2.length>0},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}},[e.errormessage2.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errormessage2)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-select",{attrs:{outlined:"",options:e.branches,label:"Branch","emit-value":"","map-options":"","stack-label":""},model:{value:e.form.branchId,callback:function(t){e.$set(e.form,"branchId",t)},expression:"form.branchId"}})],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Design Cad 4.0 AppUID","lazy-rules":"",rules:[e.onAppUIDCheck],error:e.errormessage11.length>0},model:{value:e.form.appUID,callback:function(t){e.$set(e.form,"appUID",t)},expression:"form.appUID"}},[e.errormessage11.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errormessage11)+"\n                    ")])]):e._e()],1)],1),a("div",{staticClass:"col"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Design Cad 4.0 Email","lazy-rules":"",rules:[e.onKujialeEmailCheck,e.emailRules],error:e.errormessage10.length>0},model:{value:e.form.kujialeEmail,callback:function(t){e.$set(e.form,"kujialeEmail",t)},expression:"form.kujialeEmail"}},[e.errormessage10.length>0?a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle",offset:[10,10]}},[a("div",[e._v("\n                      "+e._s(e.errormessage10)+"\n                    ")])]):e._e()],1)],1)]),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reset user's password\n            ")]),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col q-pb-xs",attrs:{outlined:"",label:"Password","lazy-rules":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mx-sm",attrs:{flat:"",outline:"",color:"primary",label:"Reset"},on:{click:e.resetPassword}})],1),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Toggle user's status\n            ")]),a("div",[a("q-toggle",{attrs:{color:"teal-8"},model:{value:e.form.active,callback:function(t){e.$set(e.form,"active",t)},expression:"form.active"}},[a("q-tooltip",[e._v("\n                  Toggle User's status\n                ")])],1)],1),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-mx-sm",attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{staticClass:"q-mx-sm",attrs:{color:"grey",label:"Reset Form"},on:{click:e.resetToUser}},[a("q-tooltip",[e._v("\n                  Reset form to user's original attributes.\n                ")])],1),a("q-btn",{staticClass:"q-mx-sm",attrs:{color:"primary",label:"Update",disabled:!!e.error.name||!!e.error.sccode},on:{click:e.onUpdateUser}})],1)]:e._e()],2)])],1)])],1)},_t=[],St={components:{ModalDialog:v},mixins:[x["a"]],data(){return{selectedUserId:"",isUserActive:!0,user:{},form:{uuid:"",name:"",sccode:"",mobile:"",email:"",active:null,branchId:"",kujialeEmail:"",appUID:""},password:"",error:{name:"",sccode:"",mobile:""},errormessage2:"",errormessage8:"",errormessage9:"",errormessage10:"",errormessage11:"",selections:[]}},validations:{form:{email:{required:I["required"],email:I["email"]},password:{required:I["required"],minLength:Object(I["minLength"])(3)},mobile:{required:I["required"],minLength:Object(I["minLength"])(8)},name:{required:I["required"]},branchId:{required:I["required"]},role:{required:I["required"]},kujialeEmail:{email:I["email"]}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{branches(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t}}),watch:{selectedUserId(e,t){var a=this;return i()((function*(){if(!e)return;const t=a.$store.getters.tableSelection.find(t=>t.uuid===e);a.user=n()({},t);try{yield a.$store.dispatch("GetUserProfile",e)}catch(o){a.$notify("error","Error getting user profile")}const s=Te["a"].query().where("userId",a.selectedUserId).first();a.user.sccode=null===s||void 0===s?void 0:s.sccode,a.form={uuid:t.uuid,loginId:t.loginId,name:t.name,sccode:null===s||void 0===s?void 0:s.sccode,mobile:t.mobile,email:t.email,branchId:t.branchId,active:t.active,kujialeEmail:t.kujialeEmail,appUID:t.appUID},a.error={name:"",sccode:"",mobile:""}}))()}},created(){var e=this;return i()((function*(){yield e.$store.dispatch("GetAllBranches")}))()},methods:{onShowDialog(){this.$store.getters.tableSelection.length&&(this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedUserId=this.selections[0].value)},onHideDialog(){this.selectedUserId="",this.form={uuid:"",name:"",sccode:"",mobile:"",email:"",branchId:"",kujialeEmail:"",appUID:""}},resetToUser(){this.form=n()({},this.user),this.error={name:"",sccode:"",mobile:""},this.errormessage8="",this.errormessage10="",this.errormessage11=""},onUpdateUser(){var e=this;return i()((function*(){e.isUserActive||(e.form.active=!1);try{yield e.$store.dispatch("UpdateUser",e.form),1===e.selections.length&&e.$refs.dialog.$children[0].hide(),e.$notify("success",`User with name ${e.form.name} updated!`)}catch(s){var t,a;console.log(s);const o=null===(t=s.response)||void 0===t||null===(a=t.message)||void 0===a?void 0:a.error;e.$notify("error",o)}}))()},onLoginIdCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),e.form.loginId===e.user.loginId)return!0;e.form.loginId.length<=0?e.errormessage9="Field cant be blank":yield e.$store.dispatch("CheckLoginIdExist",e.form.email).then(t=>{e.errormessage9=t?"Login ID already exist":""})}))()},onEmailCheck(){var e=this;return i()((function*(){if(e.$v.form.$touch(),e.form.email===e.user.email)return!0;e.form.email.length<=0?e.errormessage2="Field cant be blank":yield e.$store.dispatch("CheckEmailExist",e.form.email).then(t=>{e.errormessage2=t?"Email already exist":""})}))()},onKujialeEmailCheck(){var e=this;return i()((function*(){return e.$v.form.$touch(),e.form.kujialeEmail===e.user.kujialeEmail||(0===e.form.kujialeEmail.length||void(yield e.$store.dispatch("CheckKujialeEmailExist",e.form.kujialeEmail).then(t=>{e.errormessage10=t?"Design Cad 4.0 Email already exist":""})))}))()},onAppUIDCheck(){var e=this;return i()((function*(){return e.$v.form.$touch(),e.form.appUID===e.user.appUID||(0===e.form.appUID.length||void(yield e.$store.dispatch("CheckAppUIDExist",e.form.appUID).then(t=>{e.errormessage11=t?"Design Cad 4.0 AppUID already exist":""})))}))()},onMobileCheck(){var e=this;return i()((function*(){return e.error.mobile="",e.form.mobile===e.user.mobile||(e.form.mobile.length<=0?e.error.mobile="Field cant blank":e.error.mobile="",yield e.$store.dispatch("CheckMobileExist",e.form.mobile).then(t=>{t&&(e.error.mobile="Mobile already exist")}),e.form.mobile.length<=9&&(e.error.mobile="Telephone No. must between 10-11 digits"),!e.error.mobile)}))()},onNameCheck(){this.$v.form.$touch(),this.form.name.length<=0?(this.errormessage8="Field cant blank",console.log("dadsa",this.errormessage8)):this.errormessage8="",console.log("here",this.errormessage8)},onSCCodeCheck(){var e=this;return i()((function*(){return e.error.sccode="",e.form.sccode===e.user.sccode||(e.form.sccode.length<=0?e.error.sccode="Field cant blank":e.error.sccode="",yield e.$store.dispatch("CheckSCCodeExist",e.form.sccode).then(t=>{t&&(e.error.sccode="SCCode already exist")}),!e.error.sccode)}))()},resetPassword(){var e=this;return i()((function*(){yield e.$store.dispatch("ResetUserPassword",{password:e.password,userId:e.selectedUserId}),e.$notify("success","Successfully updated user password")}))()}}},Dt=St,It=Object(b["a"])(Dt,kt,_t,!1,null,null,null),$t=It.exports,Ot=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importitemlist"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("\n        Import\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx file which contain master item data\n    ")]),a("q-card-section",[a("q-uploader",{ref:"itemlistUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{flat:"",color:"primary",label:"Select"}})],1)],1)],1)},Tt=[],At={components:{ModalDialog:v},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.itemlistUploader,s=e[0];try{const e=yield t.$repository.itemlist.upload(s);a.removeFile(s),console.log("Upload leads res:",e);const{created:o,updated:r}=e.data;t.$notify("success",`Item successfully created: ${o}, updated: ${r}.`)}catch(o){console.log("Failed to upload leads file:",o)}}))()}}},Rt=At,jt=Object(b["a"])(Rt,Ot,Tt,!1,null,null,null),Nt=jt.exports,Mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importonlineleads"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("\n        Import\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx or .csv file which contain this leads data, and auto populate the online leads.\n    ")]),a("q-card-section",[a("q-uploader",{ref:"leadsUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx, .csv",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{flat:"",color:"primary",label:"Select"}})],1)],1)],1)},Et=[],Pt={components:{ModalDialog:v},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.leadsUploader,s=e[0];try{const e=yield t.$repository.lead.upload(s);a.removeFile(s),console.log("Upload leads res:",e)}catch(o){console.log("Failed to upload leads file:",o)}}))()}}},Lt=Pt,Ft=Object(b["a"])(Lt,Mt,Et,!1,null,null,null),Ut=Ft.exports,Bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{staticStyle:{height:"500px"},attrs:{name:"opendesigncad"}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Open Design App\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{},[e._v("\n            Opening Design CAD at external tab. Click button below to proceed\n          ")]),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"Open Design CAD",color:"primary"},on:{click:e.onClickOpenDesign}})],1)],1)])],1)]),a("iframe",{staticStyle:{position:"absolute",width:"0",height:"0",border:"0"},attrs:{src:e.kujialeURL},on:{load:e.loadKujiale}})],1)},zt=[],Gt=(a("e6cf"),{components:{ModalDialog:v},data(){return{kujialeURL:"",kujialeToken:""}},computed:n()({},Object(C["b"])(["appUID","kujialeEmail"])),methods:{onClickOpenDesign(){var e=this;return i()((function*(){e.kujialeToken=yield e.$store.dispatch("GetSSOToken"),e.appUID&&e.kujialeEmail?"0"===e.kujialeToken.c&&e.kujialeToken.d?(e.kujialeURL=`https://www.kujiale.com/v/auth?accesstoken=${e.kujialeToken.d}&dest=5`,console.log("kujialeUrl: "+e.kujialeURL),window.open(e.kujialeURL),yield e.sleep(1e3),window.open("https://www.kujiale.com/vc/design/all","_blank")):e.$notify("error","Email has been binded with another App key, unable to register current user with Kujiale."):e.$notify("error","Current user does not have Kujiale access")}))()},sleep(e){return i()((function*(){return new Promise(t=>setTimeout(t,e))}))()},loadKujiale(){var e=this;return i()((function*(){e.kujialeURL}))()}}}),Ht=Gt,Qt=Object(b["a"])(Ht,Bt,zt,!1,null,null,null),Jt=Qt.exports,Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"requalifyQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Requalify Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select a lead\n          ")]),a("q-select",{attrs:{outlined:"",options:e.selections,label:"Selected lead","emit-value":"","map-options":"","stack-label":""},model:{value:e.selectedLeadId,callback:function(t){e.selectedLeadId=t},expression:"selectedLeadId"}}),a("q-separator",{staticClass:"q-my-md"}),e.selectedLeadId?[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Lead detail\n            ")]),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Name",disable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Email",disable:""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("div",{staticClass:"col "},[a("q-input",{attrs:{outlined:"",label:"Mobile",disable:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Reasons\n            ")]),a("q-input",{staticClass:"col",attrs:{outlined:"",label:"Requalify Reason",type:"textarea"},model:{value:e.form.rejectReason,callback:function(t){e.$set(e.form,"rejectReason",t)},expression:"form.rejectReason"}}),a("q-separator"),a("div",{staticClass:"row justify-end"},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}})],1),a("div",[a("q-btn",{attrs:{color:"positive",label:"Requalify",disable:e.isBtnDisabled},on:{click:e.onRequalifiedLead}}),e.isBtnDisabled?a("q-tooltip",[e._v("\n                  Lead is not disqualified\n                ")]):e._e()],1)])]:e._e()],2)])],1)])],1)},Kt=[],Vt={components:{ModalDialog:v},data(){return{selections:[],selectedLeadId:"",form:{}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isBtnDisabled(){return"disqualified"!==this.form.status},branches(){const e=$["a"].all(),t=e.map(e=>{const t=[];return t.label=e.name.charAt(0).toUpperCase()+e.name.slice(1),t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a),console.log(this.form)}},mounted(){this.form={}},methods:{onShowDialog(){this.$store.getters.tableSelection.length&&(this.selections=this.$store.getters.tableSelection,this.selections=this.selections.map(e=>{const t={};return t.label=e.name,t.value=e.uuid,t}),this.selectedLeadId=this.selections[0].value)},reset(){this.selectedLeadId="",this.form={}},onRequalifiedLead(){var e=this;return i()((function*(){const t=n()({},e.form);try{yield e.$store.dispatch("RequalifyQualifiedLead",t),e.$refs.dialog.$children[0].hide(),e.$notify("success",t.name+" have been requalified")}catch(a){console.log(a),console.log(a.response);const t=a.response.message.error;e.$notify("error",t)}}))()}}},Wt=Vt,Xt=Object(b["a"])(Wt,Yt,Kt,!1,null,null,null),Zt=Xt.exports,ea=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"submitOrderConfirmationToAccount"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Add Deposit Information\n        ")])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Deposit\n        ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Deposit Amount","lazy-rules":"",rules:[e.floatRules],prefix:"RM"},model:{value:e.form.paidAmountDeposit,callback:function(t){e.$set(e.form,"paidAmountDeposit",t)},expression:"form.paidAmountDeposit"}}),"FCO"!==e.form.state?a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload Supporting Documents",color:"teal",multiple:""},on:{uploaded:e.fileUploaded}}):e._e(),a("q-separator",{staticClass:"q-my-md"}),e.form.paymentAttachments&&e.form.paymentAttachments.length?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Supporting Documents\n          ")]):e._e(),e.form.paymentAttachments&&e.form.paymentAttachments.length?a("q-list",{attrs:{bordered:""}},e._l(e.form.paymentAttachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v(e._s(t.fileName))])],1)})),1):e._e(),a("div",{staticClass:"flex justify-end q-my-lg"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{color:"primary",label:"Submit",disabled:e.isDisabledSubmit},on:{click:e.onSubmit}}),e.isDisabledSubmit&&"OC"===e.form.state?a("q-tooltip",[e._v("\n                No deposit attachment found for the order\n              ")]):e._e(),e.isDisabledSubmit&&"FCO"===e.form.state?a("q-tooltip",[e._v("\n                Order is already in Final Confirmation Order\n              ")]):e._e()],1)],1)],1)],1)],1)])],1)},ta=[],aa={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isDisabledSubmit:!0,form:{leadId:"",paidAmountDeposit:"",promoCode:"",promoAmount:""}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"}}),methods:{fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const[{name:s}]=e;try{const{files:e}=JSON.parse(t.response),[{name:o}]=e[s],{uuid:r}=a.form;if(!o)throw new Error;yield a.$store.dispatch("AddFCOAttachment",{fileName:s,name:o,orderId:r}),a.isDisabledSubmit=!1,a.$notify("success","File upload success")}catch(o){a.$notify("error","Error uploading attachment "+s)}}))()},onShowDialog(){this.form=n()({},this.tableSelection[0]),this.form.promoAmount&&(this.form.promoAmount*=100),this.form.paymentAttachments&&this.form.paymentAttachments.length&&(this.isDisabledSubmit=!1),"FCO"===this.form.state&&(this.isDisabledSubmit=!0)},reset(){this.isDisabledSubmit=!0,this.form={paidAmountDeposit:null,promoCode:"",promoAmount:null}},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},onSubmit(){var e=this;return i()((function*(){try{const{leadId:t,uuid:a,paidAmountDeposit:s,promoAmount:o,promoCode:r}=e.form;yield e.$store.dispatch("OrderConfirmationAddDeposit",{leadId:t,orderId:a,paidAmountDeposit:parseFloat(s),promoAmount:parseFloat(o/100),promoCode:r}),e.$notify("success","Order Confirmation successfully submitted to HQ Accountant.")}catch(t){e.$notify("error","Action failed. Please try again")}}))()}}},sa=aa,oa=Object(b["a"])(sa,ea,ta,!1,null,null,null),ra=oa.exports,ia=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"summaryQuotation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Summary Quotation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Drawings\n          ")]),a("q-separator",{staticClass:"q-mb-md"}),e._l(e.drawings,(function(t){return a("q-list",{key:t.uuid},[a("q-chip",{staticClass:"row q-ml",attrs:{color:"primary","text-color":"white"}},[e._v("\n              "+e._s(t.referenceName)+"\n            ")]),a("div",{staticClass:"row justify-center"},[a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Drawing Number",disable:""},model:{value:t.drawingNumber,callback:function(a){e.$set(t,"drawingNumber",a)},expression:"drawing.drawingNumber"}}),a("q-input",{staticClass:"col q-pb-none q-mr-sm",attrs:{outlined:"",label:"Total Price (RM)",disable:""},model:{value:t.discountedTotalPrice,callback:function(a){e.$set(t,"discountedTotalPrice",a)},expression:"drawing.discountedTotalPrice"}})],1)],1)}))],2)]),a("q-card-actions",{attrs:{align:"right"}},[a("div",{attrs:{align:"right"}},[a("q-btn",{attrs:{outline:"",color:"primary",label:"View / Print","no-caps":""},on:{click:e.generatePdf}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{color:"primary",label:"To Order Confirmation","no-caps":""},on:{click:e.onClickToOrderConfirmation}})],1)])],1)])],1)},la=[],na=a("e499"),ca=a("4ebb"),da={components:{ModalDialog:v},mixins:[x["a"]],data(){return{quotation:[],selectedLeadId:"",selections:[],form:{leadId:"",designId:""},drawings:{},lumpsum:0}},computed:n()({},Object(C["b"])(["tableSelection"])),methods:{onShowDialog(){var e=this;return i()((function*(){if(e.selections=e.$store.getters.tableSelection,console.log(e.selections),!e.selections.length)return;e.selections=e.selections.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t}),e.selectedLeadId=e.selections[0].value,console.log("leadId",e.selectedLeadId);const t=e.tableSelection.find(t=>t.uuid===e.selectedLeadId);e.form=n()({},t);const a=yield e.$store.dispatch("GetSummaryQuotation",{uuid:e.selectedLeadId});e.drawings=a,console.log("summary quo",e.drawings),e.drawings.forEach(function(){var t=i()((function*(t){const a=yield e.$store.dispatch("GetDesigns",t.uuid);e.quotation.push(a),console.log("res",a)}));return function(e){return t.apply(this,arguments)}}());for(let s=0;s<e.drawings.length;s++)e.drawings[s].totalPrice=Math.ceil(e.drawings[s].totalPrice),e.drawings[s].discountedTotalPrice=Math.ceil(e.drawings[s].discountedTotalPrice),e.drawings[s].transportationCharge=Math.ceil(e.drawings[s].transportationCharge),e.drawings[s].totalInstallationCharges=Math.ceil(e.drawings[s].totalInstallationCharges),e.drawings[s].totalPriceTradingItems=Math.ceil(e.drawings[s].totalPriceTradingItems),e.drawings[s].lumpsum=Math.ceil(e.drawings[s].lumpsum);console.log(""+JSON.stringify(e.drawings))}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===na["vfs"]&&(na["vfs"]=ca["pdfMake"].vfs),console.log("quotes "+JSON.stringify(e.quotation)),console.log("form "+JSON.stringify(e.form));var a=[],s=0,o=0,r=0;a.push([{text:"Item",style:"headerTitle"},{text:"Description",style:"headerTitle"},{text:"Qty",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"Unit Price\n(RM)",alignment:"center",style:"headerTitle"},{text:"Discount\n(%)",alignment:"center",style:"headerTitle"},{text:"Price\n(RM)",alignment:"center",style:"headerTitle"}]);try{for(var i of(e.quotation.length&&(r+=e.quotation[0].transportationCharge),console.log(JSON.stringify(e.quotation)),e.quotation))i.quotationDetails[0].quantity<1&&(i.quotationDetails[0].quantity=1),o+=i.totalInstallationCharges,s+=i.discountedTotalPriceDrawingItems*i.quotationDetails[0].quantity+i.totalPriceTradingItems,i.quotationDetails&&a.push([i.referenceName,i.materials,{text:i.quotationDetails[0].quantity,alignment:"center"},{text:"Set",alignment:"center"},{text:i.totalPriceDrawingItems.toFixed(2),alignment:"right"},{text:i.masterItemDiscount,alignment:"center"},{text:Math.ceil(i.discountedTotalPriceDrawingItems).toFixed(2)*i.quotationDetails[0].quantity,alignment:"right"}]);for(var l of e.quotation)if(l.tradingItems)for(var n of l.tradingItems)a.push([n.category,n.name,{text:n.designAdditionalItems[0].quantity,alignment:"center"},{text:n.uom,alignment:"center"},{text:Math.ceil((n.stdcost*n.markuprate).toFixed(2)),alignment:"right"},{text:100*n.designAdditionalItems[0].discount,alignment:"center"},{text:Math.ceil((n.stdcost*n.markuprate).toFixed(2)*n.designAdditionalItems[0].quantity*(1-n.designAdditionalItems[0].discount)).toFixed(2),alignment:"right"}]);for(var c of(a.push([{text:" ",colSpan:7},{text:" ",colSpan:7}]),e.drawings))c.lumpsum&&(e.lumpsum=c.lumpsum),c.isIncludedInstallationCharge&&a.push([{text:"Others"},{text:"Installation Charges"},{text:"",colSpan:4},{},{},{},{text:c.totalInstallationCharges.toFixed(2),alignment:"right"}]),c.isIncludedInstallerOutstationCharge&&a.push([{text:"Others"},{text:"Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:c.installerOutstationCharge.toFixed(2),alignment:"right"}]),c.isIncludedWorktopOutstationCharge&&a.push([{text:"Others"},{text:"Worktop Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:c.installerOutstationCharge.toFixed(2),alignment:"right"}]);e.drawings.length&&e.drawings[0].isIncludedTransportationCharge&&a.push([{text:"Others"},{text:"Transportation Charges"},{text:"",colSpan:4},{},{},{},{text:c.transportationCharge.toFixed(2),alignment:"right"}]),s+=o+r}catch(h){console.log("error bro",h),e.$notify("error","No Quotation Details")}s=Math.ceil(s);const d=0,m=s+d-e.lumpsum,u=Math.floor(m);console.log("abc",a);var p={images:{logo:"https://static.wixstatic.com/media/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg/v1/fill/w_32%2Ch_32%2Clg_1%2Cusm_0.66_1.00_0.01/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg"},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:"Quotation Customized Furniture",style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",e.form.name],["Contact No",":",e.form.phone],["Email",":",e.form.email]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(e.form.salesConsultant.updatedAt,"DD MMM YYYY")],["Summary Quotation No",":",e.drawings[0].quotationNumber],["Branch",":",e.form.branch.name],["SC Name",":",e.form.salesConsultant.name],["SC Contact No",":",e.form.salesConsultant.mobile]]},layout:"noBorders"}]]},layout:"noBorders",style:"pagePadding"},{style:"tableExample",table:{widths:[80,"*","auto","auto",50,40,50],body:a}},{table:{widths:[80,"*","auto","auto",50,40,50],body:[[{stack:["\nTerms & Condition",{ol:["Prices quoted are subject to site measurement, design amendment and material selection","Prices quoted exclude electrical, plumbing, ducting and masonry work","Prices quoted inclusive of delivery and installation","Payment terms: 10% deposit, 30% upon final confirmation","Price validity: 30 days from date hereoff","Deposit paid are non refundable"]}],colSpan:4,rowSpan:7,border:[!0,!1,!0,!0]},"","","",{text:"Total",style:"footerTitle",colSpan:2,border:[!0,!1,!0,!0]},{},{text:s.toFixed(2),style:"priceCol",border:[!0,!1,!0,!0]}],["","","","",{text:"Round Up Discount",colSpan:2,style:"footerTitle"},{},{text:e.lumpsum.toFixed(2),style:"priceCol"}],["","","","",{text:"GST/SST",style:"footerTitle",colSpan:2},{},{text:d.toFixed(2),style:"priceCol"}],["","","","",{text:"Nett Total",style:"footerTitle",colSpan:2},{},{text:m.toFixed(2),style:"priceCol"}],["","","","",{text:"Round-Down",style:"footerTitle",colSpan:2},{},{text:u.toFixed(2),style:"priceCol"}],["","","","",{text:"Down Payment",style:"footerTitle",colSpan:2},{},{text:"0.00",style:"priceCol"}],["","","","",{text:"Balance Payment",style:"footerTitle",colSpan:2},{},{text:u.toFixed(2),style:"priceCol"}]]}},{table:{widths:["*","auto"],body:[[{stack:["Yours Faithfully",{text:"",style:"topMargin"},"_______________________________",e.form.salesConsultant.name,e.form.salesConsultant.mobile,e.form.salesConsultant.email]},{stack:["Agreed and confirmed by",{text:"",style:"topMargin"},"_______________________________","Customer Name :   "+e.form.name,"IC No : "]}]]},layout:"noBorders",style:"pagePadding"}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"portrait"};na["createPdf"](p).open()}))()},onClickToOrderConfirmation(){var e=this;return i()((function*(){try{e.drawings=e.drawings.map(e=>e.uuid);const t=yield e.$store.dispatch("CreateOrUpdateOrderConfirmationFromSummaryQuotations",{designIds:e.drawings,leadId:e.selectedLeadId});e.$notify("success","Successfully move to order confirmation"),console.log(e.drawings),console.log(t)}catch(t){console.log(t)}}))()},reset(){this.drawings={},this.quotation=[],this.form={leadId:"",designId:""}}}},ma=da,ua=Object(b["a"])(ma,ia,la,!1,null,null,null),pa=ua.exports,ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Order Confirmation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm"},[a("div",[a("q-chip",{staticClass:"q-ma-none",attrs:{square:"",color:e.statusColour[e.form.status],"text-color":"white"}},[e._v("\n              "+e._s(e.form.status)+"\n              "),a("q-tooltip",[e._v("Order Confirmation Status")])],1)],1),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8"},[e._v("\n            Details\n          ")]),a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{disable:"",outlined:"",label:"Deposit Amount","lazy-rules":""},model:{value:e.form.paidAmountDeposit,callback:function(t){e.$set(e.form,"paidAmountDeposit",t)},expression:"form.paidAmountDeposit"}})],1),"Rejected"===e.form.status?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-7 q-mt-lg"},[e._v("\n            Remarks\n          ")]):e._e(),"Rejected"===e.form.status?a("q-input",{attrs:{filled:"",disable:"",type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}}):e._e(),a("q-separator"),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Supporting Documents\n          ")]),a("q-list",{attrs:{bordered:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.generatePdf}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v("Quotation Customised Furniture")])],1),e._l(e.form.paymentAttachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v(e._s(t.fileName))])],1)}))],2)],1)])],1)])],1)},fa=[],ga={components:{ModalDialog:v},data(){return{selectedLeadId:"",statusColour:{New:"secondary","Pending Approval":"secondary",Cancelled:"negative",Acknowledged:"positive",Rejected:"negative"},form:{},quotation:[],lumpsum:0}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{depositPdfUrl(){return this.form&&this.form.attachedDocumentDeposit?"https://api-prod.skcrm.com.my/containers/download/"+this.form.attachedDocumentDeposit:null}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0]),e.quotation=yield Promise.all(e.form.designs.filter(e=>"Confirmed"===e.state).map(function(){var t=i()((function*(t){return yield e.$store.dispatch("GetDesigns",t.uuid)}));return function(e){return t.apply(this,arguments)}}())),e.selectedLeadId=e.form.leadId}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===na["vfs"]&&(na["vfs"]=ca["pdfMake"].vfs),console.log("quotes",e.quotation),console.log("form",e.form);const a=e.form.lead.userId,s=e.form.lead.branchId,[o]=X["a"].query().withAll().whereId(a).get();console.log(o);const[r]=$["a"].query().withAll().whereId(s).get(),{lead:i}=e.form;var l=[],n=0,c=0,d=0;l.push([{text:"Item",style:"headerTitle"},{text:"Description",style:"headerTitle"},{text:"Qty",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"Unit Price\n(RM)",alignment:"center",style:"headerTitle"},{text:"Discount\n(%)",alignment:"center",style:"headerTitle"},{text:"Amount\n(RM)",alignment:"center",style:"headerTitle"}]);try{for(var m of(console.log("1 here"),console.log("asd "+JSON.stringify(e.quotation)),console.log("2 here"),e.quotation))m.quotationDetails[0].quantity<1&&(m.quotationDetails[0].quantity=1),n+=m.discountedTotalPriceDrawingItems*m.quotationDetails[0].quantity,c+=m.totalInstallationCharges,d+=m.transportationCharge,m.quotationDetails&&l.push([m.referenceName,m.materials,{text:m.quotationDetails[0].quantity,alignment:"center"},{text:"Set",alignment:"center"},{text:m.totalPriceDrawingItems.toFixed(2),alignment:"right"},{text:m.masterItemDiscount,alignment:"center"},{text:m.discountedTotalPriceDrawingItems.toFixed(2)*m.quotationDetails[0].quantity,alignment:"right"}]);for(var u of(console.log("3 here"),e.quotation))if(u.tradingItems)for(var p of u.tradingItems)n+=p.stdcost,l.push([p.category,p.name,{text:p.designAdditionalItems[0].quantity,alignment:"center"},{text:p.uom,alignment:"center"},{text:p.stdcost.toFixed(2),alignment:"right"},{text:100*p.designAdditionalItems[0].discount,alignment:"center"},{text:(p.stdcost*p.designAdditionalItems[0].quantity*(1-p.designAdditionalItems[0].discount)).toFixed(2),alignment:"right"}]);for(var h of(l.push([{text:" ",colSpan:7},{text:" ",colSpan:7}]),e.quotation))h.lumpsum&&(e.lumpsum=h.lumpsum),h.isIncludedInstallationCharge&&l.push([{text:"Others"},{text:"Installation Charges"},{text:"",colSpan:4},{},{},{},{text:h.totalInstallationCharges.toFixed(2),alignment:"right"}]),h.isIncludedInstallerOutstationCharge&&l.push([{text:"Others"},{text:"Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:h.installerOutstationCharge.toFixed(2),alignment:"right"}]),h.isIncludedWorktopOutstationCharge&&l.push([{text:"Others"},{text:"Worktop Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:h.installerOutstationCharge.toFixed(2),alignment:"right"}]);e.quotation.length&&e.quotation[0].isIncludedTransportationCharge&&l.push([{text:"Others"},{text:"Transportation Charges"},{text:"",colSpan:4},{},{},{},{text:h.transportationCharge.toFixed(2),alignment:"right"}]),n+=c+d}catch(v){console.log("error bro",v),e.$notify("error","No Quotation Details")}const f=.08*n,g=n+f-e.lumpsum,b=Math.floor(g);var y={images:{logo:"https://static.wixstatic.com/media/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg/v1/fill/w_32%2Ch_32%2Clg_1%2Cusm_0.66_1.00_0.01/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg"},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:"Quotation Customized Furniture",style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",i.name],["Contact No",":",i.phone],["Email",":",i.email]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(o.updatedAt,"DD MMM YYYY")],["Summary Quotation No",":",e.form.quotationNumber],["Branch",":",r.name],["SC Name",":",o.name],["SC Contact No",":",o.mobile]]},layout:"noBorders"}]]},layout:"noBorders",style:"pagePadding"},{style:"tableExample",table:{widths:[80,"*","auto","auto",50,40,50],body:l}},{table:{widths:[80,"*","auto","auto",50,40,50],body:[[{stack:["\nTerms & Condition",{ol:["Prices quoted are subject to site measurement, design amendment and material selection","Prices quoted exclude electrical, plumbing, ducting and masonry work","Prices quoted inclusive of delivery and installation","Payment terms: 10% deposit, 30% upon final confirmation","Price validity: 30 days from date hereoff","Deposit paid are non refundable"]}],colSpan:4,rowSpan:7,border:[!0,!1,!0,!0]},"","","",{text:"Total",style:"footerTitle",colSpan:2,border:[!0,!1,!0,!0]},{},{text:n.toFixed(2),style:"priceCol",border:[!0,!1,!0,!0]}],["","","","",{text:"Round Up Discount",colSpan:2,style:"footerTitle"},{},{text:e.lumpsum.toFixed(2),style:"priceCol"}],["","","","",{text:"GST/SST",style:"footerTitle",colSpan:2},{},{text:f.toFixed(2),style:"priceCol"}],["","","","",{text:"Nett Total",style:"footerTitle",colSpan:2},{},{text:g.toFixed(2),style:"priceCol"}],["","","","",{text:"Round-Down",style:"footerTitle",colSpan:2},{},{text:b.toFixed(2),style:"priceCol"}],["","","","",{text:"Down Payment",style:"footerTitle",colSpan:2},{},{text:"0.00",style:"priceCol"}],["","","","",{text:"Balance Payment",style:"footerTitle",colSpan:2},{},{text:b.toFixed(2),style:"priceCol"}]]}},{table:{widths:["*","auto"],body:[[{stack:["Yours Faithfully",{text:"",style:"topMargin"},"_______________________________",o.name,o.mobile,o.email]},{stack:["Agreed and confirmed by",{text:"",style:"topMargin"},"_______________________________","Customer Name :   "+i.name,"IC No : "]}]]},layout:"noBorders",style:"pagePadding"}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"portrait"};na["createPdf"](y).open()}))()},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},openPdfInNewPage(e){window.open(e,"_blank")},reset(){this.form={},this.quotation=[]}}},ba=ga,ya=Object(b["a"])(ba,ha,fa,!1,null,null,null),va=ya.exports,Ca=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"toFinalOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          To Final Confirmation Order\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Send Order To Final Confirmation Order?\n          ")]),a("div",{attrs:{align:"right"}},[a("div",[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"To Final Confirmation Order",color:"primary",disabled:e.isBtnDisabled},on:{click:e.onAssignLeads}}),e.isBtnDisabled&&"FCO"===e.form.state?a("q-tooltip",[e._v("\n                Order is already in Final Confirmation Order\n              ")]):e.isBtnDisabled&&"home"===e.userBranchType?a("q-tooltip",[e._v("\n                Must have HQ Accountant's acknowledgement\n              ")]):e.isBtnDisabled&&"dealer"===e.userBranchType?a("q-tooltip",[e._v("\n                Must have Branch Manager's acknowledgement\n              ")]):e.isBtnDisabled?a("q-tooltip",[e._v("\n                Must have HQ Accountant's acknowledgement\n              ")]):e._e()],1)])])])],1)])],1)},xa=[],qa={components:{ModalDialog:v},data(){return{selectedLeadId:"",userBranch:{},form:{},suggestedBranchId:"",isBtnDisabled:!1,userBranchType:""}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{selections(){const e=this.$store.getters.tableSelection;if(console.log("selection",e),!e.length)return[];const t=e.map(e=>{const t=[];return t.label=e.name,t.value=e.uuid,t});return t}}),watch:{selectedLeadId(e,t){const a=this.tableSelection.find(t=>t.uuid===e);this.form=n()({},a)},selections(e,t){e.length&&(this.selectedLeadId=this.selections[0].value)}},methods:{reset(){this.selectedLeadId="",this.form={}},onShowDialog(){var e=this;return i()((function*(){e.form=e.$store.getters.tableSelection[0],e.isBtnDisabled="Acknowledged"!==e.form.status,e.isBtnDisabled="FCO"===e.form.state,e.selectedLeadId=e.form.leadId;const{data:t}=yield e.$repository.branch.getById(e.$store.state.user.branchId);e.userBranchType=t.type}))()},onAssignLeads(){var e=this;return i()((function*(){try{yield e.$store.dispatch("ToFco",{orderId:e.$store.getters.tableSelection[0].uuid,leadId:e.$store.getters.tableSelection[0].leadId}),e.$refs.dialog.$children[0].hide(),e.$notify("success","Successfully assigned lead to Final Confirmation Order")}catch(t){console.log(t),e.$notify("error","Error")}}))()}}},wa=qa,ka=Object(b["a"])(wa,Ca,xa,!1,null,null,null),_a=ka.exports,Sa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"submitToManager"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Add Additional Data\n        ")])]),a("q-card-section",[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n          Additional Data\n        ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Total Amount","lazy-rules":"",prefix:"RM",disable:""},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}}),a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload Supporting Documents",color:"teal",multiple:""},on:{uploaded:e.fileUploaded}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{color:"primary",disabled:e.isDisabledSubmit,label:"Submit to manager"},on:{click:e.onSubmit}}),e.isDisabledSubmit&&"Production"===e.form.status?a("q-tooltip",[e._v("\n                Order is already in Production\n              ")]):e._e(),e.isDisabledSubmit&&"Production"!==e.form.status?a("q-tooltip",[e._v("\n                No supporting document uploaded\n              ")]):e._e()],1)],1)],1)],1)],1)])],1)},Da=[],Ia={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isDisabledSubmit:!0,fileUpload:null,options:{races:["Malay","Chinese","Indian","Others"],property_types:["Condo","Terrace House","Semi-D","Bungalow","Shop & Office"]},form:{leadId:"",birthday:"",race:"",propertySize:"",deliveryAddress:"",property_type:"",email:"",amount:""},selection:{}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"}}),methods:{fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const[{name:s}]=e;try{const{files:e}=JSON.parse(t.response),[{name:o}]=e[s],{uuid:r}=a.form;if(!o)throw new Error;yield a.$store.dispatch("AddFCOAttachment",{fileName:s,name:o,type:"Others",orderId:r}),a.isDisabledSubmit=!1,a.$notify("success","File upload success")}catch(o){a.$notify("error","Error uploading attachment "+s)}}))()},onShowDialog(){this.selection=this.$store.getters.tableSelection[0],this.form=n()({},this.selection),console.log(this.form),this.form.amount=this.selection.designs?this.selection.designs.reduce((e,t)=>e+t.totalPrice,0):0,this.form.paymentAttachments&&this.form.paymentAttachments.length&&(this.isDisabledSubmit=!1),"Production"===this.form.status&&(this.isDisabledSubmit=!0)},reset(){this.form={},this.isDisabledSubmit=!0},onSubmit(){var e=this;return i()((function*(){try{const{uuid:t}=e.tableSelection[0];yield e.$store.dispatch("UpdateFCO",{uuid:t,status:"Pending"}),e.reset(),e.$refs.dialog.$children[0].hide(),e.$notify("success","Final Confirmation Order submitted to Branch Manager.")}catch(t){e.$notify("error","Action failed. Please try again")}}))()}}},$a=Ia,Oa=Object(b["a"])($a,Sa,Da,!1,null,null,null),Ta=Oa.exports,Aa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewFinalOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Final Confirmation Order\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8"},[e._v("\n            Order Details\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-chip",{staticClass:"q-ml-md q-my-sm",attrs:{square:"",color:e.statusColour[e.form.status],"text-color":"white"}},[e._v("\n            "+e._s(e.form.displayStatusForFCO)+"\n            "),a("q-tooltip",[e._v("Final Confirmation Order Status")])],1),["Production","Detailer"].includes(e.form.status)?a("div",e._l(e.form.designs,(function(t){return a("q-card",{key:t.uuid,staticClass:"\n            flex\n            items-center\n            justify-around\n            q-mx-lg\n            q-mb-lg\n            q-py-md\n            "},[a("div",{staticClass:"text-center"},[a("p",{staticClass:"text-weight-bold"},[e._v("\n                  Job Number for "+e._s(t.referenceName)+"\n                ")]),a("p",[e._v(e._s(e.form.jobId.toString().slice(0,8))+" "+e._s(t.jobPart))])])])})),1):e._e(),e.form.lead?a("div",{staticClass:"q-gutter-sm justify"},[a("q-input",{staticClass:"col q-pa-none",attrs:{outlined:"",label:"Total Amount","lazy-rules":"",prefix:"RM",disable:""},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}}),e.form.status.includes("Rejected")?a("div",{staticClass:"text-weight-bold text-uppercase text-grey-7 q-mt-lg"},[e._v("\n              Remarks\n              "),e.form.status.includes("Rejected")?a("p",[e._v("\n                "+e._s(e.form.remarks)+"\n              ")]):e._e()]):e._e()],1):e._e(),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8 q-mt-lg"},[e._v("\n            Supporting Documents\n          ")]),a("q-separator"),e.form.paymentAttachments&&e.form.paymentAttachments.length?a("div",[a("div",[a("q-list",{staticClass:"q-my-md",attrs:{bordered:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:e.generatePdf}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v("Quotation Customised Furniture")])],1),e._l(e.form.paymentAttachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{color:"grey-8",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v(e._s(t.fileName))])],1)}))],2)],1)]):a("div",[a("p",[e._v("No attachment found")])]),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8 q-mt-lg"},[e._v("\n            Upload Documents\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload Supporting Documents",color:"teal",multiple:""},on:{uploaded:e.fileUploaded}})],1)])],1)])],1)},Ra=[],ja=a("5f36"),Na={components:{ModalDialog:v},data(){return{statusColour:{"Follow Up":"secondary",Pending:"secondary",Submitted:"secondary",Detailer:"secondary","BM Rejected":"negative","HQA Rejected":"negative",Production:"success"},options:{races:["Malay","Chinese","Indian","Others"],property_types:["Condo","Terrace House","Semi-D","Bungalow","Shop & Office"]},form:{leadId:"",ic:"",birthday:"",race:"",propertySize:"",deliveryAddress:"",property_type:"",email:"",amount:""},selectedLeadId:"",quotation:[],drawings:{},lumpsum:0,selection:{}}},computed:n()(n()({},Object(C["b"])(["tableSelection","roles"])),{},{isUserRoleDetailer(){const[e]=this.roles;return"detailer"===e},depositPdfUrl(){return this.form&&this.form.attachedDocumentDeposit?"https://api-prod.skcrm.com.my/containers/download/"+this.form.attachedDocumentDeposit:null},fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"}}),methods:{fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const[{name:s}]=e;try{const{files:e}=JSON.parse(t.response),[{name:o}]=e[s],{uuid:r}=a.form;if(!o)throw new Error;console.log({isUserRoleDetailer:a.isUserRoleDetailer}),yield a.$store.dispatch("AddFCOAttachment",{fileName:s,name:o,orderId:r,type:a.isUserRoleDetailer?"Detailer":""}),a.isDisabledSubmit=!1,yield a.$store.dispatch("GetFcoLeads",{}),a.$notify("success","File upload success")}catch(o){console.log(o),a.$notify("error","Error uploading attachment "+s)}}))()},onShowDialog(){var e=this;return i()((function*(){e.selection=e.$store.getters.tableSelection[0];const[{uuid:t}]=e.tableSelection,[a]=yield ja["a"].query().withAll().whereId(t).get();e.form=a,e.form.amount=e.selection.designs?e.selection.designs.reduce((e,t)=>e+t.discountedTotalPrice,0):0,e.form.paymentAttachments&&e.form.paymentAttachments.length&&(e.isDisabledSubmit=!1),e.quotation=[],e.selectedLeadId=e.form.leadId,e.drawings=e.form.designs,console.log(e.drawings),e.drawings.forEach(function(){var t=i()((function*(t){const a=yield e.$store.dispatch("GetDesigns",t.uuid);e.quotation.push(a),console.log("res",a)}));return function(e){return t.apply(this,arguments)}}()),console.log("das",e.quotation)}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===na["vfs"]&&(na["vfs"]=ca["pdfMake"].vfs),console.log("quotes",JSON.stringify(e.quotation)),console.log("form",e.form);const a=e.form.lead.userId,s=e.form.lead.branchId,[o]=X["a"].query().withAll().whereId(a).get();console.log(o);const[r]=$["a"].query().withAll().whereId(s).get(),{lead:i}=e.form;var l=[],n=0,c=0,d=0;l.push([{text:"Item",style:"headerTitle"},{text:"Description",style:"headerTitle"},{text:"Qty",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"Unit Price\n(RM)",alignment:"center",style:"headerTitle"},{text:"Discount\n(%)",alignment:"center",style:"headerTitle"},{text:"Amount\n(RM)",alignment:"center",style:"headerTitle"}]);try{for(var m of e.quotation)m.quotationDetails[0].quantity<1&&(m.quotationDetails[0].quantity=1),n+=m.discountedTotalPriceDrawingItems*m.quotationDetails[0].quantity,c+=m.totalInstallationCharges,d+=m.transportationCharge,m.quotationDetails&&l.push([m.referenceName,m.materials,{text:m.quotationDetails[0].quantity,alignment:"center"},{text:"Set",alignment:"center"},{text:m.totalPriceDrawingItems.toFixed(2),alignment:"right"},{text:m.masterItemDiscount,alignment:"center"},{text:m.discountedTotalPriceDrawingItems.toFixed(2)*m.quotationDetails[0].quantity,alignment:"right"}]);for(var u of e.quotation)if(u.tradingItems)for(var p of u.tradingItems)n+=p.stdcost,l.push([p.category,p.name,{text:p.designAdditionalItems[0].quantity,alignment:"center"},{text:p.uom,alignment:"center"},{text:p.stdcost.toFixed(2),alignment:"right"},{text:100*p.designAdditionalItems[0].discount,alignment:"center"},{text:(p.stdcost*p.designAdditionalItems[0].quantity*(1-p.designAdditionalItems[0].discount)).toFixed(2),alignment:"right"}]);for(var h of(l.push([{text:" ",colSpan:7},{text:" ",colSpan:7}]),e.drawings))h.lumpsum&&(e.lumpsum=h.lumpsum),h.isIncludedInstallationCharge&&l.push([{text:"Others"},{text:"Installation Charges"},{text:"",colSpan:4},{},{},{},{text:h.totalInstallationCharges.toFixed(2),alignment:"right"}]),h.isIncludedTransportationCharge&&l.push([{text:"Others"},{text:"Transportation Charges"},{text:"",colSpan:4},{},{},{},{text:h.transportationCharge.toFixed(2),alignment:"right"}]),h.isIncludedInstallerOutstationCharge&&l.push([{text:"Others"},{text:"Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:h.installerOutstationCharge.toFixed(2),alignment:"right"}]),h.isIncludedWorktopOutstationCharge&&l.push([{text:"Others"},{text:"Worktop Outstation Charges"},{text:"",colSpan:4},{},{},{},{text:h.installerOutstationCharge.toFixed(2),alignment:"right"}]);n+=c+d}catch(v){console.log("error bro",v),e.$notify("error","No Quotation Details")}const f=.08*n,g=n+f-e.lumpsum,b=Math.floor(g);var y={images:{logo:"https://static.wixstatic.com/media/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg/v1/fill/w_32%2Ch_32%2Clg_1%2Cusm_0.66_1.00_0.01/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg"},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:"Quotation Customized Furniture",style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",i.name],["Contact No",":",i.phone],["Email",":",i.email]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(o.updatedAt,"DD MMM YYYY")],["Summary Quotation No",":",e.form.quotationNumber],["Branch",":",r.name],["SC Name",":",o.name],["SC Contact No",":",o.mobile]]},layout:"noBorders"}]]},layout:"noBorders",style:"pagePadding"},{style:"tableExample",table:{widths:[80,"*","auto","auto",50,40,50],body:l}},{table:{widths:[80,"*","auto","auto",50,40,50],body:[[{stack:["\nTerms & Condition",{ol:["Prices quoted are subject to site measurement, design amendment and material selection","Prices quoted exclude electrical, plumbing, ducting and masonry work","Prices quoted inclusive of delivery and installation","Payment terms: 10% deposit, 30% upon final confirmation","Price validity: 30 days from date hereoff","Deposit paid are non refundable"]}],colSpan:4,rowSpan:7,border:[!0,!1,!0,!0]},"","","",{text:"Total",style:"footerTitle",colSpan:2,border:[!0,!1,!0,!0]},{},{text:n.toFixed(2),style:"priceCol",border:[!0,!1,!0,!0]}],["","","","",{text:"Round Up Discount",colSpan:2,style:"footerTitle"},{},{text:e.lumpsum.toFixed(2),style:"priceCol"}],["","","","",{text:"GST/SST",style:"footerTitle",colSpan:2},{},{text:f.toFixed(2),style:"priceCol"}],["","","","",{text:"Nett Total",style:"footerTitle",colSpan:2},{},{text:g.toFixed(2),style:"priceCol"}],["","","","",{text:"Round-Down",style:"footerTitle",colSpan:2},{},{text:b.toFixed(2),style:"priceCol"}],["","","","",{text:"Down Payment",style:"footerTitle",colSpan:2},{},{text:"0.00",style:"priceCol"}],["","","","",{text:"Balance Payment",style:"footerTitle",colSpan:2},{},{text:b.toFixed(2),style:"priceCol"}]]}},{table:{widths:["*","auto"],body:[[{stack:["Yours Faithfully",{text:"",style:"topMargin"},"_______________________________",o.name,o.mobile,o.email]},{stack:["Agreed and confirmed by",{text:"",style:"topMargin"},"_______________________________","Customer Name :   "+i.name,"IC No : "]}]]},layout:"noBorders",style:"pagePadding"}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"portrait"};na["createPdf"](y).open()}))()},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},openPdfInNewPage(e){window.open(e,"_blank")},reset(){}}},Ma=Na,Ea=Object(b["a"])(Ma,Aa,Ra,!1,null,null,null),Pa=Ea.exports,La=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"actionsFinalOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Final Confirmation Order Actions\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Acknowledge or Reject\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",{staticClass:"q-mx-sm"},[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:e.isDisabledReject},on:{click:e.onClickReject}}),e.isDisabledReject&&!e.isRemarksFilled&&e.isOrderPendingBMApproval?a("q-tooltip",[e._v("\n            Remarks is required\n          ")]):e._e(),e.isDisabledReject&&!e.isOrderPendingBMApproval?a("q-tooltip",[e._v("\n            Order is not pending BM approval.\n          ")]):e._e()],1),a("div",[a("q-btn",{attrs:{label:"Acknowledge",color:"positive",disable:e.isDisabledAcknowledged},on:{click:e.onClickAcknowledge}}),e.isDisabledAcknowledged?a("q-tooltip",[e._v("\n            Order is not pending BM approval or Rejected by HQ Accountant.\n          ")]):e._e(),a("div")],1)],1)],1)])],1)},Fa=[],Ua={components:{ModalDialog:v},mixins:[x["a"]],data(){return{form:{},remarks:""}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isOrderPendingBMApproval(){return this.form&&"Pending"===this.form.status},isOrderHQARejected(){return this.form&&"HQA Rejected"===this.form.status},isRemarksFilled(){return!!this.remarks.length},isDisabledReject(){return!this.isOrderPendingBMApproval||!this.isRemarksFilled},isDisabledAcknowledged(){return!(this.isOrderHQARejected||this.isOrderPendingBMApproval)}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=e.tableSelection[0],console.log(e.tableSelection[0])}))()},reset(){this.remarks=""},onClickAcknowledge(){var e=this;return i()((function*(){try{yield e.$store.dispatch("FinalOrderConfirmationSubmitted",{orderId:e.tableSelection[0].uuid}),e.reset(),e.$notify("success","Order state successfully updated")}catch(t){e.$notify("error","Order state failed to be updated")}}))()},onClickReject(){var e=this;return i()((function*(){try{e.$store.dispatch("FinalOrderConfirmationBMRejected",{orderId:e.tableSelection[0].uuid,remarks:e.remarks}),e.reset(),e.$notify("success","Order state successfully updated")}catch(t){e.$notify("error","Order state failed to be updated")}}))()}}},Ba=Ua,za=Object(b["a"])(Ba,La,Fa,!1,null,null,null),Ga=za.exports,Ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"finalConfirmationOrderApproveForProduction"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Submit FCO to Detailer\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Submit or Reject\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("p",[e._v("Approve for production and get automatically generated job number?")]),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",{staticClass:"q-mx-sm"},[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:!e.isOrderPendingHQACApproval&&e.isDisabledReject},on:{click:e.onClickReject}}),e.isDisabledReject?a("q-tooltip",[e._v("\n            Remarks is required\n          ")]):e._e(),e.isOrderPendingHQACApproval?e._e():a("q-tooltip",[e._v("\n            Order is not pending HQAC approval\n          ")])],1),a("div",[a("q-btn",{attrs:{label:"Submit",color:"positive",disable:!e.isOrderPendingHQACApproval},on:{click:e.onClickSubmit}}),e.isOrderPendingHQACApproval?e._e():a("q-tooltip",[e._v("\n            Order is not pending HQAC approval\n          ")]),a("div")],1)],1)],1)])],1)},Qa=[],Ja={components:{ModalDialog:v},mixins:[x["a"]],data(){return{remarks:"",form:{}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isOrderPendingHQACApproval(){return this.form&&"Submitted"===this.form.status},isDisabledReject(){return!this.remarks.length}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0])}))()},reset(){},onClickSubmit(){var e=this;return i()((function*(){try{yield e.$store.dispatch("FinalOrderConfirmationSubmitToDetailer",{orderId:e.tableSelection[0].uuid}),e.reset(),e.$notify("success","Order submitted to Detailer")}catch(t){console.log(t),e.$notify("error","Order state failed to be updated")}}))()},onClickReject(){var e=this;return i()((function*(){try{e.$store.dispatch("FinalOrderConfirmationHQARejected",{orderId:e.tableSelection[0].uuid,remarks:e.remarks}),e.reset(),e.$notify("success","Order rejected and sent back to Branch Manager")}catch(t){e.$notify("error","Order state failed to be updated")}}))()}}},Ya=Ja,Ka=Object(b["a"])(Ya,Ha,Qa,!1,null,null,null),Va=Ka.exports,Wa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"addExhibition"},on:{"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Add Campaign\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onAddExhibition}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Add into Campaign List\n            ")]),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Campaign Name","lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),a("q-input",{staticClass:"q-pa-none",attrs:{value:e.convertedDate(e.form.startDate),label:"Start Date",filled:"",mask:"##/##/####"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{options:e.startDateOptions},model:{value:e.form.startDate,callback:function(t){e.$set(e.form,"startDate",t)},expression:"form.startDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("q-input",{staticClass:"q-pa-none",attrs:{value:e.convertedDate(e.form.endDate),label:"End Date",filled:"",mask:"##/##/####"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{options:e.endDateOptions},model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("q-input",{staticClass:"q-pa-none",attrs:{value:e.convertedDate(e.form.hideDate),label:"Hide Date",filled:"",mask:"##/##/####"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.hideDate,callback:function(t){e.$set(e.form,"hideDate",t)},expression:"form.hideDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit"},on:{click:e.onAddExhibition}})],1)],1)])],1)],1)])],1)},Xa=[],Za={components:{ModalDialog:v},data(){return{dialog:{show:!1,userId:""},form:{name:"",startDate:"",endDate:"",hideDate:""}}},created(){},methods:{reset(){this.form={name:"",startDate:"",endDate:"",hideDate:""}},onAddExhibition(){var e=this;return i()((function*(){const t=new Date(2017,2,5);console.log(t);const a=yield e.$store.dispatch("CheckExhibitionExist",e.form.name);a?e.$notify("error","A campaign with this name has already been created, please use a different campaign name"):e.$refs.myForm.validate().then(function(){var t=i()((function*(t){t?(yield e.$store.dispatch("AddExhibition",e.form),e.$notify("success","Exhibition created!"),e.reset(),e.$refs.dialog.$children[0].hide()):e.$notify("error","All field is required")}));return function(e){return t.apply(this,arguments)}}())}))()},convertedDate(e){let t=e.split("/");return t=`${t[2]}/${t[1]}/${t[0]}`,t},startDateOptions(e){return""===this.form.endDate||e<this.form.endDate},endDateOptions(e){return""===this.form.startDate||e>this.form.startDate}}},es=Za,ts=Object(b["a"])(es,Wa,Xa,!1,null,null,null),as=ts.exports,ss=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"deleteExhibition"}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Are you sure?\n      ")])]),a("q-card-section",{staticClass:"row items-center"},[e._v("\n      Do you really want to delete this\n      "),a("span",{staticClass:"text-weight-bold"},[e._v(e._s(e.tableSelection.length)+" record(s)")]),e._v(" ?\n    ")]),a("q-card-section",{staticClass:"row items-center text-negative text-weight-bold"},[e._v("\n      This process cannot be undone\n    ")]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Delete",color:"negative"},on:{click:e.onClickDelete}})],1)],1)],1)},os=[],rs={components:{ModalDialog:v},computed:n()({},Object(C["b"])(["datatabs","activeDataTab","tableSelection"])),methods:{onClickDelete(){var e=this;this.tableSelection.forEach(function(){var t=i()((function*(t){try{yield e.$store.dispatch("DeleteExhibition",t.uuid),e.$refs.dialog.$children[0].hide(),e.$notify("success","Delete item successful!")}catch(a){const t=a.response.data.error.message;console.log(t),e.$notify("error","Error: "+t)}}));return function(e){return t.apply(this,arguments)}}()),this.$store.dispatch("OnTableSelection",[])}}},is=rs,ls=Object(b["a"])(is,ss,os,!1,null,null,null),ns=ls.exports,cs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"downloadMissingItem"},on:{"show-dialog":e.onShowDialog,"close-dialog":e.reset}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Download Missing Item List\n      ")])]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("q-btn",{attrs:{label:"Download",icon:"fas fa-file-csv",color:"positive"},on:{click:e.onClickDownload}})],1)],1)],1)},ds=[],ms={components:{ModalDialog:v},data(){return{csv:""}},methods:{onShowDialog(){var e=this;return i()((function*(){let t=yield e.$store.dispatch("GetAllMissingItems");t=t.map(e=>e.getBodyRequest),t.unshift({name:"Name",brandGoodName:"brandGoodName",productNumber:"productNumber",drawingNumber:"drawingNumber"}),e.csv=Object(E["f"])(t)}))()},onClickDownload(){var e="export_missing_items.csv",t=new Blob([this.csv],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){var s=URL.createObjectURL(t);a.setAttribute("href",s),a.setAttribute("download",e),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},reset(){}}},us=ms,ps=Object(b["a"])(us,cs,ds,!1,null,null,null),hs=ps.exports,fs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",staticStyle:{height:"500px"},attrs:{name:"pendingQL"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",[a("q-card-section",{staticClass:"bg-black text-white"},[a("div",{staticClass:"text-h6"},[e._v("\n        Are you sure?\n      ")])]),a("q-card-section",{staticClass:"row items-center"},[e._v("\n      Change lead status to Follow Up?\n    ")]),a("q-card-section",{staticClass:"row items-center text-negative text-weight-bold"},[e._v("\n      This process cannot be undone\n    ")]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Submit",color:"positive",disable:e.isBtnDisabled},on:{click:e.onClickDelete}}),e.isBtnDisabled?a("q-tooltip",[e._v("\n          Lead status is not Assigned\n        ")]):e._e()],1)],1)],1)],1)},gs=[],bs={components:{ModalDialog:v},data(){return{form:{}}},computed:n()(n()({},Object(C["b"])(["datatabs","activeDataTab","tableSelection"])),{},{isBtnDisabled(){return"Assigned"!==this.form.status}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0])}))()},onClickDelete(){var e=this;return i()((function*(){try{yield e.$store.dispatch("PendingVisitQualifiedLead",e.form),e.$refs.dialog.$children[0].hide(),e.$notify("success","Lead updated successfully!")}catch(t){console.log(t);const a=t.response.data.error.message;e.$notify("error","Error: "+a)}e.$store.dispatch("OnTableSelection",[])}))()},reset(){this.form={}}}},ys=bs,vs=Object(b["a"])(ys,fs,gs,!1,null,null,null),Cs=vs.exports,xs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"leadLost"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Lost Lead\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-center text-grey-8"},[e._v('\n            Set Lead status to "Lost"?\n          ')]),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"Yes",color:"primary"},on:{click:e.onSetLeadToLost}})],1)])])],1)])],1)},qs=[],ws={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{}}},computed:n()({},Object(C["b"])(["tableSelection"])),watch:{},methods:{onShowDialog(){this.form=this.$store.getters.tableSelection[0],this.selectedLeadId=this.form.uuid},onSetLeadToLost(){var e=this;return i()((function*(){try{yield e.$store.dispatch("UpdateLead",{uuid:e.selectedLeadId,status:"Lost"}),yield e.$store.dispatch("GetDesignLeads",{}),e.$notify("success","Successfully set lead status to Lost"),e.$refs.dialog.$children[0].hide()}catch(t){console.log(t),e.$notify("error","Error")}}))()},reset(){this.selectedLeadId="",this.form={}}}},ks=ws,_s=Object(b["a"])(ks,xs,qs,!1,null,null,null),Ss=_s.exports,Ds=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"cancelOrderConfirmation"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Cancel Order Confirmation\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Are you sure you want to cancel the selected order?\n          ")]),a("q-separator",{staticClass:"q-my-md"})],1)]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"No"}}),a("q-btn",{attrs:{label:"Cancel",color:"negative"},on:{click:e.onClickCancel}})],1)],1)])],1)},Is=[],$s={components:{ModalDialog:v},data(){return{form:{}}},computed:n()({},Object(C["b"])(["tableSelection"])),methods:{onShowDialog(){var e=this;return i()((function*(){const[t]=e.tableSelection;e.form=t}))()},reset(){},onClickCancel(){var e=this;return i()((function*(){try{yield e.$store.dispatch("UpdateFCO",{uuid:e.form.uuid,status:"Cancelled"}),e.$notify("success","Sucessfully cancelled order."),e.$refs.dialog.$children[0].hide()}catch(t){console.log(t),e.$notify("error","Error updating order state.")}}))()}}},Os=$s,Ts=Object(b["a"])(Os,Ds,Is,!1,null,null,null),As=Ts.exports,Rs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewCampaign"},on:{"show-dialog":e.onShowDialog,"close-dialog":e.reset}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          View/Edit Campaign\n        ")])]),a("q-card-section",[a("q-form",{ref:"myForm",on:{submit:e.onAddExhibition}},[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n              Edit Campaign List\n            ")]),a("q-input",{staticClass:"col q-pb-none",attrs:{outlined:"",label:"Campaign Name","lazy-rules":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),a("q-input",{staticClass:"q-pa-none",attrs:{label:"Start Date",filled:"",mask:"date",rules:["date"]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.startDate,callback:function(t){e.$set(e.form,"startDate",t)},expression:"form.startDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.startDate,callback:function(t){e.$set(e.form,"startDate",t)},expression:"form.startDate"}}),a("q-input",{staticClass:"q-pa-none",attrs:{label:"End Date",filled:"",mask:"date",rules:["date"]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.endDate,callback:function(t){e.$set(e.form,"endDate",t)},expression:"form.endDate"}}),a("q-input",{staticClass:"q-pa-none",attrs:{label:"Hide Date",filled:"",mask:"date",rules:["date"]},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{model:{value:e.form.hideDate,callback:function(t){e.$set(e.form,"hideDate",t)},expression:"form.hideDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.hideDate,callback:function(t){e.$set(e.form,"hideDate",t)},expression:"form.hideDate"}}),a("q-separator"),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{color:"primary",label:"Submit"},on:{click:e.onAddExhibition}})],1)],1)])],1)],1)])],1)},js=[],Ns={components:{ModalDialog:v},data(){return{dialog:{show:!1,userId:""},form:{name:"",startDate:"",endDate:"",hideDate:""}}},computed:n()({},Object(C["b"])(["tableSelection"])),created(){},methods:{reset(){this.form={name:"",startDate:"",endDate:"",hideDate:""}},onShowDialog(){this.form=n()({},this.tableSelection[0]),console.log(this.form)},onAddExhibition(){var e=this;return i()((function*(){e.$refs.myForm.validate().then(function(){var t=i()((function*(t){t?(yield e.$store.dispatch("UpdateExhibition",e.form),e.$notify("success","Exhibition updated!"),e.reset(),e.$refs.dialog.$children[0].hide()):e.$notify("error","All field is required")}));return function(e){return t.apply(this,arguments)}}())}))()}}},Ms=Ns,Es=Object(b["a"])(Ms,Rs,js,!1,null,null,null),Ps=Es.exports,Ls=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},["ServiceReport"===e.form.type?a("div",{staticClass:"text-white text-h6"},[e._v("\n          Service Report\n        ")]):e._e(),"MaintenanceReport"===e.form.type?a("div",{staticClass:"text-white text-h6"},[e._v("\n          Report Maintenance\n        ")]):e._e()]),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-uppercase text-grey-7"},[e._v("\n        Report Details\n      ")]),e.form.jobNumber?a("q-chip",{staticClass:"q-ml-md q-my-sm",attrs:{square:"","text-color":"white"}},[e._v("\n        "+e._s(e.form.jobNumber.split(" ")[0])+"\n        "),a("q-tooltip",[e._v("Job Number")])],1):e._e(),a("q-separator",{staticClass:"q-my-md"}),"salesconsultant"===e.roles[0]||"sysadmin"===e.roles[0]?a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-grey-7"},[e._v("\n        Sales Consultant Remarks\n        "),a("q-input",{staticClass:"q-ma-md",attrs:{filled:"",type:"textarea"},model:{value:e.form.remarksSalesConsultant,callback:function(t){e.$set(e.form,"remarksSalesConsultant",t)},expression:"form.remarksSalesConsultant"}}),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Update Remarks"},on:{click:e.onClickUpdateRemarksSalesConsultant}})],1),a("q-separator",{staticClass:"q-my-md"})],1):e._e(),"Rejected"===e.form.state?a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-grey-7"},[e._v("\n        Rejected Remarks\n        "),a("q-input",{staticClass:"q-ma-md",attrs:{filled:"",disable:"",type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}}),a("q-separator",{staticClass:"q-my-md"})],1):e._e(),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-grey-7"},[e._v("\n        Attachments\n      ")]),a("div",{staticClass:"q-ma-md"},[a("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:e.fileUploadUrl,label:"Upload",color:"teal",multiple:""},on:{uploaded:e.fileUploaded}})],1),e.attachments?a("q-list",{staticClass:"q-ma-md",attrs:{bordered:""}},e._l(e.attachments,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.uuid,attrs:{clickable:""},on:{click:function(a){return e.openAttachment(t.name)}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{size:"sm",name:"fas fa-paperclip"}})],1),a("q-item-section",[e._v(e._s(t.fileName))])],1)})),1):e._e(),a("q-card-actions",{attrs:{align:"right"}},["detailer"!==e.roles[0]&&"sysadmin"!==e.roles[0]||"Closed"===e.form.state?e._e():a("q-btn",{attrs:{color:"secondary",label:"Edit Report"},on:{click:e.onClickEditReport}}),a("q-btn",{attrs:{color:"primary",label:"View Report"},on:{click:e.generatePdf}})],1)],1)])],1)},Fs=[],Us={components:{ModalDialog:v},data(){return{statusColour:{New:"success",Rejected:"negative",Detailer:"secondary"},selection:{},form:{},items:[],title:"",attachments:[]}},computed:n()(n()({},Object(C["b"])(["tableSelection","roles"])),{},{fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.selection=e.$store.getters.tableSelection[0],e.form=n()({},e.selection),e.reportId=e.form.uuid;const{data:t}=yield e.$repository.serviceReport.getById(e.reportId,{include:[{relation:"attachments"}]});e.attachments=t.attachments}))()},openAttachment(e){const t="https://api-prod.skcrm.com.my/containers/download/"+e;window.open(t,"_blank")},fileUploaded({files:e,xhr:t}){var a=this;return i()((function*(){console.log({files:e,xhr:t});const[{name:s}]=e;try{const{files:e}=JSON.parse(t.response),[{name:o}]=e[s],r=a.reportId;if(!o)throw new Error;yield a.$repository.serviceReport.addAttachment(r,o,s);const{data:i}=yield a.$repository.serviceReport.getById(a.reportId,{include:[{relation:"attachments"}]});a.attachments=i.attachments,a.$notify("success","File upload success")}catch(o){a.$notify("error","Error uploading attachment "+s)}}))()},onClickEditReport(){const{uuid:e}=this.selection,t=this.$router.resolve({path:"service-report/"+e});window.open(t.href,"_blank")},onClickUpdateRemarksSalesConsultant(){var e=this;return i()((function*(){try{yield e.$repository.serviceReport.updateById(e.reportId,{remarksSalesConsultant:e.form.remarksSalesConsultant}),e.$notify("success","Remarks Updated")}catch(t){e.$notify("negative","Remarks failed to be updated")}}))()},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===na["vfs"]&&(na["vfs"]=ca["pdfMake"].vfs);const{data:a}=yield e.$repository.lead.getById(e.form.leadId),{data:s}=yield e.$repository.user.getById(e.form.userId),{data:o}=yield e.$repository.branch.getById(s.branchId);if("MaintenanceReport"===e.form.type?e.title="Report Maintenance Quotation(MR)":e.title="Service Report Quotation(SR)","factory"===e.roles[0]||"sysadmin"===e.roles[0]){const i=[];if(i.push([{text:"QTY",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"MODEL",alignment:"center",style:"headerTitle"},{text:"DESCRIPTION",style:"headerTitle",alignment:"center"},{text:"WIDTH",style:"headerTitle",alignment:"center"},{text:"HEIGHT",style:"headerTitle",alignment:"center"},{text:"DEPTH",style:"headerTitle",alignment:"center"},{text:"MATERIAL",style:"headerTitle",alignment:"center"},{text:"COLOUR",style:"headerTitle",alignment:"center"},{text:"PROFILE",style:"headerTitle",alignment:"center"}]),e.form.items.length>0)for(const t of e.form.items)i.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:t.item.uom,alignment:"center",style:"headerTitle"},{text:t.item.itemcode,alignment:"center",style:"headerTitle"},{text:t.item.name,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material.material,alignment:"center",style:"headerTitle"},{text:t.material.colour,alignment:"center",style:"headerTitle"},{text:t.material.profile,alignment:"center",style:"headerTitle"}]);if(e.form.customItems.length>0)for(const t of e.form.customItems)i.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:"Unit",alignment:"center",style:"headerTitle"},{text:"-",alignment:"center",style:"headerTitle"},{text:t.item,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material,alignment:"center",style:"headerTitle"},{text:t.colour,alignment:"center",style:"headerTitle"},{text:t.profile,alignment:"center",style:"headerTitle"}]);i.push([{text:"Remarks:  "+e.form.remarks,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{}]),i.push([{text:"Remarks SC:  "+e.form.remarksSalesConsultant,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{}]);var r={images:{logo:"https://static.wixstatic.com/media/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg/v1/fill/w_32%2Ch_32%2Clg_1%2Cusm_0.66_1.00_0.01/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg"},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:e.title,style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",a.name],["Customer Tel No",":",a.phone],["Customer Address",":",a.siteAddress],["Job No",":",e.form.jobNumber]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(s.updatedAt,"DD MMM YYYY")],["Branch Code",":",o.code],["SC Name",":",s.name],["SC Tel No",":",s.mobile],["Installer",":",e.form.installer],["Date Installed",":",t(e.form.installedDate,"DD MMM YYYY")]]},layout:"noBorders",alignment:"right"}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:[20,25,30,"*","*",30,30,30,40,60,60],body:i}}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0,fontSize:8},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"landscape"};na["createPdf"](r).open()}if("purchaser"===e.roles[0]||"logistic"===e.roles[0]||"detailer"===e.roles[0]||"salesconsultant"===e.roles[0]||"sysadmin"===e.roles[0]){const r=[];let l=0;if(r.push([{text:"QTY",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"MODEL",alignment:"center",style:"headerTitle"},{text:"DESCRIPTION",style:"headerTitle",alignment:"center"},{text:"WIDTH",style:"headerTitle",alignment:"center"},{text:"HEIGHT",style:"headerTitle",alignment:"center"},{text:"DEPTH",style:"headerTitle",alignment:"center"},{text:"MATERIAL",style:"headerTitle",alignment:"center"},{text:"COLOUR",style:"headerTitle",alignment:"center"},{text:"PROFILE",style:"headerTitle",alignment:"center"},{text:"U/PRICE",style:"headerTitle",alignment:"center"},{text:"AMOUNT",style:"headerTitle",alignment:"center"}]),e.form.items.length>0)for(const t of e.form.items)r.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:t.item.uom,alignment:"center",style:"headerTitle"},{text:t.item.itemcode,alignment:"center",style:"headerTitle"},{text:t.item.name,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material.material,alignment:"center",style:"headerTitle"},{text:t.material.colour,alignment:"center",style:"headerTitle"},{text:t.material.profile,alignment:"center",style:"headerTitle"},{text:t.material.price.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.quantity).toFixed(2),alignment:"center",style:"headerTitle"}]),l=parseFloat(l+t.material.price*t.quantity);if(e.form.customItems.length>0)for(const t of e.form.customItems)r.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:"Unit",alignment:"center",style:"headerTitle"},{text:"-",alignment:"center",style:"headerTitle"},{text:t.item,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material,alignment:"center",style:"headerTitle"},{text:t.colour,alignment:"center",style:"headerTitle"},{text:t.profile,alignment:"center",style:"headerTitle"},{text:t.unitPrice.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.unitPrice*t.quantity).toFixed(2),alignment:"center",style:"headerTitle"}]),l=parseFloat(l)+t.amount;r.push([{text:"Remarks:  "+e.form.remarks,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{},{},{}]),r.push([{text:"Remarks SC:  "+e.form.remarksSalesConsultant,colSpan:10,bold:!0},{},{},{},{},{},{},{},{},{},"Total",{text:l.toFixed(2),alignment:"center",style:"headerTitle"}]);var i={images:{logo:"https://static.wixstatic.com/media/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg/v1/fill/w_32%2Ch_32%2Clg_1%2Cusm_0.66_1.00_0.01/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg"},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:e.title,style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",a.name],["Customer Tel No",":",a.phone],["Customer Address",":",a.siteAddress],["Job No",":",e.form.jobNumber]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(s.updatedAt,"DD MMM YYYY")],["Branch Code",":",o.code],["SC Name",":",s.name],["SC Tel No",":",s.mobile],["Installer",":",e.form.installer],["Date Installed",":",t(e.form.installedDate,"DD MMM YYYY")]]},layout:"noBorders",alignment:"right"}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:[20,25,30,"*","*",30,30,30,40,35,60,40,40],body:r}}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0,fontSize:8},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"landscape"};na["createPdf"](i).open()}if("hQAccountant"===e.roles[0]||"sysadmin"===e.roles[0]){var l=[],n=0,c=0,d=0;if(l.push([{text:"QTY",alignment:"center",style:"headerTitle"},{text:"UOM",alignment:"center",style:"headerTitle"},{text:"MODEL",alignment:"center",style:"headerTitle"},{text:"DESCRIPTION",style:"headerTitle",alignment:"center"},{text:"WIDTH",style:"headerTitle",alignment:"center"},{text:"HEIGHT",style:"headerTitle",alignment:"center"},{text:"DEPTH",style:"headerTitle",alignment:"center"},{text:"MATERIAL",style:"headerTitle",alignment:"center"},{text:"COLOUR",style:"headerTitle",alignment:"center"},{text:"PROFILE",style:"headerTitle",alignment:"center"},{text:"U/PRICE",style:"headerTitle",alignment:"center"},{text:"AMOUNT",style:"headerTitle",alignment:"center"},{text:"DEALER PRICE",style:"headerTitle",alignment:"center"},{text:"SM PRICE",style:"headerTitle",alignment:"center"}]),e.form.items.length>0)for(const t of e.form.items)l.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:t.item.uom,alignment:"center",style:"headerTitle"},{text:t.item.itemcode,alignment:"center",style:"headerTitle"},{text:t.item.name,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material.material,alignment:"center",style:"headerTitle"},{text:t.material.colour,alignment:"center",style:"headerTitle"},{text:t.material.profile,alignment:"center",style:"headerTitle"},{text:t.material.price.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.quantity).toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.item.dealerprice).toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.material.price*t.item.SMPrice).toFixed(2),alignment:"center",style:"headerTitle"}]),n=parseFloat(n+t.material.price*t.quantity),c=parseFloat(c+t.material.price*t.item.dealerprice),d=parseFloat(d+t.material.price*t.item.SMPrice);if(e.form.customItems.length>0){console.log("here",n);for(const t of e.form.customItems)l.push([{text:t.quantity,alignment:"center",style:"headerTitle"},{text:"Unit",alignment:"center",style:"headerTitle"},{text:"-",alignment:"center",style:"headerTitle"},{text:t.item,alignment:"center",style:"headerTitle"},{text:t.width,alignment:"center",style:"headerTitle"},{text:t.height,alignment:"center",style:"headerTitle"},{text:t.depth,alignment:"center",style:"headerTitle"},{text:t.material,alignment:"center",style:"headerTitle"},{text:t.colour,alignment:"center",style:"headerTitle"},{text:t.profile,alignment:"center",style:"headerTitle"},{text:t.unitPrice.toFixed(2),alignment:"center",style:"headerTitle"},{text:(t.unitPrice*t.quantity).toFixed(2),alignment:"center",style:"headerTitle",colSpan:3}]),n=parseFloat(n)+t.amount,c=parseFloat(c)+t.amount,d=parseFloat(d)+t.amount}l.push([{text:"Remarks:  "+e.form.remarks,colSpan:11,bold:!0},{},{},{},{},{},{},{},{},{},{},{},{},{}]),l.push([{text:"Remarks SC:  "+e.form.remarksSalesConsultant,colSpan:11,bold:!0},{},{},{},{},{},{},{},{},{},{},"Total",{text:n.toFixed(2),alignment:"center",style:"headerTitle"},{text:c.toFixed(2),alignment:"center",style:"headerTitle"},{text:d.toFixed(2),alignment:"center",style:"headerTitle"}]);var m={images:{logo:"https://static.wixstatic.com/media/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg/v1/fill/w_32%2Ch_32%2Clg_1%2Cusm_0.66_1.00_0.01/009a0e_59f32ce0391b45e29906d923b29cba59%7Emv2.jpg"},content:[{table:{widths:["auto",300,"*"],body:[[{image:"logo"},{stack:[{text:"SIGNATURE KITCHEN SDN BHD"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor"}]},{text:e.title,style:"header",alignment:"center"}]]},layout:"noBorders"},{table:{widths:["*","*"],body:[[{table:{widths:["auto",5,"*"],body:[["Customer Name",":",a.name],["Customer Tel No",":",a.phone],["Customer Address",":",a.siteAddress],["Job No",":",e.form.jobNumber]]},layout:"noBorders"},{table:{widths:["*",5,"auto"],body:[["Date",":",t(s.updatedAt,"DD MMM YYYY")],["Branch Code",":",o.code],["SC Name",":",s.name],["SC Tel No",":",s.mobile],["Installer",":",e.form.installer],["Date Installed",":",t(e.form.installedDate,"DD MMM YYYY")]]},layout:"noBorders",alignment:"right"}]]},layout:"noBorders",style:"pagePadding"},{table:{widths:[20,25,30,70,70,30,30,30,40,35,"*","*","*","*","*"],body:l}}],styles:{header:{bold:!0,fontSize:16},pagePadding:{margin:[16,16,16,16]},topMargin:{margin:[0,24,0,0]},priceCol:{alignment:"right"},headerTitle:{bold:!0,fontSize:8},footerTitle:{alignment:"right",bold:!0}},defaultStyle:{fontSize:10},pageSize:"A4",pageOrientation:"landscape"};na["createPdf"](m).open()}}))()},reset(){}}},Bs=Us,zs=Object(b["a"])(Bs,Ls,Fs,!1,null,null,null),Gs=zs.exports,Hs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"actionsServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Approve or Reject report\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Select recepients:\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"flex justify-center q-gutter-md"},[a("q-checkbox",{staticClass:"row",attrs:{label:"Purchaser"},model:{value:e.selected.purchaser,callback:function(t){e.$set(e.selected,"purchaser",t)},expression:"selected.purchaser"}}),a("q-checkbox",{staticClass:"row",attrs:{label:"Factory"},model:{value:e.selected.factory,callback:function(t){e.$set(e.selected,"factory",t)},expression:"selected.factory"}}),a("q-checkbox",{staticClass:"row",attrs:{label:"Logistic"},model:{value:e.selected.logistic,callback:function(t){e.$set(e.selected,"logistic",t)},expression:"selected.logistic"}})],1),a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Remarks(if reject)\n          ")]),a("q-input",{attrs:{filled:"",type:"textarea",rules:[e.textRules]},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),a("q-separator",{staticClass:"q-my-md"}),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",{staticClass:"q-mx-sm"},[a("q-btn",{attrs:{label:"Reject",color:"negative",disable:!e.isReportStateDetailer},on:{click:e.onClickReject}}),e.isReportStateDetailer?e._e():a("q-tooltip",[e._v("\n            Report is not in Detailer state\n          ")])],1),a("div",[a("q-btn",{attrs:{label:"Approve",color:"positive",disable:e.isApproveBtnDisabled},on:{click:e.onClickApprove}}),e.isReportStateDetailer?e._e():a("q-tooltip",[e._v("\n            Report is not in Detailer state\n          ")]),e.isReportStateSequenceSelected?e._e():a("q-tooltip",[e._v("\n            Select at least one(1) recipient.\n          ")])],1)],1)],1)])],1)},Qs=[],Js={components:{ModalDialog:v},mixins:[x["a"]],data(){return{report:{},remarks:"",selected:{purchaser:!1,logistic:!1,factory:!1}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{reportStateSequence(){const{purchaser:e,logistic:t,factory:a}=this.selected,s=[];return e&&s.push("Purchaser"),a&&s.push("Factory"),t&&s.push("Logistic"),s},reportState(){const e=this.reportStateSequence[0];return null!==e&&void 0!==e?e:null},isReportStateDetailer(){return"Detailer"===this.report.state},isReportStateSequenceSelected(){return!!this.reportState},isApproveBtnDisabled(){const{isReportStateDetailer:e,isReportStateSequenceSelected:t}=this;return!e||!t}}),watch:{reportState:function(e){console.log("reportState",e)},reportStateSequence:function(e){console.log("reportStateSequence",e)}},methods:{onShowDialog(){var e=this;return i()((function*(){const[t]=e.tableSelection;e.report=t}))()},onClickApprove(){var e=this;return i()((function*(){const{uuid:t}=e.report;try{yield e.$store.dispatch("ServiceReportActions",{uuid:t,data:{state:e.reportState,stateSequence:e.reportStateSequence}}),e.$notify("success","State successfully updated"),e.$refs.dialog.$children[0].hide()}catch(a){e.$notify("error","State failed to be updated")}}))()},onClickReject(){var e=this;return i()((function*(){e.state="Rejected";try{e.$store.dispatch("ServiceReportActions",{uuid:e.tableSelection[0].uuid,data:{state:e.state,remarks:e.remarks}}),e.reset(),e.$notify("success","State successfully updated"),e.$refs.dialog.$children[0].hide()}catch(t){e.$notify("error","State failed to be updated")}}))()},reset(){this.report={},this.remarks="",this.selected={purchaser:!1,logistic:!1,factory:!1}}}},Ys=Js,Ks=Object(b["a"])(Ys,Hs,Qs,!1,null,null,null),Vs=Ks.exports,Ws=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"createServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Create Service Report\n        ")])]),a("q-card-section",[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"text-weight-bold text-center text-uppercase text-grey-7"},[a("p",{staticClass:"q-mt-md q-mb-none"},[e._v("\n              Report Information\n            ")])]),a("div",[a("q-toggle",{attrs:{label:"Manual Input"},model:{value:e.isManualInput,callback:function(t){e.isManualInput=t},expression:"isManualInput"}})],1)]),a("q-separator",{staticClass:"q-mb-lg q-mt-none"}),a("div",{staticClass:"q-gutter-sm justify"},[a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.leadOptions,label:"Selected Customer",outlined:"","use-input":"","input-debounce":"0","emit-value":"","map-options":""},on:{filter:e.leadsFilterFn},model:{value:e.form.leadId,callback:function(t){e.$set(e.form,"leadId",t)},expression:"form.leadId"}})],1),a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.jobNumberOptions,label:"Selected Job Number",outlined:"","use-input":"","input-debounce":"0"},on:{filter:e.jobNumberFilterFn},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}})],1),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Name",outlined:"","lazy-rules":""},model:{value:e.lead.name,callback:function(t){e.$set(e.lead,"name",t)},expression:"lead.name"}}):e._e(),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Job Number",outlined:"","lazy-rules":""},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}}):e._e(),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Address",outlined:"","lazy-rules":""},model:{value:e.lead.siteAddress,callback:function(t){e.$set(e.lead,"siteAddress",t)},expression:"lead.siteAddress"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{value:e.formatPhoneNo(e.lead.phone),label:"Customer Contact",outlined:"","lazy-rules":"",mask:"### - ########","unmasked-value":""},model:{value:e.lead.phone,callback:function(t){e.$set(e.lead,"phone",t)},expression:"lead.phone"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Installer",outlined:"","lazy-rules":""},model:{value:e.form.installer,callback:function(t){e.$set(e.form,"installer",t)},expression:"form.installer"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{value:e.convertedDate(e.form.installedDate),mask:"##/##/####",outlined:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{subtitle:"Installed",title:"Date"},model:{value:e.form.installedDate,callback:function(t){e.$set(e.form,"installedDate",t)},expression:"form.installedDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}])}),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-uppercase text-grey-7"},[e._v("\n            Remarks\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-input",{attrs:{filled:"",type:"textarea"},model:{value:e.form.remarksSalesConsultant,callback:function(t){e.$set(e.form,"remarksSalesConsultant",t)},expression:"form.remarksSalesConsultant"}}),a("q-separator",{staticClass:"q-mb-md"}),a("div",{staticClass:"flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"Continue"},on:{click:e.onClickContinue}})],1)],1)],1)],1)])],1)},Xs=[],Zs={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isManualInput:!1,form:{installedDate:"",installer:"",jobNumber:"",leadId:"",remarksSalesConsultant:""},lead:{name:"",siteAddress:"",phone:""},jobNumbersByLeadId:{},leads:[],leadOptions:[],jobNumberOptions:[]}},computed:n()({},Object(C["b"])(["tableSelection","roles","userId"])),watch:{isManualInput(e){e?(this.form.leadId=void 0,this.form.jobNumber="",this.lead={name:"",siteAddress:"",phone:""}):(this.lead.name=void 0,this.lead.siteAddress="",this.lead.phone="")},"form.leadId"(e){var t=this;return i()((function*(){if(!e)return;t.jobNumberOptions=[],t.form.jobNumber="";const{data:a}=yield t.$repository.lead.getById(e);t.jobNumberOptions=t.jobNumbersByLeadId[e]||[],t.jobNumberOptions.length&&(t.form.jobNumber=t.jobNumberOptions[0]),console.log(t.jobNumberOptions,t.jobNumbersByLeadId),t.lead=a}))()}},methods:{onShowDialog(){var e=this;return i()((function*(){yield e.getLeadAndJobNumberOptions()}))()},getLeadAndJobNumberOptions(){var e=this;return i()((function*(){const[t]=e.roles,a="salesconsultant"===t,s={where:{userId:e.userId}},o=a?s:void 0;let{data:r}=yield e.$repository.fco.listing({where:{state:"FCO",status:"Production"},include:[{relation:"designs"},{relation:"lead",scope:o}]});r=r.filter(e=>e.lead);for(const i of r){const{lead:t}=i;if(e.leadExistsInOption(t.uuid)||e.leadOptions.push({label:t.name,value:t.uuid}),i.designs)for(const a of i.designs)e.jobNumbersByLeadId[t.uuid]||(e.jobNumbersByLeadId[t.uuid]=[]),e.jobNumbersByLeadId[t.uuid].push(`${i.jobId} ${a.jobPart}`)}e.leads=e.leadOptions,e.leadOptions.length&&(e.form.leadId=e.leadOptions[0].value)}))()},onClickContinue(){var e=this;return i()((function*(){try{const t={leadManualInput:e.isManualInput?e.lead:void 0,leadId:e.isManualInput?void 0:e.form.leadId,jobNumber:e.form.jobNumber,installer:e.form.installer,installedDate:new Date(e.form.installedDate),remarksSalesConsultant:e.form.remarksSalesConsultant,state:"New",type:"ServiceReport"};yield e.$store.dispatch("CreateSR",t),yield e.$store.dispatch("GetAllSR",{}),e.$notify("success","Successfully created service report.")}catch(t){e.$notify("error","Failed creating service report.")}}))()},formatPhoneNo(e){return Object(E["b"])(e)},leadExistsInOption(e){return this.leadOptions.filter(t=>t.value===e).length>0},jobNumberFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId].filter(e=>e.toLowerCase().indexOf(t)>-1)}:()=>{this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId]})},leadsFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.leadOptions=this.leads.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.leadOptions=this.leads})},convertedDate(e){let t=e.split("/");return t=`${t[2]}/${t[1]}/${t[0]}`,t},reset(){this.form={installedDate:"",installer:"",jobNumber:"",leadId:""},this.isManualInput=!1,this.lead={siteAddress:"",phone:""},this.jobNumbersByLeadId={},this.leadOptions=[],this.jobNumberOptions=[]}}},eo=Zs,to=Object(b["a"])(eo,Ws,Xs,!1,null,null,null),ao=to.exports,so=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"createReportMaintenance"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"1800px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Report Maintainence\n        ")])]),a("q-card-section",[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"text-weight-bold text-center text-uppercase text-grey-7"},[a("p",{staticClass:"q-mt-md q-mb-none"},[e._v("\n              Report Information\n            ")])]),a("div",[a("q-toggle",{attrs:{label:"Manual Input"},model:{value:e.isManualInput,callback:function(t){e.isManualInput=t},expression:"isManualInput"}})],1)]),a("q-separator",{staticClass:"q-mb-lg q-mt-none"}),a("div",{staticClass:"q-gutter-sm justify"},[a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.leadOptions,disable:!e.leadOptions.length,label:"Selected Customer",outlined:"","use-input":"","input-debounce":"0","emit-value":"","map-options":""},on:{filter:e.leadsFilterFn},model:{value:e.form.leadId,callback:function(t){e.$set(e.form,"leadId",t)},expression:"form.leadId"}})],1),a("div",[e.isManualInput?e._e():a("q-select",{staticClass:"col",attrs:{options:e.jobNumberOptions,disable:!e.jobNumberOptions.length,label:"Selected Job Number",outlined:"","use-input":"","input-debounce":"0"},on:{filter:e.jobNumberFilterFn},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}})],1),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Name",outlined:"","lazy-rules":""},model:{value:e.lead.name,callback:function(t){e.$set(e.lead,"name",t)},expression:"lead.name"}}):e._e(),e.isManualInput?a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Job Number",outlined:"","lazy-rules":""},model:{value:e.form.jobNumber,callback:function(t){e.$set(e.form,"jobNumber",t)},expression:"form.jobNumber"}}):e._e(),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Address",outlined:"","lazy-rules":""},model:{value:e.lead.siteAddress,callback:function(t){e.$set(e.lead,"siteAddress",t)},expression:"lead.siteAddress"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Customer Contact",outlined:"","lazy-rules":"",mask:"### - ########","unmasked-value":""},model:{value:e.lead.phone,callback:function(t){e.$set(e.lead,"phone",t)},expression:"lead.phone"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{label:"Installer",outlined:"","lazy-rules":""},model:{value:e.form.installer,callback:function(t){e.$set(e.form,"installer",t)},expression:"form.installer"}}),a("q-input",{staticClass:"col q-pa-none",attrs:{rules:["date"],label:"Installed Date",mask:"date",outlined:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{subtitle:"Installed",title:"Date"},model:{value:e.form.installedDate,callback:function(t){e.$set(e.form,"installedDate",t)},expression:"form.installedDate"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:e.form.installedDate,callback:function(t){e.$set(e.form,"installedDate",t)},expression:"form.installedDate"}}),a("div",{staticClass:"q-mt-md q-mx-md text-weight-bold text-uppercase text-grey-7"},[e._v("\n            Remarks\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("q-input",{attrs:{filled:"",type:"textarea"},model:{value:e.form.remarksSalesConsultant,callback:function(t){e.$set(e.form,"remarksSalesConsultant",t)},expression:"form.remarksSalesConsultant"}}),a("q-separator",{staticClass:"q-my-md"}),a("div",{staticClass:"flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"Continue"},on:{click:e.onClickContinue}})],1)],1)],1)],1)])],1)},oo=[],ro={components:{ModalDialog:v},mixins:[x["a"]],data(){return{isManualInput:!1,form:{installedDate:"",installer:"",jobNumber:"",leadId:"",remarksSalesConsultant:""},lead:{name:"",siteAddress:"",phone:""},jobNumbersByLeadId:{},leads:[],leadOptions:[],jobNumberOptions:[]}},computed:n()({},Object(C["b"])(["tableSelection","roles","userId"])),watch:{isManualInput(e){e?(this.form.leadId=void 0,this.form.jobNumber="",this.lead={name:"",siteAddress:"",phone:""}):(this.lead.name=void 0,this.lead.siteAddress="",this.lead.phone="")},"form.leadId"(e){var t=this;return i()((function*(){if(!e)return;t.jobNumberOptions=[],t.form.jobNumber="";const{data:a}=yield t.$repository.lead.getById(e);t.jobNumberOptions=t.jobNumbersByLeadId[e]||[],t.jobNumberOptions.length&&(t.form.jobNumber=t.jobNumberOptions[0]),t.lead=a}))()}},methods:{onShowDialog(){var e=this;return i()((function*(){yield e.getLeadAndJobNumberOptions()}))()},getLeadAndJobNumberOptions(){var e=this;return i()((function*(){const[t]=e.roles,a="salesconsultant"===t,s={where:{userId:e.userId}},o=a?s:void 0;let{data:r}=yield e.$repository.fco.listing({where:{state:"FCO",status:"Production"},include:[{relation:"designs"},{relation:"lead",scope:o}]});r=r.filter(e=>e.lead);for(const i of r){const{lead:t}=i;if(e.leadExistsInOption(t.uuid)||e.leadOptions.push({label:t.name,value:t.uuid}),i.designs)for(const a of i.designs)e.jobNumbersByLeadId[t.uuid]||(e.jobNumbersByLeadId[t.uuid]=[]),e.jobNumbersByLeadId[t.uuid].push(`${i.jobId} ${a.jobPart}`)}e.leads=e.leadOptions,e.leadOptions.length&&(e.form.leadId=e.leadOptions[0].value)}))()},onClickContinue(){var e=this;return i()((function*(){try{const t={leadManualInput:e.isManualInput?e.lead:void 0,leadId:e.isManualInput?void 0:e.form.leadId,jobNumber:e.form.jobNumber,installer:e.form.installer,installedDate:new Date(e.form.installedDate),remarksSalesConsultant:e.form.remarksSalesConsultant,state:"New",type:"MaintenanceReport"};yield e.$store.dispatch("GetAllSR",{}),yield e.$store.dispatch("CreateMR",t),e.$notify("success","Successfully created report maintainence.")}catch(t){e.$notify("error","Failed creating report maintainence.")}}))()},formatPhoneNo(e){return Object(E["b"])(e)},leadExistsInOption(e){return this.leadOptions.filter(t=>t.value===e).length>0},jobNumberFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId].filter(e=>e.toLowerCase().indexOf(t)>-1)}:()=>{this.jobNumberOptions=this.jobNumbersByLeadId[this.form.leadId]})},leadsFilterFn(e,t){t(""!==e?()=>{const t=e.toLowerCase();this.leadOptions=this.leads.filter(e=>e.label.toLowerCase().indexOf(t)>-1)}:()=>{this.leadOptions=this.leads})},reset(){this.form={installedDate:"",installer:"",jobNumber:"",leadId:""},this.isManualInput=!1,this.lead={siteAddress:"",phone:""},this.jobNumbersByLeadId={},this.leadOptions=[],this.jobNumberOptions=[]}}},io=ro,lo=Object(b["a"])(io,so,oo,!1,null,null,null),no=lo.exports,co=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"viewMaintenanceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Report Maintainence\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-8"},[e._v("\n            Details\n          ")])])]),a("q-separator",{staticClass:"q-my-md"}),a("q-card-actions",{attrs:{align:"right"}},["detailer"===e.roles[0]||"sysadmin"===e.roles[0]?a("q-btn",{attrs:{color:"secondary",label:"Edit Report"},on:{click:e.onClickEditReport}}):e._e(),a("q-btn",{attrs:{color:"primary",label:"View Report"},on:{click:e.generatePdf}})],1)],1)])],1)},mo=[],uo={components:{ModalDialog:v},data(){return{selection:{},form:{},items:[]}},computed:n()({},Object(C["b"])(["tableSelection","roles"])),methods:{onShowDialog(){var e=this;return i()((function*(){e.selection=e.$store.getters.tableSelection[0],e.form=n()({},e.selection),console.log("aa",e.form)}))()},onClickEditReport(){const{uuid:e}=this.selection,t=this.$router.resolve({path:"report-maintainence/"+e});window.open(t.href,"_blank")},generatePdf(){var e=this;return i()((function*(){const{formatDate:t}=G["e"];void 0===na["vfs"]&&(na["vfs"]=ca["pdfMake"].vfs);const{data:a}=yield e.$repository.lead.getById(e.form.leadId),{data:s}=yield e.$repository.user.getById(e.form.userId),{data:o}=yield e.$repository.branch.getById(s.branchId);console.log("bb",a),console.log("cc",s),console.log("dd",o);var r=[];if(e.roles&&"salesconsultant"===e.roles[0]||"purchaser"===e.roles[0]||"detailer"===e.roles[0]||"logistic"===e.roles[0]||"sysadmin"===e.roles[0]){r.push(["QTY","UOM","MODEL","DESCRIPTION","REMARKS","WIDTH","HEIGHT","DEPTH","MATERIAL","COLOUR","PROFILE","U/PRICE","AMOUNT"]);for(const t of e.form.items)r.push([t.quantity,t.item.uom,t.item.itemcode,t.item.name,t.remarks,t.width,t.height,t.depth,t.material.material,t.material.colour,t.material.profile,t.material.price,(t.material.price*t.quantity).toFixed(2)])}else if("factory"===e.roles[0]||"sysadmin"===e.roles[0]){r.push(["QTY","UOM","MODEL","DESCRIPTION","REMARKS","WIDTH","HEIGHT","DEPTH","MATERIAL","COLOUR","PROFILE"]);for(const t of e.form.items)r.push([t.quantity,t.item.uom,t.item.itemcode,t.item.name,t.remarksFactory,t.width,t.height,t.depth,t.material.material,t.material.colour,t.material.profile])}else if("hqAccountant"===e.roles[0]||"sysadmin"===e.roles[0]){r.push(["QTY","UOM","MODEL","DESCRIPTION","REMARKS","WIDTH","HEIGHT","DEPTH","MATERIAL","COLOUR","PROFILE","U/PRICE","AMOUNT","DEALER PRICE","SM PRICE"]);for(const t of e.form.items)r.push([t.quantity,t.item.uom,t.item.itemcode,t.item.name,t.remarks,t.width,t.height,t.depth,t.material.material,t.material.colour,t.material.profile,t.material.price,(t.material.price*t.quantity).toFixed(2),(t.material.price*t.item.dealerprice).toFixed(2),(t.material.price*t.item.SMPrice).toFixed(2)])}var i={content:[{columns:[[{text:"Signature Kitchen SDN BHD",style:"address"},{text:"Lot 24, Jalan Teknologi, Taman Sains Selangor 1,",style:"address"},{text:"Kota Damansara PJU 5, 47810 Petaling Jaya, Selangor",style:"address_sub"}]]},{columns:[[{text:"Customer Name :   "+a.name,style:"sub_header"},{text:"Contact No          :   "+a.phone,style:"sub_header"},{text:"Job No                 :   "+e.form.jobNumber,style:"sub_header"}],[{text:"Date :                  "+t(s.updatedAt,"DD MMM YYYY"),style:"sc_header"},{text:"Branch :                               "+o.code,style:"sc_header"},{text:"SC Name :                                     "+s.name,style:"sc_header"},{text:"SC Tel No :                 "+s.mobile,style:"sc_header"},{text:"Installer :                      "+e.form.installer,style:"sc_header"},{text:"Date Installed :                 "+t(e.form.installedDate,"DD MMM YYYY"),style:"sc_header"}]]},{style:"tableExample",table:{body:r}}],styles:{header:{bold:!0,fontSize:15,alignment:"right"},address:{bold:!0,fontSize:7,alignment:"left"},address_sub:{bold:!0,fontSize:7,alignment:"left",margin:[0,0,5,10]},sub_header:{fontSize:10,alignment:"left"},sc_header:{fontSize:10,alignment:"right"},tableExample:{alignment:"center",fontSize:7,margin:[0,5,0,0]}}};na["createPdf"](i).open()}))()},reset(){}}},po=uo,ho=Object(b["a"])(po,co,mo,!1,null,null,null),fo=ho.exports,go=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"submitToDetailerServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n        Submit Report to Detailer\n      ")])]),a("q-card-section",{staticClass:"q-mx-md q-my-md"},[a("div",[e._v("\n        This action will notify Detailer(s) regarding the report.\n      ")]),a("q-separator",{staticClass:"q-my-md"})],1),a("q-card-section",[a("div",{staticClass:"q-gutter-sm flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Submit",color:"primary",disable:e.isSubmitBtnDisabled},on:{click:e.onSubmit}}),e.isSubmitBtnDisabled?a("q-tooltip",[e._v("\n            Report is not in New state.\n          ")]):e._e()],1)],1)])],1)],1)},bo=[],yo={components:{ModalDialog:v},data(){return{report:{uuid:"",state:""}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isSubmitBtnDisabled(){return"New"!==this.report.state&&"Rejected"!==this.report.state}}),watch:{},methods:{onShowDialog(){const[e]=this.$store.getters.tableSelection;this.report=e},onSubmit(){var e=this;return i()((function*(){try{yield e.$repository.serviceReport.updateById(e.report.uuid,{state:"Detailer"}),"MaintenanceReport"===e.report.type?yield e.$store.dispatch("GetAllMR",{}):yield e.$store.dispatch("GetAllSR",{}),e.$refs.dialog.$children[0].hide(),e.$notify("success","Successfully submitted to Detailer(s).")}catch(t){e.$notify("error","Could not submit report to detailer. Please try again.")}}))()},reset(){this.reportId=""}}},vo=yo,Co=Object(b["a"])(vo,go,bo,!1,null,null,null),xo=Co.exports,qo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"completeServiceReport"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n        Complete Task\n      ")])]),a("q-card-section",{staticClass:"q-ma-lg q-py-none"},[a("div",{staticClass:"q-mb-lg"},[a("p",{staticClass:"text-weight-medium q-ma-none"},[e._v("\n          This action will:\n        ")]),a("ul",[a("li",[e._v("notify the next recipient if there's any, or")]),a("li",[e._v("set the report state to Closed.")])])]),e.isCurrentStateEq("")||e.isCurrentStateEq("Closed")?e._e():a("div",[a("p",[a("span",{staticClass:"text-weight-medium"},[e._v("Next state")]),e._v(": "+e._s(e.nextState)+"\n        ")])])]),a("q-separator",{staticClass:"q-my-md"}),a("q-card-section",[a("div",{staticClass:"q-gutter-sm flex justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Complete",color:"primary",disable:e.isCompleteBtnDisabled},on:{click:e.onClickComplete}}),e.isCurrentStateEq(e.userRoleCapitalized)?e._e():a("q-tooltip",[e._v("\n            User is not "+e._s(e.report.state)+".\n          ")]),e.isCurrentStateEq("Closed")?a("q-tooltip",[e._v("\n            This report is closed.\n          ")]):e._e()],1)],1)])],1)],1)},wo=[],ko={components:{ModalDialog:v},data(){return{report:{uuid:"",state:""}}},computed:n()(n()({},Object(C["b"])(["tableSelection","roles"])),{},{userRoleCapitalized(){const e=this.roles[0];return e[0].toUpperCase()+e.substring(1)},nextState(){const{stateSequence:e,state:t}=this.report,a=e.findIndex(e=>e===t),s=a+1;return s===e.length?"Closed":e[s]},isCompleteBtnDisabled(){return"sysadmin"!==this.roles[0]&&(!this.isCurrentStateEq(this.userRoleCapitalized)||this.isCurrentStateEq("Closed"))}}),watch:{},methods:{isCurrentStateEq(e){return this.report.state===e},onShowDialog(){const[e]=this.$store.getters.tableSelection;this.report=e,console.log("nextState",this.nextState)},onClickComplete(){var e=this;return i()((function*(){try{yield e.$repository.serviceReport.updateById(e.report.uuid,{state:e.nextState}),"MaintenanceReport"===e.report.type?yield e.$store.dispatch("GetAllMR",{}):yield e.$store.dispatch("GetAllSR",{}),e.$refs.dialog.$children[0].hide(),e.$notify("success","Successfully completed report.")}catch(t){e.$notify("error","Could not complete report. Please try again.")}}))()},reset(){this.reportId=""}}},_o=ko,So=Object(b["a"])(_o,qo,wo,!1,null,null,null),Do=So.exports,Io=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"campaignDefault"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"2000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Set Campaign to default\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-center text-grey-8"},[e._v("\n            Set Campaign to default\n          ")]),a("div",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{label:"Yes",color:"primary"},on:{click:e.onSetLeadToLost}})],1)])])],1)])],1)},$o=[],Oo={components:{ModalDialog:v},data(){return{selectedLeadId:"",form:{}}},computed:n()({},Object(C["b"])(["tableSelection"])),watch:{},methods:{onShowDialog(){this.form=this.$store.getters.tableSelection[0],this.selectedLeadId=this.form.uuid},onSetLeadToLost(){var e=this;return i()((function*(){try{yield e.$store.dispatch("setToDefaultExhibition",{uuid:e.selectedLeadId,status:"default"});const t=yield e.$store.dispatch("GetAllExhibitions");t.forEach(function(){var t=i()((function*(t){t.uuid!==e.selectedLeadId&&(yield e.$store.dispatch("setToDefaultExhibition",{uuid:t.uuid,status:""}))}));return function(e){return t.apply(this,arguments)}}()),e.$notify("success","Successfully set campaign to default"),e.$refs.dialog.$children[0].hide()}catch(t){console.log(t),e.$notify("error","Error")}}))()},reset(){this.selectedLeadId="",this.form={}}}},To=Oo,Ao=Object(b["a"])(To,Io,$o,!1,null,null,null),Ro=Ao.exports,jo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{ref:"dialog",attrs:{name:"finalConfirmationOrderCompleteTask"},on:{"close-dialog":e.reset,"show-dialog":e.onShowDialog}},[a("q-card",{staticStyle:{width:"18000px"}},[a("div",[a("q-card-section",{staticClass:"bg-grey-10"},[a("div",{staticClass:"text-white text-h6"},[e._v("\n          Complete Task\n        ")])]),a("q-card-section",[a("div",{staticClass:"q-gutter-sm justify"},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n            Set Task as Complete\n          ")]),a("q-separator",{staticClass:"q-my-md"}),a("p",[e._v("Send order to production and get automatically generated job number?")])],1)]),a("q-card-actions",{staticClass:"bg-white text-dark",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel"}}),a("div",[a("q-btn",{attrs:{label:"Submit",color:"positive",disable:!e.isOrderStatusDetailer||!e.isDetailerAttachmentExist},on:{click:e.onClickSubmit}}),e.isOrderStatusDetailer?e._e():a("q-tooltip",[e._v("\n            Order state is not 'Detailer'\n          ")]),e.isDetailerAttachmentExist?e._e():a("q-tooltip",[e._v("\n            No attachment uploaded by Detailer.\n          ")]),a("div")],1)],1)],1)])],1)},No=[],Mo={components:{ModalDialog:v},mixins:[x["a"]],data(){return{remarks:"",form:{}}},computed:n()(n()({},Object(C["b"])(["tableSelection"])),{},{isOrderStatusDetailer(){return this.form&&"Detailer"===this.form.status},isDetailerAttachmentExist(){return this.form&&this.form.paymentAttachments&&this.form.paymentAttachments.some(e=>"Detailer"===e.type)}}),methods:{onShowDialog(){var e=this;return i()((function*(){e.form=n()({},e.tableSelection[0]),console.log("FCO",e.form)}))()},reset(){this.form={}},onClickSubmit(){var e=this;return i()((function*(){try{yield e.$store.dispatch("FinalOrderConfirmationApproveForProduction",{orderId:e.tableSelection[0].uuid}),e.reset(),e.$notify("success","Order successfully sent to production!")}catch(t){console.log(t),e.$notify("error","Order state failed to be updated")}}))()}}},Eo=Mo,Po=Object(b["a"])(Eo,jo,No,!1,null,null,null),Lo=Po.exports,Fo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("modal-dialog",{attrs:{name:"importopitemlist"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h5"},[e._v("\n        Import Optional Item List\n      ")])]),a("q-card-section",{staticClass:"q-pt-none"},[e._v("\n      Upload a .xslx file which contain optional item data\n    ")]),a("q-card-section",[a("q-uploader",{ref:"opitemlistUploader",staticClass:"justify-center",attrs:{label:"Upload file",factory:e.factoryFn,"full-width":"",accept:".xlsx",square:"",flat:"",bordered:""},on:{added:e.fileAdded,rejected:e.onRejected}})],1),a("q-card-section",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Cancel"}}),a("q-btn",{attrs:{flat:"",color:"primary",label:"Select"}})],1)],1)],1)},Uo=[],Bo={components:{ModalDialog:v},methods:{onRejected(e){this.$q.notify({type:"negative",message:e.length+" file(s) did not pass validation constraints"})},fileAdded(e){console.log(e)},factoryFn(e){var t=this;return i()((function*(){const a=t.$refs.opitemlistUploader,s=e[0];try{const e=yield t.$repository.opitemlist.upload(s);a.removeFile(s),console.log("Upload op item list res:",e);const{created:o,updated:r}=e.data;t.$notify("success",`Item successfully created: ${o}, updated: ${r}.`)}catch(o){console.log("Failed to upload op item list file:",o)}}))()}}},zo=Bo,Go=Object(b["a"])(zo,Fo,Uo,!1,null,null,null),Ho=Go.exports,Qo={components:{skActionsFinalOrderConfirmation:Ga,skActionsOrderConfirmation:_,skAddBranchDialog:j,skAddDrawingNumberDialog:U,skAddLeadDialog:K,skAddUserDialog:ce,skAssignLeadToDesign:ge,skAssignLeadToScDialog:qe,skAssignLeadsToBranchDialog:Ie,skAssignScope:Ne,skAssignToFco:_a,skAssignUserRole:Ue,skBranchRRDialog:Je,skDeleteDialog:Ze,skDetailedQuotation:rt,skDisqualifiedOLDialog:mt,skDisqualifiedQLDialog:bt,skEditBranchDialog:wt,skEditUserDialog:$t,skImportItemlistDialog:Nt,skImportOnlineLeadsDialog:Ut,skOpenKujialeDialog:Jt,skRequalifyQLDialog:Zt,skSubmitOrderConfirmationToAccount:ra,skSubmitToManager:Ta,skSummaryQuotation:pa,skViewFinalConfirmationOrder:Pa,skViewOrderConfirmation:va,skFinalOrderConfirmationApproveForProduction:Va,skAddExhibition:as,skDeleteExhibition:ns,skDownloadMissingItemsCsv:hs,skPendingVisit:Cs,skSetLeadToLost:Ss,skCancelOrderConfirmation:As,skViewCampaign:Ps,skViewServiceReport:Gs,skActionsServiceReport:Vs,skCreateServiceReport:ao,skCreateReportMaintenance:no,skViewReportMaintenance:fo,skSubmitToDetailerServiceReport:xo,skCompleteServiceReport:Do,skSetDefaultCampaign:Ro,skCompleteTaskFinalOrderConfirmation:Lo,skImportOpItemlistDialog:Ho},data(){return{}}},Jo=Qo,Yo=Object(b["a"])(Jo,c,d,!1,null,null,null),Ko=Yo.exports,Vo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"text-center text-bold full-width"},[e._v("\n  Grand Total: RM "+e._s(e.grandTotal)+"\n")])},Wo=[],Xo={data(){return{}},computed:n()(n()({},Object(C["b"])(["datatabs","activeDataTab"])),{},{grandTotal(){const{data:e}=this.datatabs[this.activeDataTab];return e.length?Object(E["g"])(e[0].calculateGrandTotal.toFixed(2)):0}})},Zo=Xo,er=Object(b["a"])(Zo,Vo,Wo,!1,null,null,null),tr=er.exports,ar=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-menu",{model:{value:e.isMenuOpen,callback:function(t){e.isMenuOpen=t},expression:"isMenuOpen"}},[a("q-card",{staticStyle:{width:"300px"}},[e._l(Object.keys(e.options),(function(t){return a("q-card-section",{key:t},[a("div",{staticClass:"text-weight-bold text-uppercase text-grey-5"},[e._v("\n        "+e._s(t)+"\n      ")]),a("div",{staticClass:"fit row wrap justify-start items-start content-start"},[a("q-option-group",{attrs:{options:e.options[t].options,size:"sm",type:"checkbox"},model:{value:e.filter[e.options[t].field],callback:function(a){e.$set(e.filter,e.options[t].field,a)},expression:"filter[options[category].field]"}})],1)])})),a("q-separator"),a("q-card-actions",[a("q-btn",{attrs:{label:"Clear",size:"sm",color:"grey"},on:{click:e.onClickClearFilter}}),a("q-btn",{attrs:{label:"Set to Default",size:"sm",color:"grey"},on:{click:e.setDefaultFilter}}),a("q-space"),a("q-btn",{attrs:{label:"Filter",size:"sm",color:"primary"},on:{click:e.emitFilter}})],1)],2)],1)},sr=[],or={props:{options:{type:Object,default:()=>({})}},data(){return{isMenuOpen:!1,filter:{}}},computed:{categories:function(){return Object.keys(this.options)}},created(){var e=this;return i()((function*(){console.log("TableSelectionFilter::created"),e.filter={},e.setDefaultFilter(),e.options&&e.emitFilter()}))()},methods:{setDefaultFilter(){console.log("TableSelectionFilter::category",this.categories.join(", "));for(const e of this.categories){let t=this.options[e].options.filter(e=>e.default);t.length&&(t=t.map(e=>e.value)),this.$set(this.filter,this.options[e].field,t)}console.log("TableSelectionFilter::defaults",JSON.stringify(this.filter))},onClickClearFilter(){for(const e of this.categories)this.$set(this.filter,this.options[e].field,[])},emitFilter(){this.filter.fromSelection=!0,this.$emit("filter",this.filter)}}},rr=or,ir=Object(b["a"])(rr,ar,sr,!1,null,null,null),lr=ir.exports,nr=a("2b0e"),cr=a("4360");const{getters:dr}=cr["a"],mr=dr.roles,ur=nr["a"].prototype.$repository,pr=()=>({Hidden:{field:"isHidden",options:[{label:"Hidden",value:!1},{label:"Not Hidden",value:!0,default:!0}]}}),hr=()=>({Type:{field:"displayType",options:[{label:"Home Branch",value:"Home Branch"},{label:"Dealer Branch",value:"Dealer Branch"}]}}),fr=function(){var e=i()((function*(){const e=(yield ur.role.listing()).data.map(e=>({label:e.displayName,value:e.displayName}));return{Role:{field:"role",options:e}}}));return function(){return e.apply(this,arguments)}}(),gr=function(){var e=i()((function*(){const e=(yield ur.branch.listing()).data.map(e=>({label:e.name,value:e.name}));return{Branch:{field:"branch_name",options:e}}}));return function(){return e.apply(this,arguments)}}(),br=function(){var e=i()((function*(){if(Object(E["c"])(mr,["branchManager","salesconsultant"]))return;const e=nr["a"].prototype.$repository,t=(yield e.branch.listing()).data.map(e=>({label:e.code,value:e.code}));return{"Branch Code":{field:"getBranchCode",options:t}}}));return function(){return e.apply(this,arguments)}}(),yr=()=>{const e=[{label:"New",value:"New",default:!0},{label:"Assigned",value:"Assigned",default:!0},{label:"Follow Up",value:"Pending Visit",default:!0},{label:"Disqualified",value:"disqualified"}];return{status:{field:"status",options:e}}},vr=()=>{const e=[{label:"New",value:"raw",default:!0},{label:"Disqualified",value:"disqualified"}];return{status:{field:"status",options:e}}},Cr=()=>{const e=[{label:"New",value:"New",default:!0},{label:"Upload Payment / Document",value:"Upload Payment / Document",default:!0},{label:"Pending Approval",value:"Pending Approval",default:!0},{label:"Cancelled",value:"Cancelled",default:!0},{label:"Acknowledged",value:"Acknowledged",default:!0},{label:"Rejected",value:"Rejected",default:!0},{label:"FCO Submission",value:"FCO Submission"}];return{status:{field:"displayStatusForOC",options:e}}},xr=()=>{const e=[{label:"New",value:"New"},{label:"Upload Payment / Document",value:"Upload Payment / Document"},{label:"Pending BM Approval",value:"Pending BM Approval"},{label:"Rejected - BM level 1",value:"Rejected - BM level 1"},{label:"Pending HQAC approval",value:"Pending HQAC approval"},{label:"Rejected - HQAC level 2",value:"Rejected - HQAC level 2"},{label:"Pending Detailer",value:"Pending Detailer"},{label:"Production",value:"Production"}];return{status:{field:"displayStatusForFCO",options:e}}},qr=()=>{const e=[{label:"Proposal In Progress",value:"Proposal In Progress",default:!0},{label:"Pending Decision",value:"Pending Decision",default:!0},{label:"Won",value:"Won"},{label:"Lost",value:"Lost"}];return{status:{field:"status",options:e}}},wr=()=>{const e=[{label:"New",value:"New"},{label:"Detailer",value:"Detailer"},{label:"Purchaser",value:"Purchaser"},{label:"Logistic",value:"Logistic"},{label:"Production",value:"Production"},{label:"Rejected",value:"Rejected"},{label:"Closed",value:"Closed"}];return{state:{field:"state",options:e}}},kr=function(){var e=i()((function*(){return[{name:"usermanagement",filter:n()(n()({},yield gr()),yield fr())},{name:"branch",filter:n()({},hr())},{name:"item",filter:{}},{name:"campaign",filter:n()({},pr())},{name:"onlineleads",filter:n()({},vr())},{name:"qualifiedleads",filter:n()(n()({},yr()),yield br())},{name:"designproposal",filter:n()({},qr())},{name:"orderconfirmation",filter:n()({},Cr())},{name:"finalconfirmation",filter:n()({},xr())},{name:"servicereport",filter:n()({},wr())},{name:"maintenancereport",filter:n()({},wr())}]}));return function(){return e.apply(this,arguments)}}();var _r={components:{DialogPlugins:Ko,SkFooterOc:tr,TableSelectionFilter:lr},data(){return{isTableFullscreen:!1,pagination:{rowsPerPage:0},tableData:[],selectionFilterOptions:null,filter:""}},computed:n()(n()(n()({},Object(C["b"])(["datatabs","activeDataTab","activeMenu"])),Object(C["c"])({activeMenu:e=>e.app.activeMenu,tableSelection:e=>e.app.tableSelection})),{},{selectionFilter:{set(e){this.filter=n()({},e)},get(e){return"string"===(this.filter,!1)?this.filter:{}}},textFilter:{set(e){this.filter=e},get(){return"string"===typeof this.filter?this.filter:""}},currentTab:{set(e){const t=this.datatabs.findIndex(t=>t.name===e);t>=0&&this.$store.dispatch("SetActiveDataTab",t)},get(){const e=this.datatabs[this.activeDataTab];return e?e.name:""}},selection:{set(e){this.$store.dispatch("OnTableSelection",e)},get(){return this.tableSelection}},computedTableHeight:function(){return this.isTableFullscreen?"300vh":"1000px"}}),watch:{activeMenu:function(){var e=i()((function*(){this.selectionFilterOptions=null,yield this.setSelectionFilterOptions(),this.filter={}}));return function(){return e.apply(this,arguments)}}()},created(){var e=this;return i()((function*(){yield e.setSelectionFilterOptions()}))()},methods:{filterTableData(e){const t=this.datatabs[this.activeDataTab].columns.map(e=>e.field);if(console.log(t),"string"===typeof this.filter)return e.filter(e=>this.filterTableDataText(e,t));if(!this.filter.fromSelection)return e;const a=[];for(const s of Object.keys(this.filter))a.push(!this.filter[s].length);return a.every(e=>e)?e:e.filter(e=>this.filterTableDataSelection(e,t))},filterTableDataSelection(e,t){const a=[];for(const s of Object.keys(this.filter))"fromSelection"!==s&&(this.filter[s].length?a.push(this.filter[s].includes(e[s])):a.push(!0));return a.every(e=>!!e)},filterTableDataText(e,t){const a=this.filter.toLowerCase();for(const s of t)if("function"!==typeof s){if("string"===typeof e[s]&&null!==e[s]&&-1!==e[s].toLowerCase().indexOf(a))return!0}else{const t=s(e);if(!t)continue;if(-1!==t.toLowerCase().indexOf(a))return!0}},setSelectionFilterOptions(){var e=this;return i()((function*(){let t=yield kr();t=t.find(t=>t.name===e.activeMenu).filter,e.selectionFilterOptions=n()({},t)}))()},onSelectionFilter(e){console.log("Main::onSelectionFilter",JSON.stringify(e)),this.selectionFilter=e},onClickCloseDataTab(e){this.$store.dispatch("CloseDataTab",e)}}},Sr=_r,Dr=(a("1481"),Object(b["a"])(Sr,s,o,!1,null,null,null));t["default"]=Dr.exports}}]);