(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"007d":function(t,e,s){"use strict";var i=s("ed08");const a={data(){return{textRules:t=>!!t.toString()&&t.toString().length,emailRules:t=>!t||Object(i["d"])(t),phoneNoRules:t=>!!t&&Object(i["e"])(t),floatRules:t=>!Number.isNaN(parseFloat(t))}}};e["a"]=a},"36dc":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-select",{staticClass:"q-pb-none q-ml-sm",attrs:{options:t.filteredOptions,label:t.label,outlined:"",dense:"","emit-value":"","use-input":"","input-debounce":"0","map-options":"","stack-label":"",clearable:""},on:{filter:t.filterFn,input:t.onInput},scopedSlots:t._u([t.m_val?{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"cancel"},on:{click:function(e){e.stopPropagation(),t.m_val=null}}})]},proxy:!0}:null,{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-italic text-grey"},[t._v("\n        No options available\n      ")])],1)]},proxy:!0}],null,!0),model:{value:t.m_val,callback:function(e){t.m_val=e},expression:"m_val"}})},a=[],o=(s("c975"),s("ddb0"),{props:{options:{type:Array,default:()=>[],required:!0},value:{type:String,default:"",required:!0},label:{type:String,default:"",required:!0}},data(){return{filteredOptions:[],m_val:""}},created(){this.filteredOptions=[...this.options]},methods:{filterFn(t,e){""!==t&&this.options.length?e(()=>{const e=t.toLowerCase();this.options[0].label?this.filteredOptions=this.options.filter(t=>t.label.toLowerCase().indexOf(e)>-1):this.filteredOptions=this.options.filter(t=>t.toLowerCase().indexOf(e)>-1)}):e(()=>{this.filteredOptions=this.options})},onInput(t){this.$emit("input",t)}}}),l=o,n=s("2877"),r=Object(n["a"])(l,i,a,!1,null,null,null);e["a"]=r.exports},c7bb:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-layout",{staticClass:" rounded-borders",staticStyle:{height:"100%"},attrs:{view:"lHh lpr lFf"}},["ServiceReport"===t.type?s("div",{staticClass:"text-h6 q-mt-md"},[t._v("\n      Service Order Item List\n    ")]):t._e(),"MaintenanceReport"===t.type?s("div",{staticClass:"text-h6 q-mt-md"},[t._v("\n      Report Maintenance Item List\n    ")]):t._e(),s("q-card",{staticClass:"q-mt-md"},[s("q-card-section",[s("div",{staticClass:"col-4 q-mb-md text-weight-bold text-center text-h5"},[t._v("\n          Items\n        ")]),s("div",{staticClass:"row full-width q-mt-sm"},[s("div",{staticClass:"col-1"},[s("q-input",{staticClass:"q-pb-none",attrs:{dense:"",outlined:"",label:"Qty",rules:[t.textRules]},model:{value:t.inserting.quantity,callback:function(e){t.$set(t.inserting,"quantity",e)},expression:"inserting.quantity"}})],1),s("div",{staticClass:"col"},[s("select-with-filter",{attrs:{options:t.options.item,label:"Items"},model:{value:t.selected.item,callback:function(e){t.$set(t.selected,"item",e)},expression:"selected.item"}})],1)]),s("div",{staticClass:"row full-width"},[s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-mt-sm",attrs:{outlined:"",dense:"",label:"Width",rules:[t.textRules]},model:{value:t.inserting.width,callback:function(e){t.$set(t.inserting,"width",e)},expression:"inserting.width"}})],1),s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{outlined:"",dense:"",label:"Height",rules:[t.textRules]},model:{value:t.inserting.height,callback:function(e){t.$set(t.inserting,"height",e)},expression:"inserting.height"}})],1),s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{outlined:"",dense:"",label:"Depth",rules:[t.textRules]},model:{value:t.inserting.depth,callback:function(e){t.$set(t.inserting,"depth",e)},expression:"inserting.depth"}})],1),s("div",{staticClass:"col-2"},[s("select-with-filter",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{options:t.options.materials,label:t.materialLabel},model:{value:t.inserting.material,callback:function(e){t.$set(t.inserting,"material",e)},expression:"inserting.material"}})],1),s("div",{staticClass:"col-2"},[s("select-with-filter",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{options:t.options.colours[t.inserting.material]||[],label:t.colourLabel},model:{value:t.inserting.colour,callback:function(e){t.$set(t.inserting,"colour",e)},expression:"inserting.colour"}})],1),s("div",{staticClass:"col-2"},[s("select-with-filter",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{options:t.inserting.material.length&&t.inserting.colour.length?t.options.profiles[t.inserting.material][t.inserting.colour]:[],label:t.profileLabel},model:{value:t.inserting.profile,callback:function(e){t.$set(t.inserting,"profile",e)},expression:"inserting.profile"}})],1)]),"ServiceReport"===t.type?s("div",{staticClass:"row full-width q-mt-sm"},[s("div",{staticClass:"col-3"},[s("select-with-filter",{staticClass:"q-pb-none",attrs:{options:t.options.rootCause,label:"Root Cause"},model:{value:t.selected.rootCause,callback:function(e){t.$set(t.selected,"rootCause",e)},expression:"selected.rootCause"}})],1),s("div",{staticClass:"col-3"},[s("select-with-filter",{staticClass:"q-pb-none q-ml-sm",attrs:{options:t.options.byReason[t.selected.rootCause],label:"By Reason"},model:{value:t.selected.reason,callback:function(e){t.$set(t.selected,"reason",e)},expression:"selected.reason"}})],1),s("div",{staticClass:"col-3"},[s("select-with-filter",{staticClass:"q-pb-none q-ml-sm",attrs:{options:t.options.byParty[t.selected.rootCause],label:"By Party"},model:{value:t.selected.party,callback:function(e){t.$set(t.selected,"party",e)},expression:"selected.party"}})],1),s("div",{staticClass:"col-3"},[s("select-with-filter",{staticClass:"q-pb-none q-ml-sm",attrs:{options:t.options.subReason[t.selected.rootCause],label:"Sub Reason"},model:{value:t.selected.subReason,callback:function(e){t.$set(t.selected,"subReason",e)},expression:"selected.subReason"}})],1)]):t._e(),s("div",{staticClass:"row full-width justify-end q-my-md"},[s("q-btn",{staticClass:"q-px-lg q-ml-md",attrs:{color:"primary",label:"Add Item"},on:{click:function(e){return t.onClickAddServiceOrderItem(t.selected.item)}}})],1),s("q-separator",{staticClass:"q-my-sm",attrs:{color:"black"}}),t.form.serviceOrderItems.length?s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"row full-width text-center"},[s("div",{staticClass:"col-1"},[t._v("\n              Qty\n            ")]),s("div",{staticClass:"col-2"},[t._v("\n              Description\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Width\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Height\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Depth\n            ")]),s("div",{staticClass:"col-2"},[t._v("\n              Material\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Colour\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Profile\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Amount(RM)\n            ")])]),t._l(t.form.serviceOrderItems,(function(e,i){return s("div",{key:e.serviceReportItemId,staticClass:"row full-width",attrs:{ripple:""}},[s("div",{staticClass:"row full-width text-center"},[s("q-separator",{staticClass:"q-mt-sm q-mb-md",attrs:{color:"black"}}),s("div",{staticClass:"col-1 q-pa-none"},[t._v("\n                "+t._s(e.quantity)+"\n              ")]),s("div",{staticClass:"col-2"},[t._v("\n                "+t._s(e.description)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.width)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.height)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.depth)+"\n              ")]),s("div",{staticClass:"col-2"},[t._v("\n                "+t._s(e.material)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.colour)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.profile)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.amount.toFixed(2))+"\n              ")]),s("div",{staticClass:"col-1"},[s("q-btn",{staticClass:"col-1 q-pa-none",attrs:{icon:"edit",size:"sm",color:"primary",flat:""},on:{click:function(s){return t.onClickEditItem(e,!1,i)}}}),s("q-btn",{staticClass:"col-1 q-pa-none",attrs:{icon:"delete",size:"sm",color:"negative",flat:""},on:{click:function(s){return t.onDeleteServiceOrderItem(e.serviceReportItemId)}}})],1)],1)])}))],2):t._e()],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{staticClass:"q-px-xl",attrs:{color:"secondary",label:"Save"},on:{click:t.onClickContinue}})],1)],1),s("q-card",{staticClass:"q-mt-md"},[s("q-card-section",[s("div",{staticClass:"col-4 q-mb-md text-weight-bold text-center text-h5"},[t._v("\n          Custom Items\n        ")]),s("div",{staticClass:"row full-width"},[s("div",{staticClass:"col-1"},[s("q-input",{staticClass:"q-pb-none q-mt-sm",attrs:{dense:"",outlined:"",label:"Qty"},model:{value:t.customItem.quantity,callback:function(e){t.$set(t.customItem,"quantity",e)},expression:"customItem.quantity"}})],1),s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-mt-sm q-ml-sm",attrs:{dense:"",outlined:"",label:"Description"},model:{value:t.customItem.description,callback:function(e){t.$set(t.customItem,"description",e)},expression:"customItem.description"}})],1),s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-mt-sm q-ml-sm",attrs:{dense:"",outlined:"",label:"U/Price",prefix:"RM"},model:{value:t.customItem.unitPrice,callback:function(e){t.$set(t.customItem,"unitPrice",e)},expression:"customItem.unitPrice"}})],1)]),s("div",{staticClass:"row full-width"},[s("div",{staticClass:"col-1"},[s("q-input",{staticClass:"q-pb-none q-mt-sm",attrs:{dense:"",outlined:"",label:"Width"},model:{value:t.customItem.width,callback:function(e){t.$set(t.customItem,"width",e)},expression:"customItem.width"}})],1),s("div",{staticClass:"col-1"},[s("q-input",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{dense:"",outlined:"",label:"Height"},model:{value:t.customItem.height,callback:function(e){t.$set(t.customItem,"height",e)},expression:"customItem.height"}})],1),s("div",{staticClass:"col-1"},[s("q-input",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{dense:"",outlined:"",label:"Depth"},model:{value:t.customItem.depth,callback:function(e){t.$set(t.customItem,"depth",e)},expression:"customItem.depth"}})],1),s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{dense:"",outlined:"",label:"Material"},model:{value:t.customItem.material,callback:function(e){t.$set(t.customItem,"material",e)},expression:"customItem.material"}})],1),s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{dense:"",outlined:"",label:"Colour"},model:{value:t.customItem.colour,callback:function(e){t.$set(t.customItem,"colour",e)},expression:"customItem.colour"}})],1),s("div",{staticClass:"col-2"},[s("q-input",{staticClass:"q-pb-none q-ml-sm q-mt-sm",attrs:{dense:"",outlined:"",label:"Profile"},model:{value:t.customItem.profile,callback:function(e){t.$set(t.customItem,"profile",e)},expression:"customItem.profile"}})],1)]),"ServiceReport"===t.type?s("div",{staticClass:"row full-width q-mt-sm"},[s("div",{staticClass:"col-3"},[s("q-select",{staticClass:"q-pb-none",attrs:{options:t.options.rootCause,label:"Root Cause",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.customItem.rootCause,callback:function(e){t.$set(t.customItem,"rootCause",e)},expression:"customItem.rootCause"}})],1),s("div",{staticClass:"col-3"},[s("q-select",{staticClass:"q-pb-none q-ml-sm",attrs:{options:t.options.byReason[t.customItem.rootCause],label:"By Reason",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.customItem.reason,callback:function(e){t.$set(t.customItem,"reason",e)},expression:"customItem.reason"}})],1),s("div",{staticClass:"col-3"},[s("q-select",{staticClass:"q-pb-none q-ml-sm",attrs:{options:t.options.byParty[t.customItem.rootCause],label:"By Party",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.customItem.party,callback:function(e){t.$set(t.customItem,"party",e)},expression:"customItem.party"}})],1),s("div",{staticClass:"col-3"},[s("q-select",{staticClass:"q-pb-none q-ml-sm",attrs:{options:t.options.subReason[t.customItem.rootCause],label:"Sub Reason",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.customItem.subReason,callback:function(e){t.$set(t.customItem,"subReason",e)},expression:"customItem.subReason"}})],1)]):t._e(),s("div",{staticClass:"row full-width justify-end q-mt-sm"},[s("q-btn",{staticClass:"q-px-lg",attrs:{color:"primary",label:"Add Item"},on:{click:t.onClickAddCustomItem}})],1),s("q-separator",{staticClass:"q-my-sm",attrs:{color:"black"}}),t.form.serviceOrderCustomItems.length?s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"row full-width text-center"},[s("div",{staticClass:"col-1"},[t._v("\n              Qty\n            ")]),s("div",{staticClass:"col-2"},[t._v("\n              Description\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Width\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Height\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Depth\n            ")]),s("div",{staticClass:"col-2"},[t._v("\n              Material\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Colour\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Profile\n            ")]),s("div",{staticClass:"col-1"},[t._v("\n              Amount(RM)\n            ")])]),t._l(t.form.serviceOrderCustomItems,(function(e,i){return s("div",{key:e.uuid,staticClass:"row full-width"},[s("div",{staticClass:"row full-width text-center"},[s("q-separator",{staticClass:"q-mt-sm q-mb-md",attrs:{color:"black"}}),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.quantity)+"\n              ")]),s("div",{staticClass:"col-2"},[t._v("\n                "+t._s(e.description)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.width)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.height)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.depth)+"\n              ")]),s("div",{staticClass:"col-2"},[t._v("\n                "+t._s(e.material)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.colour)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s(e.profile)+"\n              ")]),s("div",{staticClass:"col-1"},[t._v("\n                "+t._s((e.unitPrice*e.quantity).toFixed(2))+"\n              ")]),s("div",{staticClass:"col-1"},[s("q-btn",{staticClass:"col-1 q-pa-none",attrs:{icon:"edit",size:"sm",color:"primary",flat:""},on:{click:function(s){return t.onClickEditItem(e,!0,i)}}}),s("q-btn",{staticClass:"col-1",attrs:{icon:"delete",size:"sm",color:"negative",flat:""},on:{click:function(s){return t.onDeleteCustomItem(e.uuid)}}})],1)],1)])}))],2):t._e()],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{staticClass:"q-px-xl",attrs:{color:"secondary",label:"Save"},on:{click:t.onClickContinue}})],1)],1),s("q-card",{staticClass:"q-mt-md"},[s("q-card-section",[s("div",{staticClass:"col-4 q-mb-md text-center text-weight-bold text-h5"},[t._v("\n          Attachments\n        ")]),s("div",[s("q-uploader",{staticClass:"full-width q-my-md q-mx-lg",attrs:{url:t.fileUploadUrl,label:"Upload",color:"teal",multiple:""},on:{uploaded:t.fileUploaded}})],1),t.attachments?s("q-list",{attrs:{bordered:""}},t._l(t.attachments,(function(e){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.uuid,attrs:{clickable:""},on:{click:function(s){return t.openAttachment(e.name)}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{size:"sm",name:"fas fa-paperclip"}})],1),s("q-item-section",[t._v(t._s(e.fileName))])],1)})),1):t._e()],1)],1),s("q-card",{staticClass:"q-mt-md"},[s("q-card-section",[s("div",{staticClass:"col-4 q-mb-md text-center text-weight-bold text-h5"},[t._v("\n          Sales Consultant Remarks\n        ")]),s("div",[s("q-input",{staticClass:"q-ma-md",attrs:{filled:"",disable:"",type:"textarea"},model:{value:t.serviceReport.remarksSalesConsultant,callback:function(e){t.$set(t.serviceReport,"remarksSalesConsultant",e)},expression:"serviceReport.remarksSalesConsultant"}})],1)])],1),s("q-card",{staticClass:"q-mt-md"},[s("q-card-section",[s("div",{staticClass:"col-4 q-mb-md text-center text-weight-bold text-h5"},[t._v("\n          Detailer Remarks\n        ")]),s("div",[s("q-input",{staticClass:"q-ma-md",attrs:{filled:"",type:"textarea"},model:{value:t.serviceReport.remarksDetailer,callback:function(e){t.$set(t.serviceReport,"remarksDetailer",e)},expression:"serviceReport.remarksDetailer"}})],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{attrs:{color:"primary",label:"Update Remarks"},on:{click:t.onClickUpdateRemarksDetailer}})],1)],1)],1),s("div",{staticClass:"q-mt-md",attrs:{align:"right"}},[s("q-btn",{staticClass:"q-px-xl",attrs:{color:"secondary",label:"Save"},on:{click:t.onClickContinue}})],1)],1),s("sk-edit-service-report-item-dialog",{attrs:{"is-custom-item":t.isEditingCustomItem,"editing-item":t.editingItem,options:t.options,type:t.type},on:{save:t.onEditSave},model:{value:t.isOpenEditItemDialog,callback:function(e){t.isOpenEditItemDialog=e},expression:"isOpenEditItemDialog"}})],1)},a=[],o=(s("e01a"),s("ddb0"),s("ded3")),l=s.n(o),n=s("c973"),r=s.n(n),c=s("007d"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-dialog",{on:{input:t.onInput},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[t.item?s("q-card",{staticClass:"q-pb-md",staticStyle:{"max-height":"80vh","max-width":"100vw"}},[s("q-card-section",{staticClass:"row items-center q-pb-none"},[s("div",{staticClass:"text-h6 q-mb-md"},[t._v("\n        Edit Item - "+t._s(t.item.description)+"\n      ")]),s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),s("q-card-section",{staticClass:"q-px-xl"},[t.isCustomItem?s("div",{staticClass:"row q-gutter-lg justify-start"},[s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Details\n          ")]),s("q-input",{staticClass:"q-py-none full-width",attrs:{dense:"",outlined:"",label:"Qty",rules:[t.textRules]},model:{value:t.item.quantity,callback:function(e){t.$set(t.item,"quantity",e)},expression:"item.quantity"}}),s("q-input",{staticClass:"q-py-none full-width",attrs:{dense:"",outlined:"",label:"Description",rules:[t.textRules]},model:{value:t.item.description,callback:function(e){t.$set(t.item,"description",e)},expression:"item.description"}}),s("q-input",{staticClass:"q-py-none full-width",attrs:{dense:"",outlined:"",label:"U/Price",prefix:"RM"},model:{value:t.item.unitPrice,callback:function(e){t.$set(t.item,"unitPrice",e)},expression:"item.unitPrice"}})],1),s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Dimensions\n          ")]),s("q-input",{staticClass:"q-pb-none full-width",attrs:{outlined:"",dense:"",label:"Width",rules:[t.textRules]},model:{value:t.item.width,callback:function(e){t.$set(t.item,"width",e)},expression:"item.width"}}),s("q-input",{staticClass:"q-pb-none full-width",attrs:{outlined:"",dense:"",label:"Height",rules:[t.textRules]},model:{value:t.item.height,callback:function(e){t.$set(t.item,"height",e)},expression:"item.height"}}),s("q-input",{staticClass:"q-pb-none full-width",attrs:{outlined:"",dense:"",label:"Depth",rules:[t.textRules]},model:{value:t.item.depth,callback:function(e){t.$set(t.item,"depth",e)},expression:"item.depth"}})],1),s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Material/Colour/Profile\n          ")]),s("q-input",{staticClass:"q-py-none full-width",attrs:{dense:"",outlined:"",label:"Material",rules:[t.textRules]},model:{value:t.item.material,callback:function(e){t.$set(t.item,"material",e)},expression:"item.material"}}),s("q-input",{staticClass:"q-py-none full-width",attrs:{dense:"",outlined:"",label:"Colour",rules:[t.textRules]},model:{value:t.item.colour,callback:function(e){t.$set(t.item,"colour",e)},expression:"item.colour"}}),s("q-input",{staticClass:"q-py-none full-width",attrs:{dense:"",outlined:"",label:"Profile",rules:[t.textRules]},model:{value:t.item.profile,callback:function(e){t.$set(t.item,"profile",e)},expression:"item.profile"}})],1),"ServiceReport"===t.type?s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Cause of Report\n          ")]),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.rootCause,label:"Root Cause",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.rootCause,callback:function(e){t.$set(t.item,"rootCause",e)},expression:"item.rootCause"}}),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.byReason[t.item.rootCause],label:"By Reason",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.reason,callback:function(e){t.$set(t.item,"reason",e)},expression:"item.reason"}}),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.byParty[t.item.rootCause],label:"By Party",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.party,callback:function(e){t.$set(t.item,"party",e)},expression:"item.party"}}),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.subReason[t.item.rootCause],label:"Sub Reason",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.subReason,callback:function(e){t.$set(t.item,"subReason",e)},expression:"item.subReason"}})],1):t._e()]):s("div",{staticClass:"row q-gutter-lg justify-start"},[s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Details\n          ")]),s("q-input",{staticClass:"q-py-none full-width",attrs:{dense:"",outlined:"",label:"Qty",rules:[t.textRules]},model:{value:t.item.quantity,callback:function(e){t.$set(t.item,"quantity",e)},expression:"item.quantity"}}),s("q-select",{staticClass:"q-pb-none full-width",attrs:{options:t.options.category,label:"Product Category",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":"",rules:[t.textRules]},model:{value:t.item.category,callback:function(e){t.$set(t.item,"category",e)},expression:"item.category"}}),s("q-select",{staticClass:"q-pb-none full-width",attrs:{options:t.options.subCategory[t.item.category],label:"Product Sub Category",outlined:"",dense:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.subcategory,callback:function(e){t.$set(t.item,"subcategory",e)},expression:"item.subcategory"}}),s("q-select",{staticClass:"q-pb-none full-width",attrs:{options:t.filteredItemOptions,label:"Product Description",outlined:"",dense:"","emit-value":"","map-options":"","stack-label":"",rules:[t.textRules]},model:{value:t.item.serviceReportItemId,callback:function(e){t.$set(t.item,"serviceReportItemId",e)},expression:"item.serviceReportItemId"}})],1),s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Dimensions\n          ")]),s("q-input",{staticClass:"q-pb-none full-width",attrs:{outlined:"",dense:"",label:"Width",rules:[t.textRules]},model:{value:t.item.width,callback:function(e){t.$set(t.item,"width",e)},expression:"item.width"}}),s("q-input",{staticClass:"q-pb-none full-width",attrs:{outlined:"",dense:"",label:"Height",rules:[t.textRules]},model:{value:t.item.height,callback:function(e){t.$set(t.item,"height",e)},expression:"item.height"}}),s("q-input",{staticClass:"q-pb-none full-width",attrs:{outlined:"",dense:"",label:"Depth",rules:[t.textRules]},model:{value:t.item.depth,callback:function(e){t.$set(t.item,"depth",e)},expression:"item.depth"}})],1),s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Material/Colour/Profile\n          ")]),s("q-select",{staticClass:"q-pb-none full-width",attrs:{options:t.options.materials,outlined:"",dense:"","emit-value":"","map-options":"","stack-label":"",label:"Material"},model:{value:t.item.material,callback:function(e){t.$set(t.item,"material",e)},expression:"item.material"}}),s("q-select",{staticClass:"q-pb-none full-width",attrs:{options:t.options.colours[t.item.material]||[],outlined:"",dense:"","emit-value":"","map-options":"","stack-label":"",label:"Colour"},model:{value:t.item.colour,callback:function(e){t.$set(t.item,"colour",e)},expression:"item.colour"}}),s("q-select",{staticClass:"q-pb-none full-width",attrs:{options:t.item.material.length&&t.item.colour.length?t.options.profiles[t.item.material][t.item.colour]:[],outlined:"",dense:"","emit-value":"","map-options":"","stack-label":"",label:"Profile"},model:{value:t.item.serviceReportMaterialId,callback:function(e){t.$set(t.item,"serviceReportMaterialId",e)},expression:"item.serviceReportMaterialId"}})],1),"ServiceReport"===t.type?s("div",{staticClass:"column q-gutter-lg text-center"},[s("p",{staticClass:"q-ma-none q-pa-none text-weight-bold"},[t._v("\n            Cause of Report\n          ")]),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.rootCause,label:"Root Cause",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.rootCause,callback:function(e){t.$set(t.item,"rootCause",e)},expression:"item.rootCause"}}),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.byReason[t.item.rootCause],label:"By Reason",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.reason,callback:function(e){t.$set(t.item,"reason",e)},expression:"item.reason"}}),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.byParty[t.item.rootCause],label:"By Party",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.party,callback:function(e){t.$set(t.item,"party",e)},expression:"item.party"}}),s("q-select",{staticClass:"q-py-none full-width",attrs:{options:t.options.subReason[t.item.rootCause],label:"Sub Reason",dense:"",outlined:"","emit-value":"","map-options":"","stack-label":""},model:{value:t.item.subReason,callback:function(e){t.$set(t.item,"subReason",e)},expression:"item.subReason"}})],1):t._e()])]),s("q-card-actions",{staticClass:"q-px-xl",attrs:{align:"right"}},[s("q-btn",{staticClass:"q-px-lg q-ml-md",attrs:{color:"primary",label:"Save Item"},on:{click:t.onClickSave}})],1)],1):t._e()],1)},m=[],d={mixins:[c["a"]],props:{value:{type:Boolean,default:!1,required:!0},isCustomItem:{type:Boolean,default:!1,required:!0},editingItem:{type:Object,default:null,required:!0},options:{type:Object,default:null,required:!0},type:{type:String,required:!0}},data(){return{isOpen:!1,item:null}},computed:{filteredItemOptions:function(){const{category:t,subcategory:e}=this.item;let s=this.options.item;return t&&(s=s.filter(e=>e.category===t)),e&&(s=s.filter(t=>t.subcategory===e)),s}},watch:{value(t){this.isOpen=t},editingItem(t){this.item=JSON.parse(JSON.stringify(t))}},methods:{onInput(t){this.$emit("input",t)},onClickSave(){this.$emit("save",this.item),this.$emit("input",!1)}}},p=d,v=s("2877"),h=Object(v["a"])(p,u,m,!1,null,null,null),b=h.exports,f=s("36dc");const C=["","Human Error","Material Handling Issues","Customer Issues","Quality Issues"],q={"Human Error":["","Wrong Design","Wrong Site Measurement","Item Wrong Order","Left Out Order","Delivered Wrong Item","Item short Delivered","Production Mistake","Error in Production Order"],"Material Handling Issues":["","Material Damage During Delivery","Material Damage At Site","Material Damage in Packing","Item Missing At Site"],"Customer Issues":["","Customer Add Order","Customer Change Design"],"Quality Issues":["","Cabinet Material Defect","Accessories Defect","Production Workmanship","Installation Workmanship","Worktop Workmanship","Glass Cladding Workmanship"]},g={"Human Error":["","Sales Consultant","Sales Consultant/Purchaser","Factory","Detailer"],"Material Handling Issues":["","Transporter","Installer","3rd Party Contactor","Our Contractor","Unknown"],"Customer Issues":["","Customer"],"Quality Issues":["","Factory","Supplier","Installer","Fabricator"]},y={"Human Error":["","By Section(panel processing, packing, assembly, fitting, spraying)"],"Material Handling Issues":["","Packing and Delivery Section"],"Customer Issues":[],"Quality Issues":[]};var I={components:{skEditServiceReportItemDialog:b,SelectWithFilter:f["a"]},mixins:[c["a"]],data(){return{serviceReport:{},attachments:[],reportId:"",form:{serviceOrderItems:[],serviceOrderCustomItems:[]},inserting:{width:"",height:"",depth:"",profile:"",colour:"",material:"",remarks:"",remarksFactory:""},selected:{category:"",subCategory:"",item:"",rootCause:"",reason:"",party:"",subReason:""},customItem:{quantity:null,description:"",unitprice:null,width:"",height:"",depth:"",material:"",colour:"",profile:"",selectedRootCause:"",selectedByReason:"",selectedByParty:"",selectedSubReason:"",remarks:"",remarksFactory:""},options:{category:[],subCategory:{},item:[],materials:[],colours:{},profiles:{},rootCause:C,byReason:q,byParty:g,subReason:y},serviceReportMaterials:[],type:"",editingItem:{},isEditingCustomItem:!1,editingItemIndex:null,isOpenEditItemDialog:!1,filteredItemOptions:[]}},computed:{fileUploadUrl(){return"https://api-prod.skcrm.com.my/containers/upload"},materialLabel:function(){return`Material (${this.options.materials.length} options)`},colourLabel:function(){const t=this.options.colours[this.inserting.material]||[];return`Colour (${t.length} options)`},profileLabel:function(){const t=this.inserting.material.length&&this.inserting.colour.length?this.options.profiles[this.inserting.material][this.inserting.colour]:[];return`Profile (${t.length} options)`}},watch:{"serviceOrderItem.rootCause":function(t,e){this.serviceOrderItem.reason="",this.serviceOrderItem.party="",this.serviceOrderItem.subReason=""},"inserting.material":function(){this.inserting.colour="",this.inserting.profile=""},"inserting.colour":function(){this.inserting.profile=""}},created(){var t=this;return r()((function*(){t.reportId=t.$route.params.reportId;const e={include:[{relation:"items",scope:{include:[{relation:"item"},{relation:"material"}]}},{relation:"customItems"},{relation:"submitter"},{relation:"lead"},{relation:"attachments"}]},{data:s}=yield t.$repository.serviceReport.getById(t.reportId,e);t.serviceReport=JSON.parse(JSON.stringify(s)),t.type=s.type;const{data:i}=yield t.$repository.serviceReportItem.listing(),{data:a}=yield t.$repository.serviceReportMaterial.listing();t.serviceReportMaterials=a,t.attachments=s.attachments,t.fillExistingItemsFromServiceReport(s),t.buildServiceReportMaterialOptions(a),t.buildServiceReportItemOptions(i),t.filteredItemOptions=[...t.options.item]}))()},methods:{onClickUpdateRemarksDetailer(){var t=this;return r()((function*(){try{yield t.$repository.serviceReport.updateById(t.reportId,{remarksDetailer:t.serviceReport.remarksDetailer}),t.$notify("success","Remarks Updated")}catch(e){t.$notify("negative","Remarks failed to be updated")}}))()},onDialogInput(t){this.isOpenEditItemDialog=t},onEditSave(t){this.isEditingCustomItem?this.form.serviceOrderCustomItems[this.editingItemIndex]=t:(delete t.category,t.profile=this.serviceReportMaterials.find(e=>e.uuid===t.serviceReportMaterialId).profile,t.description=this.options.item.find(e=>e.value===t.serviceReportItemId).label,this.form.serviceOrderItems[this.editingItemIndex]=t),this.$notify("success","Item editted. Click Save to save your changes.")},openAttachment(t){const e="https://api-prod.skcrm.com.my/containers/download/"+t;window.open(e,"_blank")},fileUploaded({files:t,xhr:e}){var s=this;return r()((function*(){const[{name:i}]=t;try{const{files:t}=JSON.parse(e.response),[{name:a}]=t[i],o=s.reportId;if(!a)throw new Error;yield s.$repository.serviceReport.addAttachment(o,a,i);const{data:l}=yield s.$repository.serviceReport.getById(s.reportId,{include:[{relation:"attachments"}]});s.attachments=l.attachments,s.$notify("success","File upload success")}catch(a){s.$notify("error","Error uploading attachment "+i)}}))()},fillExistingItemsFromServiceReport(t){this.form.serviceOrderItems=[],t.items&&(this.form.serviceOrderItems=t.items.map(t=>{const{material:e,colour:s,profile:i}=t.material;return t.material=e,t.colour=s,t.profile=i,t.description=t.item.name,t})),this.form.serviceOrderCustomItems=[],t.customItems&&(this.form.serviceOrderCustomItems=t.customItems.map(t=>(t.description=t.item,t)))},buildServiceReportItemOptions(t){for(const e of t){const{category:t,subcategory:s}=e;t&&!this.isExistInCategoryOptions(t)&&this.options.category.push(t),s&&!this.isExistInSubCategoryOptions(t,s)&&(this.options.subCategory[t]||(this.options.subCategory[t]=[]),this.options.subCategory[t].push(s)),this.options.item.push(l()({value:e.uuid,label:e.name},e))}},buildServiceReportMaterialOptions(t){for(const{material:e}of t)this.options.materials.filter(t=>t===e).length||this.options.materials.push(e);for(const{material:e,colour:s}of t)this.options.colours[e]||(this.options.colours[e]=[]),this.options.colours[e].filter(t=>t===s).length||this.options.colours[e].push(s);for(const e of t){const{uuid:t,material:s,colour:i}=e,a=e.profile||"No Profiling";this.options.profiles[s]||(this.options.profiles[s]=[]),this.options.profiles[s][i]||(this.options.profiles[s][i]=[]),this.options.profiles[s][i].filter(t=>t===a).length||this.options.profiles[s][i].push({label:a,value:t})}},isExistInCategoryOptions(t){return this.options.category.filter(e=>e===t).length>0},isExistInSubCategoryOptions(t,e){return!!this.options.subCategory[t]&&this.options.subCategory[t].filter(t=>t===e).length>0},onClickAddServiceOrderItem(t){var e=this;return r()((function*(){const[s]=e.options.item.filter(e=>e.uuid===t);if(!s)return void e.$notify("error","No item has been selected.");const{profile:i,width:a,height:o,depth:n,material:r,colour:c}=e.inserting;if(!i)return void e.$notify("error","No profile has been selected.");if(!a||!o||!n)return void e.$notify("error","Dimensions data incomplete.");if(!r||!c)return void e.$notify("error","Material & Colour is required.");const{profile:u}=e.inserting;e.inserting.profile=e.serviceReportMaterials.find(t=>t.uuid===u).profile;const m=l()(l()({description:s.name,quantity:s.quantity},e.inserting),{},{rootCause:e.selected.rootCause,reason:e.selected.reason,subReason:e.selected.subReason,party:e.selected.party,serviceReportMaterialId:u,serviceReportItemId:s.uuid,amount:0});e.form.serviceOrderItems.push(m),e.resetInserting(),e.$notify("success","Successfully add item")}))()},onClickAddCustomItem(){var t=this;return r()((function*(){t.form.serviceOrderCustomItems.push(l()({},t.customItem)),t.resetInserting(),t.$notify("success","Successfully add item")}))()},onDeleteServiceOrderItem(t){this.form.serviceOrderItems=this.form.serviceOrderItems.filter(e=>e.serviceReportItemId!==t),this.$notify("success","Successfully deleted")},onDeleteCustomItem(t){this.form.serviceOrderCustomItems=this.form.serviceOrderCustomItems.filter(e=>e.uuid!==t),this.$notify("success","Successfully deleted")},onClickEditItem(t,e,s){this.editingItem=e?t:this.serviceReport.items[s],this.isEditingCustomItem=e,this.editingItemIndex=s,e||(this.editingItem.description=t.description,this.editingItem.category=t.item.category,this.editingItem.subcategory=t.item.subcategory,this.editingItem.material=t.material,this.editingItem.colour=t.colour,this.editingItem.serviceReportItemId=t.serviceReportItemId,this.editingItem.serviceReportMaterialId=t.serviceReportMaterialId),this.isOpenEditItemDialog=!0},onClickContinue(){var t=this;return r()((function*(){const e=t.form.serviceOrderItems.map(t=>({serviceReportItemId:t.serviceReportItemId,serviceReportMaterialId:t.serviceReportMaterialId,quantity:parseInt(t.quantity),width:t.width,height:t.height,depth:t.depth,rootCause:t.rootCause,reason:t.reason,subReason:t.subReason,party:t.party,remarks:t.remarks,remarksFactory:t.remarksFactory})),s=t.form.serviceOrderCustomItems.map(t=>({item:t.description,material:t.material,colour:t.colour,profile:t.profile,unitPrice:parseFloat(t.unitPrice),quantity:parseInt(t.quantity),width:t.width,height:t.height,depth:t.depth,rootCause:t.rootCause,reason:t.reason,subReason:t.subReason,party:t.party,remarks:t.remarks,remarksFactory:t.remarksFactory}));try{yield t.$repository.serviceReport.calculate(t.reportId,e,s);const i={include:[{relation:"items",scope:{include:[{relation:"item"},{relation:"material"}]}},{relation:"customItems"},{relation:"submitter"},{relation:"lead"},{relation:"attachments"}]},{data:a}=yield t.$repository.serviceReport.getById(t.reportId,i);t.fillExistingItemsFromServiceReport(a),t.$notify("success","Successfully calculated")}catch(i){t.$notify("error","Error while calculating")}}))()},resetInserting(){this.inserting={width:"",height:"",depth:"",profile:"",colour:"",material:" ",remarks:"",remarksFactory:""},this.selected={rootCause:"",reason:"",party:"",subReason:"",subCategory:" "},this.customItem={quantity:null,description:"",unitprice:null,width:"",height:"",depth:"",material:"",colour:"",profile:"",selectedRootCause:"",selectedByReason:"",selectedByParty:"",selectedSubReason:"",remarks:"",remarksFactory:""}}}},k=I,x=Object(v["a"])(k,i,a,!1,null,null,null);e["default"]=x.exports}}]);